"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8457],{81840:function(e,t,l){l.d(t,{c:function(){return r}});var a=l(59547),s=l(47177),i=l(30912),n=l(39992);let r=e=>{let{deckId:t,children:l,isUploading:r,hasBorder:c=!0,hasClick:o=!0,disabled:d=!1,setIsUploading:m,onFinish:u}=e,{startUpload:x}=(0,s.useUpload)(),[h,f]=(0,i.useState)(!1),p=async e=>{e.preventDefault(),e.stopPropagation(),f(!1),m(!0);let l=e.dataTransfer.files;for(let e=0;e<l.length;e++){let a=l[e];a.type.includes("image")&&await x(a,t)}m(!1),null==u||u()},g=async e=>{if(e&&0!==e.length&&!r){m(!0);for(let l=0;l<e.length;l++){let a=e[l];await x(a,t)}m(!1),null==u||u()}};return d?(0,a.jsx)("main",{className:"relative size-full min-h-0 flex flex-col items-center justify-center gap-4 border-2 border-transparent",children:l}):(0,a.jsxs)("main",{onDragOver:e=>{e.preventDefault(),e.stopPropagation(),f(!0)},onDragLeave:()=>f(!1),onDrop:p,className:"relative size-full min-h-0 flex flex-col items-center justify-center gap-4 rounded-xl hover:bg-black-300 border-2 border-dashed ".concat(h?"border-blue-400":c?"border-white-400/10":"border-transparent"),children:[l,o&&(0,a.jsx)("input",{type:"file",multiple:!0,accept:n.RL,className:"absolute inset-0 size-full cursor-pointer opacity-0",onChange:e=>g(e.target.files)})]})}},36313:function(e,t,l){l.d(t,{R:function(){return n}});var a=l(59547),s=l(30912);let i=e=>{let t=new Image;return t.src=e,t.complete},n=e=>{let{src:t,alt:l,width:n,height:r,draggable:c=!0,style:o,noAnimation:d,prefetch:m=!1,initialLoader:u=!1,className:x}=e,[h,f]=(0,s.useState)(!u),p=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(t&&m&&!i(t)){let e=new Image;e.src=t,e.onload=()=>{f(!0)}}},[t,m]),(0,s.useEffect)(()=>{t&&p.current&&p.current.complete&&f(!0)},[p,t]),(0,a.jsxs)("div",{className:"relative flex size-full max-h-full min-h-0 flex-col justify-center",children:[!h&&(0,a.jsx)("div",{className:"absolute left-0 top-0 size-full animate-pulse"}),(0,a.jsx)("img",{ref:p,style:o,src:t,alt:l,width:n,height:r,draggable:c,className:"flex max-h-full min-h-0 select-none ".concat(d?"":"transition-opacity duration-300"," ").concat(h?"opacity-100":"opacity-0","  ").concat(x),onLoad:()=>f(!0)})]})}},67630:function(e,t,l){l.d(t,{$:function(){return n}});var a=l(59547),s=l(79886),i=l(17432);let n=e=>{let{tags:t,wrap:l="flex-wrap",onClickTag:n}=e;return(0,a.jsx)("div",{className:"flex gap-2 ".concat(l),children:t.map((e,t)=>(0,a.jsx)(s.default,{href:"/explore?query=".concat(e),onClick:()=>null==n?void 0:n(e),children:(0,a.jsx)(i.z,{variant:"flat",children:e.replace("tag:","")})},"tag-".concat(e,"-").concat(t)))})}},62350:function(e,t,l){l.d(t,{O:function(){return i}});var a=l(59547),s=l(15361);let i=e=>{let{src:t,alt:l,id:i,margin:n="m-2",onClick:r}=e;return(0,a.jsx)("button",{id:i,className:"flex size-9 items-center justify-center rounded-full hover:bg-black-100 ".concat(n),onClick:r,children:(0,a.jsx)(s.default,{priority:!0,src:t,alt:l,className:"w-3.5 opacity-85 xs:w-4"})})}},10822:function(e,t,l){l.d(t,{I:function(){return d}});var a=l(59547),s=l(30912),i=l(54939),n=l(82972),r=l(7502),c=l(93078),o=l(74491);let d=e=>{let{itemId:t,userId:l,size:d="sm",addVoteApi:m,removeVoteApi:u}=e,{getItem:x,voteOnItem:h}=(0,o.useFeed)(),f=(0,s.useMemo)(()=>x(t),[x,t]),p=(0,s.useMemo)(()=>f?f.reactions:[],[f]),g=(0,s.useMemo)(()=>p.filter(e=>"upvote"===e.react),[p,p.length]),b=(0,s.useMemo)(()=>p.filter(e=>"downvote"===e.react),[p,p.length]),v=(0,s.useMemo)(()=>g.length-b.length,[g,b]),j=(0,s.useMemo)(()=>g.some(e=>e.by===l),[g,l]),w=(0,s.useMemo)(()=>b.some(e=>e.by===l),[b,l]);return(0,a.jsxs)(i.g,{size:d,children:[(0,a.jsxs)(n.A,{isIconOnly:0===v,onClick:e=>{e.stopPropagation(),e.preventDefault(),j?(u(t,"upvote"),h(l,t,"remove","upvote")):(m(t,"upvote"),h(l,t,"add","upvote"))},className:j?"bg-blue-600":"",variant:"ghost",color:j?"primary":"default",children:[(0,a.jsx)(c.JO,{icon:"majesticons:arrow-up",width:20,color:"white"}),0!==v&&(0,a.jsx)(r.E.div,{initial:{opacity:0,y:v<0?10:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:0,transition:{duration:.1}},transition:{duration:.2},children:(0,a.jsx)("span",{className:"text-base font-semibold text-white-400",children:v})},v)]}),(0,a.jsx)(n.A,{isIconOnly:!0,onClick:e=>{e.stopPropagation(),e.preventDefault(),w?(u(t,"downvote"),h(l,t,"remove","downvote")):(m(t,"downvote"),h(l,t,"add","downvote"))},className:w?"bg-warning-400":"",variant:"ghost",color:w?"warning":"default",children:(0,a.jsx)(c.JO,{icon:"majesticons:arrow-down",color:w?"black":"white",width:20})})]})}},74078:function(e,t,l){l.d(t,{g:function(){return m}});var a=l(59547),s=l(30912),i=l(15361),n=l(60044);let r="bold ".concat(80,"px Impact"),c="white",o="black";function d(e,t,l,a,s,i){for(var r=t.split(" "),d="",m=[],u=0;u<r.length;u++){var x=d+r[u]+" ";e.measureText(x).width>s&&u>0?(m.push({text:d,y:a}),d=r[u]+" ",a+=100):d=x}if(m.push({text:d.trim(),y:a}),"bottom"===i){let e=100*m.length;m=m.map(t=>({text:t.text,y:t.y-e+100}))}m.forEach(t=>{(0,n.Dt)()?(e.fillStyle=c,e.shadowColor=o,e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=0,e.strokeText(t.text,l,t.y),e.fillText(t.text,l,t.y)):(e.fillText(t.text,l,t.y),e.strokeText(t.text,l,t.y))})}let m=e=>{let{src:t,topText:l,bottomText:n,id:m="image-canvas",width:u=768,height:x=768,alt:h="Generated Image",progress:f=100,className:p=""}=e,g=(0,s.useRef)(new Image),b=(0,s.useRef)(null),v=null===l&&null===n;return(0,s.useEffect)(()=>{let e=g.current,a=b.current;a&&(e.onload=()=>{!function(e,t,l,a){let s=t.getContext("2d");if(!s||(t.width=e.width,t.height=e.height,s.drawImage(e,0,0),!l&&!a))return;s.font=r,s.fillStyle=c,s.strokeStyle=o,s.lineWidth=3,s.lineJoin="round",s.textAlign="center";let i=e.width-40,n=e.width/2,m=e.height-64;l&&d(s,l,n,120,i,"top"),a&&d(s,a,n,m,i,"bottom")}(e,a,l,n)},e.src=t)},[n,t,l]),(0,a.jsx)("div",{id:m,className:"size-full flex items-center justify-center",children:f&&f<100&&f>0||v?(0,a.jsx)(i.default,{draggable:!1,priority:!0,src:t,alt:h,style:{borderRadius:"0px",filter:f<100?"blur(".concat(100/f,"px)"):"none",transition:"filter 0.5s"},className:"transition-all object-contain rounded-2xl size-full ".concat(p),width:u,height:x}):(0,a.jsx)("canvas",{ref:b,className:"w-full max-h-full object-contain ".concat(p)})})}},21087:function(e,t,l){l.d(t,{V:function(){return h}});var a=l(59547),s=l(30912),i=l(15361),n=l(89005),r=l(81926),c=l(69919),o=l(1463),d=l(33135),m=l(58741);let u=[],x=(0,m.k)(o.P.searchTags,1e3),h=e=>{let{tagId:t,tagName:l,minW:o="min-w-36",variant:m,onUpdateTag:h,onDeleteTag:f,onClick:p}=e,g=(0,s.useRef)(null),[b,v]=(0,s.useState)(l),[j,w]=(0,s.useState)(t),[y,N]=(0,s.useState)([]),[k,C]=(0,s.useState)(!1),[_,I]=(0,s.useState)(!1),P=async e=>{C(!0);let t=await x(e);t&&(N(t),C(!1))},S=e=>{if(e!==l)return C(!1),I(!1),N([]),null==h?void 0:h(e)},z=async()=>{N([]),C(!1),I(!0),await (null==f?void 0:f()),I(!1),v("")};return(0,a.jsx)(n.d,{ref:g,allowsCustomValue:!0,defaultInputValue:"",inputValue:b,defaultSelectedKey:"",selectedKey:j,defaultItems:u,items:y,maxLength:20,isLoading:k,isDisabled:_,className:"inline-flex w-auto max-w-0 ".concat(o),color:"default",variant:m,radius:"full",onBlur:()=>S(b),onInputChange:e=>{null!==e&&(v(e),""===e?N([]):e.length>2&&P(e))},onSelectionChange:e=>{w(e);let t=y.find(t=>t.id===e);t&&(N([]),v(t.name),S(t.name))},placeholder:"Add tag","aria-label":"Add tag",disableSelectorIconRotation:!0,selectorIcon:b.length>0?(0,a.jsx)(i.default,{src:c.Z,className:"w-2.5 opacity-75",alt:"Clear tag"}):(0,a.jsx)(i.default,{src:d.Z,className:"w-3 opacity-75",alt:"Add tag"}),isClearable:!1,selectorButtonProps:{disableRipple:!0,onClick:()=>{b.length>0&&z()}},onKeyDown:e=>{var t,l;"Escape"===e.key?null===(t=g.current)||void 0===t||t.blur():"Enter"===e.key&&0===y.length&&(null===(l=g.current)||void 0===l||l.blur())},onClick:p,children:e=>(0,a.jsx)(r.R,{value:e.id,children:e.name},e.id)})}},89204:function(e,t,l){l.r(t),l.d(t,{AppHistoryProvider:function(){return r},useAppHistory:function(){return c}});var a=l(59547),s=l(74600),i=l(30912);let n=(0,i.createContext)({}),r=e=>{let{children:t}=e,l=(0,s.usePathname)(),r=(0,s.useRouter)(),[c,o]=(0,i.useState)([]),d=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/home",t=arguments.length>1?arguments[1]:void 0;console.log("goBack",{defaultRoute:e,ignoreRouteBase:t});let l=e;c.length>1&&(l=c[c.length-2],void 0!==t&&l.includes(t)&&(l=e)),"string"!=typeof l&&(l="/home"),r.push(l,{scroll:!1})},[c,r]);return(0,i.useEffect)(()=>{o(e=>e[e.length-1]!==l?[...e,l]:e)},[l]),(0,a.jsx)(n.Provider,{value:{goBack:d},children:t})},c=()=>(0,i.useContext)(n)},78457:function(e,t,l){l.r(t),l.d(t,{MemeModalProvider:function(){return ej},useMemeModal:function(){return ew}});var a,s,i=l(59547),n=l(30912);let r=()=>{(0,n.useEffect)(()=>{if(window.innerWidth>1024){let e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>document.body.style.overflow=e}{let e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>document.body.style.overflow=e}},[])};var c=l(74600),o=l(1463),d=l(79886),m=l(15361),u=l(82972),x=l(88942),h=l(94913),f=l(29619),p=l(35732),g=l(24769),b={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/chevron.6ff4ee05.svg",height:8,width:12,blurWidth:0,blurHeight:0},v=l(36313),j=l(62350),w=l(89204),y=l(69919);let N=e=>{let{maxWidth:t="max-w-4xl",children:l}=e,{goBack:a}=(0,w.useAppHistory)();return(0,i.jsxs)("main",{className:"relative flex max-h-full flex-1 flex-col bg-black-400 md:min-h-full md:overflow-hidden md:bg-transparent lg:overflow-hidden",children:[(0,i.jsx)(j.O,{src:y.Z,alt:"Close",onClick:a}),(0,i.jsx)("div",{className:"relative flex min-h-0 min-w-0 max-w-full flex-1 items-center justify-center md:m-3",children:(0,i.jsx)("div",{className:"relative flex size-full max-h-full min-h-0 min-w-0 items-center justify-center ".concat(t),children:l})})]})},k=e=>{let{deck:t,currentIndex:l,onNextMeme:a,onPrevMeme:s}=e;return(0,i.jsx)(N,{maxWidth:"max-w-6xl",children:(0,i.jsxs)("div",{className:"flex size-full max-h-full min-h-0 flex-row items-center justify-center gap-3 overflow-hidden px-0 lg:gap-6 lg:p-3",children:[(0,i.jsx)(u.A,{isIconOnly:!0,color:"default",variant:"ghost",id:"deck-modal-prev",className:"hidden size-12 rounded-full md:flex",isDisabled:0==l,onClick:s,children:(0,i.jsx)(m.default,{src:b,width:32,height:32,alt:"Profile",className:"mr-[2px] w-4 rotate-90 select-none lg:w-6"})}),(0,i.jsx)(g.ZP,{className:"relative flex h-full max-h-full min-h-0 min-w-0 max-w-full items-center overflow-hidden bg-transparent sm:rounded-lg xs:rounded-none",ignoreNativeScroll:!0,index:l,style:{background:"transparent",maxHeight:"100%",minHeight:0},children:Object.values(t.memes).map((e,l)=>{var a;return(0,i.jsx)("div",{className:"h-full max-h-full min-h-0 px-2 md:px-0",children:(0,i.jsxs)(x.w,{id:"deck-modal",classNames:{base:"max-h-full min-h-full h-full",body:"p-0"},children:[(0,i.jsx)(h.u,{children:(0,i.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-2",children:[e.creator_avatar&&(0,i.jsx)(d.default,{href:"/u/".concat(e.creator_handle),className:"flex items-center",children:(0,i.jsx)(f.z,{classNames:{base:"text-white-400/50 hover:text-white-400/75",name:"truncate"},name:e.creator_name,avatarProps:{src:e.creator_avatar,className:"w-5 h-5 text-tiny"}})}),(0,i.jsxs)("p",{className:"truncate text-sm font-normal text-white-400/50",children:[l+1," of ",Object.keys(t.memes).length]})]})}),(0,i.jsxs)(p.G,{className:"relative flex max-h-full min-h-0 flex-1 flex-row overflow-hidden",children:[(0,i.jsx)("img",{style:{zIndex:0,filter:"brightness(0.5) blur(60px)",transform:"scale(1.2)",border:0,overflow:"hidden"},className:"absolute z-0 size-full max-w-full select-none",src:e.url,alt:null===(a=e.tags)||void 0===a?void 0:a.join(", ")}),(0,i.jsx)(v.R,{prefetch:!0,draggable:!1,src:e.url,alt:"".concat(t.name," meme ").concat(l),className:"max-h-full max-w-full select-none object-contain object-center",noAnimation:!0})]})]})},l)})}),(0,i.jsx)(u.A,{isIconOnly:!0,color:"default",variant:"ghost",id:"deck-modal-next",className:"hidden size-12 rounded-full md:flex",isDisabled:l===Object.keys(t.memes).length-1,onClick:a,children:(0,i.jsx)(m.default,{src:b,width:32,height:32,alt:"Profile",className:"ml-[2px] w-4 -rotate-90 select-none lg:w-6"})})]})})},C=e=>{let{goBack:t}=e;return(0,i.jsxs)("div",{className:"flex w-full items-center justify-between xs:h-[40px] xs:px-1 sm:h-[48px] md:h-[64px] md:px-2 lg:h-[64px] lg:px-2",children:[(0,i.jsx)(u.A,{isIconOnly:!0,className:"size-fit rounded-full hover:bg-black-100 xs:mt-2 md:mt-0 lg:mt-0",variant:"light",onClick:()=>t(),children:(0,i.jsx)(m.default,{className:"opacity-85 xs:size-3.5 sm:size-4 md:size-4 lg:size-4",src:y.Z,alt:"Close"})}),(0,i.jsx)("div",{className:"size-[64px] sm:size-[48px]"})]})},_=()=>(0,i.jsx)("div",{className:"flex size-full flex-col items-center gap-3 sm:gap-1 md:gap-1 xs:gap-1",children:(0,i.jsx)(C,{goBack:()=>null})}),I=e=>{let{children:t}=e;return(0,i.jsx)("aside",{id:"modal-aside",className:"flex sm:min-w-96 max-w-full flex-1 flex-col gap-3 border-l border-white-400/10 bg-black-400 p-3 md:min-h-full md:max-w-96 md:flex-none xs:h-auto",children:t})};var P=l(39992);let S=e=>{let{handle:t,avatar:l,name:a,lastUpdated:s}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(d.default,{href:"/u/".concat(t),children:(0,i.jsx)(m.default,{src:null!=l?l:"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png",alt:null!=t?t:"Anonymous",width:48,height:48,className:"size-10 rounded-full bg-black-300"})}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,i.jsx)(d.default,{href:"/u/".concat(t),children:(0,i.jsx)("h2",{className:"text-sm font-bold",children:null!=a?a:"Anonymous"})}),(0,i.jsxs)("h3",{className:"text-xs font-medium text-white-400/75",children:["Updated ",(0,P.Po)(s)]})]})]})};var z=l(35875),A=l(93078);let D=e=>{let{id:t,saveFn:l=o.P.saveMeme,isSaved:a,variant:s="flat"}=e,[r,c]=(0,n.useState)(a),d=()=>{c(!r),l(t,r).catch(()=>{c(r)})};return(0,i.jsx)(z.e,{content:"Save to library",placement:"bottom",motionProps:{variants:{exit:{opacity:0,transition:{duration:.1,ease:"easeIn"}},enter:{opacity:1,transition:{duration:.15,ease:"easeOut"}}}},children:(0,i.jsx)(u.A,{isIconOnly:!0,size:"md",radius:"full",variant:"ghost",onClick:e=>{e.stopPropagation(),e.preventDefault(),d()},children:(0,i.jsx)(A.JO,{icon:r?"material-symbols:bookmark":"material-symbols:bookmark-outline",width:20})})})};var R=l(49955),O=l(6566),M=l(24449),E={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/checkmark.02facbc0.svg",height:46,width:46,blurWidth:0,blurHeight:0};let T=e=>{let{meme:t,isDeckCreator:l,onAccept:a,onReject:s}=e,{onOpenMeme:n}=ew();return(0,i.jsxs)("div",{className:"flex gap-3 border-b border-white-400/10 py-2",children:[(0,i.jsx)(m.default,{width:100,height:100,src:t.meme_image,alt:t.meme_id,onClick:()=>n(t.meme_id),className:"size-24 cursor-pointer rounded-lg bg-black-400 object-contain object-center"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,i.jsx)("p",{className:"truncate font-medium",children:(0,P.Po)(t.timestamp)}),(0,i.jsxs)("p",{className:"truncate text-white-400/75",children:["by ",t.creator_handle]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(u.A,{isIconOnly:!0,variant:"light",size:"sm",className:"rounded-full",onClick:()=>s(t.meme_id),children:(0,i.jsx)(m.default,{src:y.Z,width:16,height:16,alt:"Accept",className:"w-3"})}),l&&(0,i.jsx)(u.A,{isIconOnly:!0,size:"sm",className:"rounded-full",onClick:()=>a(t.meme_id),children:(0,i.jsx)(m.default,{src:E,width:16,height:16,alt:"Accept",className:"w-3"})})]})]})};var U=l(94667);let L=e=>{let{meme:t}=e,{onOpenMeme:l}=ew();return(0,i.jsxs)("div",{className:"flex cursor-pointer gap-3 border-b border-white-400/10 py-2",onClick:()=>l(t.meme_id),children:[(0,i.jsx)(m.default,{width:100,height:100,src:t.meme_image,alt:t.meme_id,className:"size-24 rounded-lg bg-black-400 object-contain object-center"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,i.jsx)("p",{className:"truncate font-medium",children:(0,P.Po)(t.timestamp)}),(0,i.jsxs)("p",{className:"truncate text-white-400/75",children:["by ",t.creator_handle]})]}),(0,i.jsx)(U.x,{})]})};var W=l(17432);(a=s||(s={})).Pending="Pending",a.Accepted="Accepted";let G=e=>{let{tab:t,badgeCount:l}=e;return(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{children:t}),l>0&&(0,i.jsx)(W.z,{size:"sm",variant:"flat",children:l})]})};var H={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/info.333102d7.svg",height:24,width:24,blurWidth:0,blurHeight:0},V=l(47177),F=l(81840);let Z=e=>{let{deckId:t,deck:l,isDeckCreator:a,refetchDeck:r}=e,{startUpload:c}=(0,V.useUpload)(),[d,f]=(0,n.useState)(s.Pending),[g,b]=(0,n.useState)([]),[v,j]=(0,n.useState)(!1),[w,y]=(0,n.useState)(!1),N=g.filter(e=>"pending"===e.status),k=N.length,C=g.filter(e=>"accepted"===e.status),_=C.length,I=(0,n.useCallback)(()=>{j(!0),o.P.getDeckSubmissions(t).then(b).finally(()=>j(!1))},[t]),S=(0,n.useCallback)(e=>{o.P.updateDeckSubmission(t,e,"accepted",Object.keys(l.memes).length+1).then(()=>{r(),I()})},[t,l.memes,r,I]),A=(0,n.useCallback)(e=>{o.P.updateDeckSubmission(t,e,"rejected").then(()=>I())},[t,I]),D=(0,n.useCallback)(e=>{o.P.deleteDeckSubmission(t,e).then(()=>I())},[t,I]),E=async e=>{if(e&&0!==e.length&&!w){y(!0);for(let l=0;l<e.length;l++){let a=e[l];await c(a,t)}y(!1),I()}};return(0,n.useEffect)(()=>{I()},[I]),(0,i.jsxs)(x.w,{children:[(0,i.jsxs)(h.u,{className:"flex gap-3 pb-0 pt-3",children:[(0,i.jsx)("h3",{className:"flex-1 truncate text-lg font-semibold",children:a?"Submissions":"Submit your memes"}),(0,i.jsx)(z.e,{placement:"bottom",content:a?(0,i.jsx)("div",{className:"w-52",children:"Users can submit meme suggestions to your deck. You can either accept or reject them."}):(0,i.jsx)("div",{className:"w-52",children:"Submit your meme suggestions to the deck. They will appear in the deck once accepted by the creator."}),children:(0,i.jsx)(m.default,{src:H,width:16,height:16,alt:"Info"})})]}),(0,i.jsx)(p.G,{className:"h-96",children:(0,i.jsxs)(R.n,{fullWidth:!0,"aria-label":"Memes submissions form",variant:"bordered",selectedKey:d,onSelectionChange:e=>f(e),children:[(0,i.jsx)(O.r,{className:"flex max-h-full min-h-0 flex-1 pb-1",title:(0,i.jsx)(G,{tab:s.Pending,badgeCount:k}),children:(0,i.jsxs)("form",{className:"flex min-h-full flex-1 flex-col gap-3",children:[(0,i.jsx)(F.c,{deckId:t,isUploading:w,hasBorder:0===k,hasClick:0===k,disabled:a||w||v,setIsUploading:y,onFinish:I,children:0===k?(0,i.jsx)("div",{className:"flex flex-1 items-center justify-center",children:v||w?(0,i.jsx)(M.c,{}):(0,i.jsx)("p",{className:"text-sm text-white-400/75",children:a?"No pending submissions":"Click or drop to submit a meme"})}):(0,i.jsx)("div",{className:"max-h-full flex-1 overflow-y-auto w-full",children:N.sort((e,t)=>t.timestamp-e.timestamp).map((e,t)=>(0,i.jsx)(T,{meme:e,isDeckCreator:a,onAccept:S,onReject:a?A:D},t))})}),!a&&(0,i.jsxs)("div",{className:"relative h-10 w-full",children:[(0,i.jsx)(u.A,{color:"primary",className:"h-10 w-full",isDisabled:w,isLoading:w&&k>0,children:w&&k>0?"Uploading":"Upload"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:P.RL,className:"absolute inset-0 size-full cursor-pointer opacity-0",onChange:e=>E(e.target.files)})]})]})},s.Pending),(0,i.jsx)(O.r,{className:"flex max-h-full min-h-0 flex-1 pb-1",title:(0,i.jsx)(G,{tab:s.Accepted,badgeCount:_}),children:(0,i.jsxs)("form",{className:"flex min-h-full flex-1 flex-col gap-3",children:[(0===_||v)&&(0,i.jsx)("div",{className:"flex flex-1 items-center justify-center",children:v?(0,i.jsx)(M.c,{}):(0,i.jsx)("p",{className:"text-sm text-white-400/50",children:"No accepted submissions"})}),_>0&&!v&&(0,i.jsx)("div",{className:"max-h-full flex-1 overflow-y-auto",children:C.map((e,t)=>(0,i.jsx)(L,{meme:e},t))})]})},s.Accepted)]})})]})};var K=l(10822),Y=l(56582);let B=e=>{var t;let{deck:l,refetchDeck:a}=e,s=(0,c.useRouter)(),{profile:n}=(0,Y.O)();return(0,i.jsx)(I,{children:l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("header",{className:"my-2 flex flex-col gap-5",children:[(0,i.jsx)(S,{handle:l.creator_handle,name:l.creator_name,avatar:l.creator_avatar,lastUpdated:l.updated_at||l.created_at}),(0,i.jsxs)("div",{className:"ml-1 flex flex-col gap-1",children:[(0,i.jsx)("h2",{className:"text-lg font-bold text-white-400",children:l.name}),(0,i.jsx)("p",{className:"text-white-400/50",children:l.description})]}),(0,i.jsxs)("div",{className:"flex min-w-0 max-w-full flex-1 justify-between gap-2",children:[(0,i.jsx)(K.I,{size:"md",itemId:l.id,userId:null!==(t=null==n?void 0:n.user.id)&&void 0!==t?t:"",addVoteApi:o.P.createDeckReaction,removeVoteApi:o.P.deleteDeckReaction}),l.is_creator?(0,i.jsx)(u.A,{variant:"solid",onClick:()=>{l&&s.push("/deck/edit/".concat(l.id))},children:"Edit"}):(0,i.jsx)(D,{id:l.id,isSaved:l.is_bookmarked,saveFn:o.P.bookmarkDeck})]})]}),(0,i.jsx)("section",{className:"md:flex-1"}),(0,i.jsx)("footer",{className:"flex flex-col gap-3",children:(0,i.jsx)(Z,{deckId:l.id,deck:l,isDeckCreator:l.is_creator,refetchDeck:a})})]})})},J=e=>{let{deckId:t,onClose:l}=e,[a,s]=(0,n.useState)(null),r=(0,n.useMemo)(()=>{var e;return null!==(e=null==a?void 0:a.memes)&&void 0!==e?e:{}},[null==a?void 0:a.memes]),d=(0,c.useSearchParams)().get("memeIndex"),[m,u]=(0,n.useState)(d?parseInt(d):0),x=(0,n.useCallback)(e=>{e.stopPropagation(),m>=Object.keys(r).length-1||u(e=>e+1)},[m,r]),h=(0,n.useCallback)(e=>{e.stopPropagation(),0!=m&&u(e=>e-1)},[m]),f=(0,n.useCallback)(()=>{let e=decodeURIComponent(t);o.P.getDeck(e).then(s)},[t]);return(0,n.useEffect)(()=>{f()},[f]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key?null==l||l():"ArrowLeft"===e.key?h(e):"ArrowRight"===e.key&&x(e)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[l,x,h]),(0,i.jsxs)("div",{className:"flex size-full flex-1 flex-col overflow-y-auto md:flex-row",children:[a?(0,i.jsx)(k,{deck:a,currentIndex:m,onNextMeme:x,onPrevMeme:h}):(0,i.jsx)(_,{}),(0,i.jsx)(B,{deck:a,refetchDeck:f})]})},$=e=>{let{deckId:t,onClose:l}=e;return r(),(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex size-full min-w-full max-w-full items-center justify-center overflow-y-auto bg-black-400/90 md:overflow-hidden",onClick:e=>{let t=e.target;t.closest("#deck-modal")||t.closest("#deck-modal-prev")||t.closest("#deck-modal-next")||t.closest("#modal-aside")||l()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},children:(0,i.jsx)(J,{deckId:t,onClose:l})})};var q=l(67630),X=l(40538);let Q=e=>{let{deck:t}=e;return(0,i.jsxs)(d.default,{className:"flex w-full min-w-0 items-center gap-3 pt-0",href:(0,X.bb)(t),children:[(0,i.jsx)(m.default,{alt:t.name,src:t.cover_image_url,width:40,height:40,className:"bg-white-400/5 size-10 overflow-hidden rounded-md object-cover object-center"}),(0,i.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,i.jsx)("h3",{className:"truncate text-base font-semibold",children:t.name}),(0,i.jsx)("p",{className:"text-white-400/50 truncate text-sm",children:t.description})]})]})};var ee=l(41917),et=l(6987),el=l(54897);let ea=e=>{var t;let{meme:l,onTogglePublish:a}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ee.d,{itemClasses:{subtitle:"text-sm text-white-400/50",trigger:"text-base font-semibold",indicator:"text-lg",content:"pt-0 text-small"},variant:"shadow",selectionMode:"multiple",defaultSelectedKeys:["2","3","4"],children:[l.template_data?(0,i.jsx)(et.G,{"aria-label":l.template_data.title,startContent:(0,i.jsx)(v.R,{className:"size-12 rounded-md object-cover",src:l.template_data.image_url,alt:l.template_data.title}),subtitle:l.template_data.title,classNames:{title:"font-base text-sm text-white-400/50",subtitle:"text-large font-semibold text-white-400",content:"pb-4 pt-0"},title:"Meme Template",children:(0,i.jsx)("p",{className:"text-sm",children:l.template_data.about})},"1"):(0,i.jsx)(et.G,{hideIndicator:!0,isDisabled:!0,title:"Meme template","aria-label":"No template detected",subtitle:"No template detected"},"1"),l.extracted_text?(0,i.jsx)(et.G,{title:"Extracted text",classNames:{base:"pb-2 pt-0",trigger:"pt-4 pb-2 text-base font-semibold",content:"pb-2 pt-0"},children:(0,i.jsx)("p",{className:"text-sm",children:l.extracted_text})},"2"):(0,i.jsx)(et.G,{title:"Extracted text",classNames:{base:"pb-2 pt-0",trigger:"pt-4 pb-2 text-base font-semibold",content:"pb-2 pt-0"},subtitle:"No text was extracted","aria-label":"No extracted text",hideIndicator:!0,isDisabled:!0},"2"),l.tags.length>0?(0,i.jsx)(et.G,{classNames:{content:"pb-4 pt-0"},title:"Keywords (".concat(l.tags.length,")"),children:(0,i.jsx)(q.$,{tags:l.tags.map(e=>{let{name:t}=e;return t})})},"3"):(0,i.jsx)(et.G,{hideIndicator:!0,isDisabled:!0,title:"Tags","aria-label":"No tags added",subtitle:"No tags added"},"3"),l.appears_in_count>0?(0,i.jsx)(et.G,{title:"Appears in (".concat(l.appears_in_count,")"),classNames:{content:"pb-4 pt-0"},children:null===(t=l.appears_in)||void 0===t?void 0:t.map((e,t)=>(0,i.jsx)("div",{className:"".concat(t!=l.appears_in_count-1?"mb-2":""),children:(0,i.jsx)(Q,{deck:e},e.id)},t))},"4"):(0,i.jsx)(et.G,{hideIndicator:!0,isDisabled:!0,title:"Appears in","aria-label":"This meme isn't in any decks yet",subtitle:"This meme isn't in any decks yet"},"4")]}),l.is_creator&&(0,i.jsx)(el.i,{isSelected:l.is_public,onValueChange:a,classNames:{base:"inline-flex shadow-medium flex-row-reverse min-w-full w-full max-w-md bg-content1 hover:bg-content2 items-center justify-between cursor-pointer rounded-xl gap-2 p-4 hover:outline-1 border-transparent data-[selected=true]:border-primary",wrapper:"p-0 h-4 overflow-visible",thumb:"w-6 h-6 border-2 group-data-[hover=true]:border-primary group-data-[selected=true]:ml-6 group-data-[pressed=true]:w-7 group-data-[selected]:group-data-[pressed]:ml-4 bg-white-400"},children:(0,i.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,i.jsx)("p",{className:"text-base text-white-400 font-semibold",children:"Public"}),(0,i.jsx)("p",{className:"text-sm text-white-400/50",children:"Your meme will be discoverable."})]})})]})};var es=l(40123),ei=l(21087),en=l(58741);let er=(0,en.k)(o.P.tagResource,1e3),ec=e=>{let{memeId:t,tags:l,onUpdateTags:a}=e,s=l.length<10?[...l,{id:"",name:""}]:l,n=async e=>{a(l.filter(t=>t.id!==e));try{await o.P.untagResource(t,e)}catch(e){a(l)}},r=async(e,s)=>{let i=s.toLowerCase().replaceAll(" ","_").replaceAll("-","_"),n=[...l];n[e]={id:i,name:s},a(n);try{var r;await er(t,s),(null===(r=l[e])||void 0===r?void 0:r.id)&&await o.P.untagResource(t,l[e].id)}catch(e){a(l)}};return(0,i.jsx)("div",{className:"flex mb-3 gap-2 overflow-x-auto scrollbar-hide",children:s.map((e,t)=>(0,i.jsx)(ei.V,{tagId:e.id,tagName:e.name,minW:"min-w-[124px]",variant:"faded",onUpdateTag:e=>r(t,e),onDeleteTag:()=>n(e.id)},"tag-pill-".concat(e.id,"-").concat(t)))})},eo=(0,en.k)(o.P.updateMeme,1e3),ed=e=>{let{meme:t,setMeme:l,onTogglePublish:a}=e,s=(0,n.useCallback)(async e=>{t&&l({...t,tags:e})},[t,l]),r=(0,n.useCallback)(async e=>{if(t){l({...t,extracted_text:e});try{await eo(t.id,{extracted_text:e})}catch(e){l(t)}}},[t,l]);return t?(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)(es.Y,{label:(0,i.jsxs)("div",{className:"flex gap-1.5 items-center",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Extracted text"}),(0,i.jsx)(z.e,{placement:"bottom",content:(0,i.jsx)("div",{className:"w-52",children:"This is AI extracted text from the meme image. You can correct it if needed here."}),children:(0,i.jsx)(m.default,{src:H,width:19,height:19,alt:"Info"})})]}),placeholder:"This is AI extracted text from the meme image. You can correct it if needed here.",classNames:{base:"p-0 hover:outline-1 border-transparent",mainWrapper:"p-0",inputWrapper:"px-0 py-4 gap-2 bg-content1 hover:bg-content2",label:"flex px-4 text-lg !text-white-400 font-semibold",innerWrapper:"px-4",input:"text-white-400/50"},value:t.extracted_text,onValueChange:r}),(0,i.jsxs)(x.w,{children:[(0,i.jsx)("header",{className:"p-4",children:(0,i.jsxs)("div",{className:"flex gap-1.5 items-center",children:[(0,i.jsx)("h3",{className:"text-base font-semibold",children:"Keywords"}),(0,i.jsx)(z.e,{placement:"bottom",content:(0,i.jsx)("div",{className:"w-52",children:"The right set of keywords can help others find your meme."}),children:(0,i.jsx)(m.default,{src:H,width:16,height:16,alt:"Info"})})]})}),(0,i.jsx)(p.G,{className:"p-4 pt-0",children:(0,i.jsx)(ec,{memeId:t.id,tags:t.tags,onUpdateTags:s})})]}),(0,i.jsx)(el.i,{isSelected:t.is_public,onValueChange:a,classNames:{base:"inline-flex shadow-medium flex-row-reverse min-w-full w-full max-w-md bg-content1 hover:bg-content2 items-center justify-between cursor-pointer rounded-xl gap-2 p-4 hover:outline-1 border-transparent data-[selected=true]:border-primary",wrapper:"p-0 h-4 overflow-visible",thumb:"w-6 h-6 border-2 group-data-[hover=true]:border-primary group-data-[selected=true]:ml-6 group-data-[pressed=true]:w-7 group-data-[selected]:group-data-[pressed]:ml-4 bg-white-400"},children:(0,i.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,i.jsx)("p",{className:"text-base text-white-400 font-semibold",children:"Public"}),(0,i.jsx)("p",{className:"text-sm text-white-400/50",children:"Your meme will be discoverable."})]})})]}):null};var em=l(74491),eu=l(71904);let ex=e=>{let{memeId:t,onClose:l}=e,{feed:a,setFeed:s,searchResults:r,setSearchResults:c,library:d,setLibrary:m,uploads:x,setUploads:h,saved:f,setSaved:p}=(0,em.useFeed)(),[g,b]=(0,n.useState)(!1);return(0,i.jsx)(z.e,{content:"Delete",placement:"bottom",motionProps:{variants:{exit:{opacity:0,transition:{duration:.1,ease:"easeIn"}},enter:{opacity:1,transition:{duration:.15,ease:"easeOut"}}}},children:(0,i.jsx)(u.A,{isIconOnly:!0,size:"md",radius:"full",variant:"ghost",color:"danger",isLoading:g,onClick:()=>{b(!0),o.P.deleteMeme(t).then(()=>{s(a.filter(e=>"meme"!==e.post_type||e.post.id!==t)),c(r.filter(e=>e.id!==t)),m(d.filter(e=>e.id!==t)),h(x.filter(e=>e.id!==t)),p(f.filter(e=>e.id!==t)),l(),(0,eu.yv)("Meme deleted",{variant:"success",autoHideDuration:2e3})}).catch(()=>{b(!1),(0,eu.yv)("Failed to delete meme",{variant:"error",autoHideDuration:2e3})})},children:(0,i.jsx)(A.JO,{icon:"fluent:delete-24-regular",width:18})})})},eh=e=>{var t,l;let{meme:a,setMeme:s,onClose:r}=e,d=(0,c.useRouter)(),{profile:m}=(0,Y.O)(),{removeItemFromFeed:x,appendMemesToFeed:h}=(0,em.useFeed)(),[f,p]=(0,n.useState)(!1),[g,b]=(0,n.useState)(!1),v=(0,n.useCallback)(async(e,t)=>{let l=new Date().getTime(),a={...e,published_at:l,is_public:!0};s(a),h([a],t),await o.P.publishMeme(e.id)||(s(e),x(a.id))},[h,x,s]),j=(0,n.useCallback)(async(e,t)=>{let l={...e,published_at:void 0,is_public:!1};s(l),x(l.id),await o.P.unpublishMeme(e.id)||(s(e),h([l],t))},[h,x,s]),w=(0,n.useCallback)(e=>{a&&m&&(e?v(a,m):j(a,m))},[a,m,v,j]),y=(0,n.useCallback)(async()=>{a&&(b(!0),await o.P.createPost({post_type:{meme:a.id}}),b(!1),m&&(h([a],m),d.push("/home")))},[h,a,m,d]);return(0,i.jsx)(I,{children:a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("header",{className:"my-2 flex flex-col gap-5",children:(0,i.jsx)(S,{handle:a.creator_handle,name:a.creator_name,avatar:a.creator_avatar,lastUpdated:a.updated_at||a.published_at||a.created_at})}),f?(0,i.jsx)(ed,{meme:a,setMeme:s,onTogglePublish:w}):(0,i.jsx)(ea,{meme:a,onTogglePublish:w}),(0,i.jsxs)("footer",{className:"flex justify-between gap-2 md:gap-3",children:[f?(0,i.jsx)(ex,{memeId:a.id,onClose:r}):(0,i.jsxs)("div",{className:"flex flex-1 gap-2 md:gap-3",children:[(0,i.jsx)(K.I,{size:"md",itemId:a.id,userId:null!==(t=null==m?void 0:m.user.id)&&void 0!==t?t:"",addVoteApi:o.P.createMemeReaction,removeVoteApi:o.P.deleteMemeReaction}),(0,i.jsx)(D,{id:a.id,isSaved:null!==(l=a.is_saved)&&void 0!==l&&l})]}),a.is_creator&&f&&(0,i.jsx)(u.A,{variant:"solid",color:"primary",onClick:()=>p(!1),children:"Done"}),a.is_creator&&!f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{variant:"solid",onClick:()=>p(!0),children:"Edit"}),(0,i.jsx)(u.A,{variant:"solid",color:"primary",isLoading:g,onClick:y,children:"Post"})]})]})]})})};var ef=l(74078);let ep=e=>{var t,l,a,s;let{meme:n}=e;return(0,i.jsx)(N,{children:(0,i.jsx)("div",{className:"flex size-full max-h-full min-h-0 flex-row items-center justify-center gap-3 overflow-hidden px-0 lg:gap-6 lg:p-3",children:n&&(0,i.jsx)("div",{className:"w-full max-w-full min-h-0 max-h-full lg:w-[".concat(n.width,"px] lg:h-[").concat(n.height,"px] lg:rounded-xl border-1 border-white-400/5 bg-black-400 overflow-hidden"),children:(0,i.jsx)(ef.g,{id:"meme-lightbox-image",width:n.width,height:n.height,src:n.url,alt:n.caption,topText:null!==(a=null===(t=n.text_overlay)||void 0===t?void 0:t.top_text)&&void 0!==a?a:null,bottomText:null!==(s=null===(l=n.text_overlay)||void 0===l?void 0:l.bottom_text)&&void 0!==s?s:null})})})})},eg=e=>{let{memeId:t,onClose:l}=e;r();let[a,s]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=decodeURIComponent(t);o.P.getMeme(e).then(e=>{s(e)})},[t]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&l()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[l]),(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex size-full items-center justify-center bg-black-400/90 sm:overflow-y-auto md:overflow-hidden xs:overflow-y-auto",onClick:e=>{let t=e.target;t.closest("#modal-aside")||t.closest("#meme-lightbox-image")||l()},onDragOver:e=>(e.preventDefault(),e.stopPropagation(),!1),children:(0,i.jsxs)("div",{className:"flex size-full flex-1 flex-col sm:overflow-y-auto md:flex-row",children:[(0,i.jsx)(ep,{meme:a}),(0,i.jsx)(eh,{meme:a,setMeme:s,onClose:l})]})})};var eb=l(13296);let ev=(0,n.createContext)({}),ej=e=>{var t,l;let{children:a}=e,s=(0,c.useRouter)(),n=(0,c.usePathname)(),r=(0,c.useSearchParams)(),o=decodeURIComponent(null!==(t=r.get("memeId"))&&void 0!==t?t:""),d=decodeURIComponent(null!==(l=r.get("deckId"))&&void 0!==l?l:""),m=new URLSearchParams(r.toString()),{openMemeModal:u}=(0,eb.T)(),x=()=>{m.delete("memeId");let e=(0,X.wS)(n,m);s.push(e,{scroll:!1})};return(0,i.jsxs)(ev.Provider,{value:{onOpenDeck:e=>{m.delete("memeId");let t=encodeURIComponent(e);m.set("deckId",t);let l=(0,X.wS)(n,m);s.push(l,{scroll:!1})},onOpenMeme:u,onCloseMeme:x},children:[a,o&&(0,i.jsx)(eg,{memeId:o,onClose:x}),d&&(0,i.jsx)($,{deckId:d,onClose:()=>{m.delete("deckId"),m.delete("memeIndex");let e=(0,X.wS)(n,m);s.push(e,{scroll:!1})}})]})},ew=()=>(0,n.useContext)(ev)},33135:function(e,t){t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/plus.63a0d87f.svg",height:24,width:24,blurWidth:0,blurHeight:0}},69919:function(e,t){t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/xmark.ac6fe3e8.svg",height:48,width:48,blurWidth:0,blurHeight:0}}}]);