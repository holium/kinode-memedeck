(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[148],{28119:function(e,t,a){Promise.resolve().then(a.bind(a,79439))},79439:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var r=a(91104),s=a(63137),l=a(26816),n=a(87221),c=a(61698),i=a(64737),o=a(33968),h=a(9051),d=a(60402),u=a(41116),m=a(83301),x=a(30027);let f=e=>{let{ranking:t,character:a}=e;return(0,r.jsx)(x.default,{href:"/character/".concat(a.character.replace("ai_character:","")),className:"scale-img-on-hover select-none",children:(0,r.jsxs)("div",{className:"relative cursor-pointer min-w-28 w-28 md:min-w-40 md:w-40 overflow-hidden flex flex-col justify-center bg-black-400 hover:bg-black-200 rounded-lg shadow-lg hover:shadow-2xl",children:[(0,r.jsx)("div",{className:"w-full overflow-hidden",children:(0,r.jsx)(m.default,{src:a.thumbnail,alt:a.name,width:256,height:256,className:"size-full aspect-square object-cover object-center"})}),(0,r.jsx)("div",{className:"flex px-3 h-10 items-center",children:(0,r.jsxs)("h3",{className:"flex gap-2 font-medium text-md tracking-wide w-full",children:[(0,r.jsx)("span",{className:"text-white-400/70",children:t}),(0,r.jsx)("span",{className:"text-white-400/95 truncate",children:a.name})]})})]})},a.character)},w=e=>{let{interval:t}=e,{topCharacters:a,setTopCharacters:l}=(0,u.useProfile)(),n=a.filter(e=>"ai_character:normal"!==e.character),[c,i]=(0,s.useState)(!0),h=(0,s.useCallback)(async e=>{i(!0),o.P.getTopCharacters({interval:e,limit:20}).then(l).finally(()=>i(!1))},[l]);return((0,s.useEffect)(()=>{h(t)},[h,t]),c&&0===a.length)?(0,r.jsx)("div",{className:"flex px-3 gap-3 w-full overflow-x-auto scrollbar-hide",children:[1,2,3,4,5].map(e=>(0,r.jsx)("div",{className:"min-w-[112px] w-[112px] h-[152px] md:min-w-40 md:h-[200px] bg-black-400 rounded-lg shadow-lg hover:shadow-2xl"},e))}):(0,r.jsx)("div",{className:"flex px-3 gap-3 w-full overflow-x-auto scrollbar-hide",children:n.sort((e,t)=>t.total_generations-e.total_generations).map(e=>(0,r.jsx)(f,{ranking:e.rank,character:e},e.character))})};var p=a(71035),v=a(41340),b=a(21204);let g=e=>{let{size:t="sm",interval:a,onSelect:s}=e;return(0,r.jsx)(p.g,{size:t,radius:"full",variant:"bordered",color:"primary",placeholder:"Sort by",className:"w-32",value:a,selectedKeys:[a],onChange:e=>{s(e.target.value)},children:Object.values(b.u).map(e=>(0,r.jsx)(v.R,{children:e.charAt(0).toUpperCase()+e.slice(1)},e))})};async function j(e,t){return(await o.P.search(e,t)).memes}function k(){var e;let t=null!==(e=(0,l.useSearchParams)().get("query"))&&void 0!==e?e:void 0,{searchInterval:a,setSearchInterval:o}=(0,u.useProfile)(),{searchQuery:m,setSearchQuery:x,searchResults:f,setSearchResults:p,hasFetchedSearchResults:v,setHasFetchedSearchResults:b}=(0,d.useFeed)(),{isFetching:k,onSearch:N}=(0,i.M)({feed:f,setFeed:p,hasFetched:v,setHasFetched:b,searchQuery:m,setSearchQuery:x,initialQuery:t,fetchOnLoad:!0,interval:a,fetchFn:j}),y=(0,s.useMemo)(()=>m.length>0,[m.length]);return(0,s.useEffect)(()=>(t&&x(t),()=>{x(""),p([]),b(!1)}),[t,x,p,b]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex pr-3 items-center justify-between",children:[(0,r.jsx)(n.SearchBar,{autofocus:!0,initialSearch:t,border:"border-b border-transparent",value:m,onSearch:e=>N(e,a)}),y&&(0,r.jsx)(g,{size:"md",interval:a,onSelect:e=>{p([]),o(e)}})]}),!y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"flex items-end p-3 gap-4",children:[(0,r.jsx)("h1",{className:"text-white-400 font-bold text-3xl tracking-wide",children:"Explore"}),(0,r.jsx)(g,{interval:a,onSelect:e=>{p([]),o(e),N("",e)}})]}),(0,r.jsx)("h4",{className:"p-3 text-white-400/70 tracking-wide font-bold uppercase text-sm md:text-base",children:"Top Characters"}),(0,r.jsx)(w,{interval:a}),(0,r.jsx)("h4",{className:"px-3 pt-6 pb-0 text-white-400/70 tracking-wide font-bold uppercase text-sm md:text-base",children:"Trending Memes"})]}),(0,r.jsx)(c.o,{memes:f,isFetching:k,hasFetched:v,hasSearched:y,renderItem:(e,t)=>(0,r.jsx)(h.P,{meme:e},t)})]})}},87221:function(e,t,a){"use strict";a.r(t),a.d(t,{SearchBar:function(){return c}});var r=a(91104),s=a(26816),l=a(26645),n=a(18262);let c=e=>{let{value:t,autofocus:a,initialSearch:c,responsiveness:i="",border:o="border-b border-white-400/15",placeholder:h,hideLogo:d=!1,onSearch:u}=e,m=(0,s.useRouter)();return(0,r.jsxs)("div",{className:"sticky top-0 z-10 flex gap-3 h-16 w-full items-center bg-black-0 px-3 ".concat(i," ").concat(o),onClick:()=>{u||m.push("/explore")},children:[!d&&(0,r.jsx)("div",{className:"sm:hidden size-10 max-w-10",children:(0,r.jsx)(l.Ew,{})}),(0,r.jsx)(n.T,{value:t,autofocus:a,initialSearch:c,placeholder:h,onSearch:u})]})}},64737:function(e,t,a){"use strict";a.d(t,{M:function(){return n}});var r=a(63137),s=a(29125),l=a(21204);let n=e=>{let{feed:t,setFeed:a,hasFetched:n,setHasFetched:c,searchQuery:i,setSearchQuery:o,fetchFn:h,initialQuery:d,characterId:u,interval:m=l.u.AllTime,fetchOnLoad:x=!0,pageSize:f=50,ignoreWindowScroll:w=!1,onFetchOnLoad:p}=e,[v,b]=(0,r.useState)(0),[g,j]=(0,r.useState)(!0),[k,N]=(0,r.useState)(!1),y=(0,r.useCallback)(async(e,t)=>{let r=await h(e,t);return a(t=>r.length>0&&Number(e.start)>0?[...t,...r]:r),N(!1),c(!0),j(r.length===f),r},[h,f,a,c]),S=(0,r.useMemo)(()=>(0,s.k)(y,1e3),[y]),C=(0,r.useCallback)(async(e,t)=>{var a,r,s,l;return N(!0),c(!1),S({search:null!==(a=e.search)&&void 0!==a?a:i,start:null!==(r=e.start)&&void 0!==r?r:v,limit:null!==(s=e.limit)&&void 0!==s?s:f,interval:null!==(l=e.interval)&&void 0!==l?l:m,...u&&{character_id:u}},t)},[u,S,m,f,i,c,v]),E=(0,r.useCallback)(()=>{if(!n||!g||k)return;let e=v+f;b(e),C({start:e})},[n,g,k,v,f,C]),_=(0,r.useCallback)(async()=>{let e=window.innerHeight;document.body.offsetHeight-window.scrollY<3*e&&E()},[E]),F=(0,r.useCallback)(e=>{let t=new URL(window.location.href);e.length>0?t.searchParams.set("query",e):t.searchParams.delete("query"),window.history.pushState({},"",t.toString())},[]),P=(0,r.useCallback)(async(e,t)=>{null==o||o(e),o&&F(e),b(0),j(!0),C({search:e,start:0,limit:f,interval:t})},[C,f,o,F]);return(0,r.useEffect)(()=>{if(!w)return window.addEventListener("scroll",_),()=>window.removeEventListener("scroll",_)},[_,w]),(0,r.useEffect)(()=>{let e=new AbortController;if(!n&&!(t.length>0)&&x&&!k)return C({search:d,start:0,limit:f},e.signal).then(p),()=>{!e.signal.aborted&&k&&e.abort()}},[t.length,C,x,n,d,k,p,f]),{feed:t,setFeed:a,setHasMore:j,onSearch:P,isFetching:k,hasMore:g,setIsFetching:N,setHasFetched:c,onReachedEnd:E}}}},function(e){e.O(0,[826,349,223,98,542,35,915,634,130,514,171,744],function(){return e(e.s=28119)}),_N_E=e.O()}]);