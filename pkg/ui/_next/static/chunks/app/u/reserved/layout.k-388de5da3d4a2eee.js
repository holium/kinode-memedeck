(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{50197:function(e,t,r){Promise.resolve().then(r.bind(r,5128))},9577:function(e,t,r){"use strict";r.r(t),r.d(t,{Page:function(){return f}});var a=r(91104),s=r(63137),l=r(26816),n=r(41116),i=r(33968),o=r(71668),c=r(41908),u={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/cloud.c8336d47.svg",height:74,width:74,blurWidth:0,blurHeight:0},d=r(83301);let m=()=>{let{isBatchUploading:e}=(0,o.useUpload)();return(0,a.jsx)("div",{className:"relative size-full min-w-0 p-3",children:(0,a.jsx)("div",{className:"relative flex size-full min-w-0 items-center justify-center rounded-xl border-3 border-dashed border-blue-400",children:e?(0,a.jsx)(c.c,{}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[(0,a.jsx)(d.default,{src:u,width:64,height:64,alt:"cloud",loading:"eager",className:"size-24"}),(0,a.jsx)("h2",{className:"text-center text-xl font-semibold text-white-400",children:"Drop bangers to upload"})]})})})},f=e=>{let{children:t,isGated:r=!0,border:o="xs:border-0 sm:border-x border-white-400/15"}=e,c=(0,l.useRouter)(),{profile:u,setProfile:d,isHovering:f,isPostingMemes:x}=(0,n.useProfile)();return(0,s.useEffect)(()=>{r&&!u&&i.P.getMe().then(d).catch(e=>{console.error(e),c.push("/")})},[r,u,c,d]),(0,a.jsx)("div",{className:"relative size-full min-w-0 xs:pb-16 ".concat(o),children:f&&!x?(0,a.jsx)(m,{}):t})}},29398:function(e,t,r){"use strict";r.d(t,{y:function(){return i}});var a=r(91104),s={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/arrow.left.37648ed6.svg",height:46,width:57,blurWidth:0,blurHeight:0},l=r(23640),n=r(48751);let i=e=>{let{title:t,border:r="border-b border-transparent",isLoading:i=!1,endContent:o,onGoBack:c}=e,{goBack:u}=(0,n.useAppHistory)();return(0,a.jsxs)("div",{className:"flex h-16 w-full items-center ".concat(r),children:[(0,a.jsx)(l.O,{src:s,alt:"Back",onClick:null!=c?c:u}),i?(0,a.jsx)("h1",{className:"h-6 w-24 animate-pulse rounded bg-gray-200"}):(0,a.jsx)("h1",{className:"flex-1 text-left text-lg font-bold truncate",children:t}),o]})}},23640:function(e,t,r){"use strict";r.d(t,{O:function(){return l}});var a=r(91104),s=r(83301);let l=e=>{let{src:t,alt:r,id:l,margin:n="m-2",w:i="w-3.5",onClick:o}=e;return(0,a.jsx)("button",{id:l,className:"flex size-9 items-center justify-center rounded-full hover:bg-black-100 ".concat(n),onClick:o,children:(0,a.jsx)(s.default,{priority:!0,src:t,alt:r,className:"opacity-85 ".concat(i)})})}},5128:function(e,t,r){"use strict";r.r(t),r.d(t,{ProfileBaseLayout:function(){return N}});var a,s,l=r(91104),n=r(9577),i=r(41116),o=r(30027),c=r(26816),u=r(28916),d=r(95930);(a=s||(s={})).Memes="Memes",a.Bookmarks="Bookmarks";let m=(e,t)=>{switch(e){case"Memes":return"/u/".concat(t);case"Bookmarks":return"/u/".concat(t,"/bookmarks");default:return""}},f=e=>{let{handle:t,isSelf:r}=e,a=(0,c.usePathname)();return(0,l.jsx)("div",{className:"relative flex min-w-full max-w-full flex-row items-center justify-between overflow-x-auto border-b-1 border-white-400/15 px-1.5",children:(0,l.jsx)(u.n,{color:"primary",variant:"underlined","aria-label":"Profile tabs",radius:"full",selectedKey:a,classNames:{base:"w-full xs:mt-2 mt-1",tabList:"gap-4 w-full relative rounded-none p-0 border-b border-divider px-3 xs:justify-center md:justify-start border-none",cursor:"w-full bg-blue-500",tab:"max-w-fit px-0 !h-12 select-none outline-none",tabContent:"group-data-[selected=true]:text-blue-500 px-1 text-white-400/75 font-semibold tracking-wide mb-1 !text-base !font-semibold"},children:Object.values(s).map(e=>{let r=m(e,t);return(0,l.jsx)(d.r,{className:"!focus-visible:outline-none",title:(0,l.jsx)("h2",{children:e}),as:o.default,href:r},r)})})})};var x=r(29398),h=r(63137),p=r(33968);let v=e=>{let{handle:t=""}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-12",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 px-3",children:[(0,l.jsx)("div",{className:"size-24 rounded-full bg-black-300"}),(0,l.jsx)("div",{className:"mb-2 flex flex-col gap-2",children:(0,l.jsxs)("h3",{className:"text-lg font-medium leading-4 text-white-400/70",children:["@",t]})})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-3 px-3",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold leading-6",children:"This account doesnâ€™t exist"}),(0,l.jsx)("p",{className:"text-lg font-medium leading-4 text-white-400/70",children:"Try searching for another."})]})]})};var g=r(48751),b=r(57826),w=r(49141),y=r(1490),_=r(54011),j=r(86600),k=r(49566);let N=e=>{var t;let{children:r}=e,a=null!==(t=(0,c.usePathname)().split("/")[2])&&void 0!==t?t:"",{profile:s}=(0,i.useProfile)(),{goBack:o}=(0,g.useAppHistory)(),[u,d]=(0,h.useState)(null),[m,N]=(0,h.useState)(!0),[P,S]=(0,h.useState)(),C=(0,h.useMemo)(()=>(null==s?void 0:s.twitter_profile.screen_name)===a,[a,s]),D=(0,h.useMemo)(()=>{var e;return null!==(e=null==P?void 0:P.profile_image_url_https.replace("_normal",""))&&void 0!==e?e:""},[P]);return((0,h.useEffect)(()=>{s&&!P&&(C?(S(s.twitter_profile),d(s.user.badge_image_url),N(!1)):p.P.getProfileByHandle(a).then(e=>{e?(S(e.twitter_profile),d(e.badge_image_url)):(S(null),d(null))}).catch(()=>{S(null)}).finally(()=>{N(!1)}))},[C,a,s,P]),m)?(0,l.jsx)(n.Page,{children:(0,l.jsxs)("div",{className:"flex size-full flex-col gap-3",children:[(0,l.jsx)(x.y,{title:"",isLoading:!0}),(0,l.jsxs)("div",{className:"mb-2 flex items-center gap-3 px-3",children:[(0,l.jsx)("div",{className:"size-24 animate-pulse rounded-full bg-gray-200"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("div",{className:"h-6 w-48 animate-pulse rounded bg-gray-200"}),(0,l.jsx)("div",{className:"h-4 w-32 animate-pulse rounded bg-gray-200"})]})]}),(0,l.jsx)(f,{handle:"",isSelf:C})]})}):P?(0,l.jsx)(n.Page,{children:(0,l.jsxs)("div",{className:"flex size-full flex-col gap-3",children:[(0,l.jsx)(x.y,{title:"Profile",onGoBack:()=>o("/home","/u/".concat(P.screen_name)),endContent:C?(0,l.jsx)(b.A,{isIconOnly:!0,variant:"flat",className:"flex md:hidden mr-3",onClick:()=>{p.P.logout().then(()=>{window.location.reload()})},children:(0,l.jsx)(k.JO,{icon:"iconamoon:exit",width:16})}):void 0}),(0,l.jsx)(w.z,{name:(0,l.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[(0,l.jsx)("h2",{className:"text-2xl font-black",children:P.name}),u&&(0,l.jsx)(y.J,{src:u,alt:"badge",className:"rounded-md",width:24,height:24})]}),classNames:{base:"flex sm:flex-col mb-2 xs:mb-2 xs:flex-col md:flex-row lg:flex-row xs:gap-2 sm:gap-4 justify-start sm:px-4",wrapper:"flex xs:items-center xs:gap-1 sm:gap-1 md:gap-0.5 sm:items-center md:items-start",name:"text-2xl font-bold"},description:(0,l.jsxs)(_.O,{href:"https://twitter.com/".concat(P.screen_name),size:"sm",className:"flex items-center text-base font-normal text-white-400/50",isExternal:!0,children:["@".concat(P.screen_name),(0,l.jsx)(j.x,{})]}),avatarProps:{className:"!xs:size-14 !size-24 overflow-hidden rounded-full",src:D,alt:P.screen_name}}),(0,l.jsx)(f,{handle:a,isSelf:C}),r]})}):(0,l.jsx)(n.Page,{children:(0,l.jsxs)("div",{className:"flex size-full flex-col gap-3",children:[(0,l.jsx)(x.y,{title:""}),(0,l.jsx)(v,{handle:a})]})})}},98127:function(e,t,r){"use strict";r.d(t,{T:function(){return l}});var a=r(17412),s=r(26816);let l=()=>{let e=(0,s.useRouter)(),t=(0,s.usePathname)(),r=(0,s.useSearchParams)(),l=e=>{let s=new URLSearchParams(r.toString());s.delete("deckId"),s.delete("memeIndex");let l=encodeURIComponent(e.replace("meme:",""));return s.set("memeId",l),(0,a.wS)(t,s)};return{openMemeModal:t=>{let r=l(t);e.push(r,{scroll:!1})},getMemeModalPath:l}}},48751:function(e,t,r){"use strict";r.r(t),r.d(t,{AppHistoryProvider:function(){return o},useAppHistory:function(){return c}});var a=r(91104),s=r(26816),l=r(36623),n=r(63137);let i=(0,n.createContext)({}),o=e=>{let{children:t}=e,r=(0,s.usePathname)(),o=(0,s.useRouter)(),[c,u]=(0,n.useState)([]),d=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/home",t=arguments.length>1?arguments[1]:void 0;console.log("goBack",{defaultRoute:e,ignoreRouteBase:t});let r=e;c.length>1&&(r=c[c.length-2],void 0!==t&&r.includes(t)&&(r=e)),"string"!=typeof r&&(r="/home"),o.push(r,{scroll:!1})},[c,o]);return(0,n.useEffect)(()=>{u(e=>e[e.length-1]!==r?[...e,r]:e)},[r]),(0,a.jsxs)(i.Provider,{value:{goBack:d},children:[t,(0,a.jsx)(l.wT,{dense:!0,maxSnack:3})]})},c=()=>(0,n.useContext)(i)},60402:function(e,t,r){"use strict";r.r(t),r.d(t,{FeedProvider:function(){return n},useFeed:function(){return i}});var a=r(91104),s=r(63137);let l=(0,s.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,s.useState)([]),[i,o]=(0,s.useState)(!1),[c,u]=(0,s.useState)({}),[d,m]=(0,s.useState)(""),[f,x]=(0,s.useState)([]),[h,p]=(0,s.useState)(!1),[v,g]=(0,s.useState)(""),[b,w]=(0,s.useState)([]),[y,_]=(0,s.useState)(!1),[j,k]=(0,s.useState)([]),[N,P]=(0,s.useState)(!1),[S,C]=(0,s.useState)([]),[D,M]=(0,s.useState)(!1),z=(0,s.useCallback)(e=>r.find(t=>(t.post_type,t.post.id===e))||b.find(t=>t.id===e)||S.find(t=>t.id===e)||j.find(t=>t.id===e),[r,b,S,j]),T=(0,s.useCallback)((e,t,a,s)=>{let l=r.findIndex(e=>e.post.id===t),i=b.findIndex(e=>e.id===t),o=j.findIndex(e=>e.id===t),c=S.findIndex(e=>e.id===t);if(-1===l&&-1===i&&-1===o&&-1===c)return;let u=(t,r)=>{let l={...r[t]},n={react:s,by:e,id:":irrelevant:"+Math.random(),avatar:":irrelevant:"+Math.random(),handle:":irrelevant:"+Math.random(),name:":irrelevant:"+Math.random()};return"add"===a?"upvote"===s?(l.votes.up.push(n),l.votes.down=l.votes.down.filter(t=>t.by!==e)):(l.votes.down.push(n),l.votes.up=l.votes.up.filter(t=>t.by!==e)):"upvote"===s?l.votes.up=l.votes.up.filter(t=>t.by!==e):l.votes.down=l.votes.down.filter(t=>t.by!==e),[...r.slice(0,t),l,...r.slice(t+1)]};-1!==l&&n(e=>u(l,e)),-1!==i&&w(e=>u(i,e)),-1!==o&&k(e=>u(o,e)),-1!==c&&C(e=>u(c,e))},[r,b,S,j]),E=(0,s.useCallback)((e,t)=>{n(r=>0===r.length?r:[...e.map(e=>({id:Math.random().toString(36).substring(2,15),post_type:"meme",by:t.twitter_profile.id,by_badge_image_url:t.user.badge_image_url,by_avatar:t.twitter_profile.profile_image_url_https,by_handle:t.twitter_profile.screen_name,by_name:t.twitter_profile.name,post:{...e,is_creator:!0,creator_name:e.creator_name,creator_handle:e.creator_handle,creator_avatar:e.creator_avatar},votes:{up:[],down:[]},created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()})),...r])},[]),F=(0,s.useCallback)((e,t)=>{n(r=>0===r.length?r:r.map(r=>{if("meme"in r&&r.post.id===e){let e=r.post;return{...r,post:{...e,...t}}}return r}))},[]),A=(0,s.useCallback)((e,t)=>{n(r=>0===r.length?r:[{id:Math.random().toString(36).substring(2,15),post_type:"deck",by:t.twitter_profile.id,by_badge_image_url:t.user.badge_image_url,by_avatar:t.twitter_profile.profile_image_url_https,by_handle:t.twitter_profile.screen_name,by_name:t.twitter_profile.name,post:{...e,memes:Object.values(e.memes).map(e=>({...e,is_public:!0})),is_creator:!0,creator_name:e.creator_name,creator_handle:e.creator_handle,creator_avatar:e.creator_avatar},votes:{up:[],down:[]},created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()},...r])},[]),B=(0,s.useCallback)(e=>{n(t=>t.filter(t=>t.post.id!==e))},[]),O=(0,s.useCallback)(e=>{b.length>0&&w(t=>[e,...t]),j.length>0&&k(t=>[e,...t])},[b.length,j.length]);return(0,a.jsx)(l.Provider,{value:{feed:r,setFeed:n,hasFetchedFeed:i,setHasFetchedFeed:o,feedActions:c,setFeedActions:u,appendMemesToFeed:E,appendDeckToFeed:A,removeItemFromFeed:B,updateMemeInFeed:F,searchQuery:d,setSearchQuery:m,searchResults:f,setSearchResults:x,hasFetchedSearchResults:h,setHasFetchedSearchResults:p,librarySearchQuery:v,setLibrarySearchQuery:g,library:b,setLibrary:w,hasFetchedLibrary:y,setHasFetchedLibrary:_,uploads:j,setUploads:k,hasFetchedUploads:N,setHasFetchedUploads:P,saved:S,setSaved:C,hasFetchedSaved:D,setHasFetchedSaved:M,onUploadMeme:O,getItem:z,voteOnItem:T},children:t})},i=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useFeed must be used within a FeedProvider");return e}},71668:function(e,t,r){"use strict";r.r(t),r.d(t,{UploadProvider:function(){return v},useUpload:function(){return g}});var a=r(91104),s=r(36623),l=r(63137);let n=e=>{let t=new FileReader;return new Promise((r,a)=>{t.onload=e=>{var t;let s=null===(t=e.target)||void 0===t?void 0:t.result;if(!s){a(Error("Failed to read file"));return}r(new Uint8Array(s))},t.onerror=()=>a(t.error),t.readAsArrayBuffer(e)})};var i=r(57826);let o=e=>{let{text:t,textButton:r,onClick:s}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[t,r&&s&&(0,a.jsx)(i.A,{variant:"solid",color:"success",size:"sm",className:"text-white-400",onClick:s,children:r})]})};var c=r(29125),u=r(41116),d=r(26816),m=r(60402),f=r(33968),x=r(4180),h=r(98127);let p=(0,l.createContext)({}),v=e=>{let{children:t}=e,r=(0,d.useRouter)(),{openMemeModal:i}=(0,h.T)(),{isPostingMemes:v,setIsHovering:g}=(0,u.useProfile)(),{onUploadMeme:b}=(0,m.useFeed)(),[w,y]=(0,l.useState)([]),[_,j]=(0,l.useState)(),[k,N]=(0,l.useState)(!1),P=(0,l.useCallback)(async(e,t)=>{try{(0,s.sy)();let r=e.name.slice(0,20),l=(0,s.yv)("Uploading ".concat(r),{variant:"info",persist:!0});j(l);let c=await n(e),u="";if(void 0!==t){let r=await f.P.postDeckSubmission({deckId:t,filename:(0,x.Df)(e.name),filetype:e.type,bytes:c});if(!r)throw Error("Failed to upload");u=r.meme_id}else{let t=await f.P.postMeme({filename:(0,x.Df)(e.name),filetype:e.type,bytes:c});if(!t)throw Error("Failed to upload");u=t.id;let r={...t,votes:{up:[],down:[]}};y(e=>[r,...e]),b(r)}(0,s.sy)(_),j(void 0);let d=(0,s.yv)((0,a.jsx)(o,{text:"Successfully uploaded",textButton:"View",onClick:()=>{(0,s.sy)(d),i(u)}}),{variant:"success",autoHideDuration:3e3})}catch(e){console.error(e),j(void 0),(0,s.sy)(),(0,s.yv)("Failed to upload some memes",{variant:"error"})}},[_,i,b,y]),S=(0,l.useCallback)(async e=>{try{let t=(0,x.Df)(e),r=t.slice(0,20),l=(0,s.yv)("Uploading ".concat(r),{variant:"info",persist:!0});j(l);let n=await f.P.postMeme({filename:t,filetype:"image",source_url:e});if(!n)throw Error("Failed to paste link");y(e=>[n,...e]),b(n),(0,s.sy)(_),j(void 0);let c=(0,s.yv)((0,a.jsx)(o,{text:"Successfully pasted link",textButton:"View",onClick:()=>{(0,s.sy)(c),i(n.id)}}),{variant:"success",autoHideDuration:3e3})}catch(e){console.error(e),(0,s.yv)("Failed to paste link",{variant:"error"})}},[_,i,b]),C=(0,l.useMemo)(()=>(0,c.k)(P,1e3),[P]),D=(0,l.useCallback)(async(e,t)=>{if(void 0===_){if(e.size>33554432){(0,s.yv)("Please upload files 32MB or less",{variant:"error"});return}return C(e,t)}},[C,_]),M=(0,l.useCallback)(async e=>{if(e.clipboardData){let t=e.clipboardData.items;for(let e=0;e<t.length;e++){let r=t[e];if(r.type.includes("image")){let e=r.getAsFile();e&&await D(e)}}}},[D]);(0,l.useEffect)(()=>(window.addEventListener("paste",M),()=>{window.removeEventListener("paste",M)}),[M]);let z=async e=>{if(!(e.dataTransfer.items.length>0)||!e.dataTransfer.items[0].type.includes("image"))return!1;e.preventDefault(),g(!1),N(!0);let t=e.dataTransfer.files;try{for(let e=0;e<t.length;e++){let r=t[e];r.type.includes("image")&&await D(r)}v||r.push("/library")}catch(e){console.error(e)}finally{N(!1)}};return(0,a.jsx)(p.Provider,{value:{uploads:w,setUploads:y,startUpload:D,pasteImageLink:S,isBatchUploading:k},children:(0,a.jsx)("div",{className:"flex min-h-0 w-full min-w-0 flex-1",onDragOver:e=>{e.preventDefault(),e.dataTransfer.items.length>0&&e.dataTransfer.items[0].type.includes("image")&&g(!0)},onDragLeave:()=>g(!1),onDrop:z,children:t})})},g=()=>(0,l.useContext)(p)},29125:function(e,t,r){"use strict";r.d(t,{D:function(){return a},k:function(){return s}});let a=(e,t)=>{let r=null;return function(){for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];r&&clearTimeout(r),r=setTimeout(()=>{r&&clearTimeout(r);let t=e(...s);return r=null,t},t)}},s=(e,t)=>{let r=null;return function(){for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];return new Promise((a,l)=>{let n=async()=>{r&&clearTimeout(r);try{let t=await e(...s);a(t)}catch(e){l(e)}r=null};r&&clearTimeout(r),r=setTimeout(n,t)})}}},17412:function(e,t,r){"use strict";function a(e,t){return t.toString().length?"".concat(e,"?").concat(t.toString()):e}r.d(t,{wS:function(){return a}})}},function(e){e.O(0,[826,349,223,653,857,743,915,514,171,744],function(){return e(e.s=50197)}),_N_E=e.O()}]);