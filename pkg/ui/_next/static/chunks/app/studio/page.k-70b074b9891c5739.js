(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9650],{43939:function(e,t,a){Promise.resolve().then(a.bind(a,82e3))},82e3:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return e9}});var l,i,s=a(57348),r=a(16189),n=a(98086),o=a(12465),c=a(15346),d=a(46371),u=a(37351),m=a(35971),p=a(55771),x=a(35878),h=a(69467),f=a(66353),g=a(55147),v=a(39543),w=a(99349),b=a(81727),j=a(73492),y=a(71046);(l=i||(i={})).WAITING="waiting",l.STARTED="started",l.COMPLETED="completed";let N=(0,c.createContext)({}),_=e=>{let{profile:t,socket:a,config:l,queryParams:r,children:n}=e,{appendMemesToFeed:_,removeItemFromFeed:k}=(0,m.useFeed)(),[C,z]=(0,c.useState)(null),[S,A]=(0,c.useState)(null),[O,D]=(0,c.useState)(null),[P,I]=(0,c.useState)(0),[F,W]=(0,c.useState)(i.WAITING),[E,R]=(0,c.useState)("generated"),[T,M]=(0,c.useState)(h.WV.One),[V,L]=(0,c.useReducer)(y.nv,y.ZA),[H,J]=(0,c.useState)([]),[G,U]=(0,c.useState)([]),[B,q]=(0,c.useState)(!1),[Z,Y]=(0,c.useState)(!1),[K,Q]=(0,c.useState)(!1),[X,$]=(0,c.useState)(!1),[ee,et]=(0,c.useState)(!1),[ea,el]=(0,c.useState)(!1),[ei,es]=(0,c.useState)(!1),er=(0,c.useMemo)(()=>V.find(e=>0===e.idx),[V]),en=(0,c.useMemo)(()=>{var e;let t=null!==(e=null==er?void 0:er.image.selectedAspectRatio)&&void 0!==e?e:f.tB.Square;return(0,v.rf)(T,t)},[null==er?void 0:er.image.selectedAspectRatio,T]),eo=(0,c.useMemo)(()=>(0,v.vO)(en.paneWidth,en.paneHeight),[en.paneHeight,en.paneWidth]),ec=(0,c.useMemo)(()=>(0,v.GJ)(T,en),[T,en]),ed=(0,c.useMemo)(()=>ec.canvasWidth/ec.canvasHeight,[ec]),eu=(0,c.useMemo)(()=>V.slice(0,u.i4[T]).some(e=>"text"===e.type?""===e.text.text:"generated"!==e.type&&"faceswap"!==e.type||""===e.image.src||e.image.isGenerating),[V,T]),em=(0,c.useMemo)(()=>V.some(e=>e.image.isGenerating),[V]),ep=(0,c.useMemo)(()=>V.find(e=>e.idx===P),[V,P]),ex=(0,c.useMemo)(()=>!ep||"0"===ep.id,[ep]),eh=(0,c.useCallback)(e=>{let t=null!=e?e:(0,b.uZ)();z(t);let a=new URL(window.location.href);return a.searchParams.set("meme",t.replace("meme:","")),window.history.replaceState({},"",a.toString()),t},[]),ef=(0,c.useCallback)(async(e,t,a)=>{let l=Object.entries(null!=a?a:{}).slice(0,u.i4[t]),i=a?Object.fromEntries(l):void 0,s=await x.P.createComposedMeme({meme_id:e,panel_layout:t,panel_config_init:i});if(!s)throw Error("Failed to create composed meme");return s},[]),eg=(0,c.useCallback)(e=>{let t={};return"generated"===e.type?t={meme:e.image.id}:"text"===e.type?t={text:e.text.text}:"faceswap"===e.type&&(t={swapped_image:e.faceswap.swappedImage,face_image:e.faceswap.faceImage,base_image:e.faceswap.baseImage,base_width:e.faceswap.baseWidth,base_height:e.faceswap.baseHeight,strength:e.faceswap.strength}),t},[]),ev=(0,c.useCallback)(()=>{L({action:"reset",idx:P})},[P]),ew=(0,c.useCallback)(async()=>{var e,t;L({action:"update-panel",idx:P,image:{isRandomizing:!0}});let a=await p.p.getRandomPrompt();L({action:"update-panel",idx:P,image:{posPrompt:a.user_positive_prompt,negPrompt:a.user_negative_prompt,seed:(0,w.q)(),seedType:"random",topText:"",bottomText:"",guidanceScale:a.cfg_scale,selectedAspectRatio:a.aspect_ratio,selectedCharacter:null!==(e=l.characters.find(e=>e.id===a.character.replace("ai_character:","")))&&void 0!==e?e:l.characters[0],selectedStyler:null!==(t=l.stylers.find(e=>e.id===a.styler.replace("ai_image_style:","")))&&void 0!==t?t:l.stylers[0],isRandomizing:!1}})},[l.characters,l.stylers,P]),eb=(0,c.useCallback)(async(e,t,a)=>{if(L({action:"update-panel",idx:e,text:{text:a}}),!C)throw Error("Failed to find composed meme id");let l=await (0,j.v2)(C,t,{panel_type:"text",panel_config:{text:a}});J(e=>{let t=e.findIndex(e=>e.id===C);if(-1===t)return e;let a={...e[t].panels,[P]:l},i={...e[t],panels:a};return[...e.slice(0,t),i,...e.slice(t+1)]})},[C,P]),ej=(0,c.useCallback)((e,t,a)=>{var l,i;if(L({action:"update-panel",idx:e,image:{[t]:a}}),!C)throw Error("Failed to find composed meme id");let s=V.find(t=>t.idx===e);if(!s)throw Error("Failed to find active panel");let r="topText"===t,n={top_text:a,bottom_text:null!==(l=s.image.bottomText)&&void 0!==l?l:""},o={top_text:null!==(i=s.image.topText)&&void 0!==i?i:"",bottom_text:a},c={top_text_size:"md",bottom_text_size:"md",additional_config:null,...r?n:o};(0,j.r_)(s.image.id,c)},[C,V]),ey=(0,c.useCallback)(async e=>{eh(e.id),e.posts&&e.posts.length>0?D(e.posts[0]):D(null),M(e.panel_layout);let t=e.panels,a=[],i=(a=t&&Object.keys(t).length>0?(0,j.xe)(t,l):y.ZA)[0];I(0),"text"===i.type?R("text"):i.faceswap.baseImage||i.faceswap.faceImage?R("faceswap"):R("generated"),L({action:"blank-slate"}),a.map(e=>{let t=e.image,a=e.text,l=e.faceswap;L({idx:e.idx,id:e.id,action:"update-panel",type:e.type,image:t,text:a,faceswap:l})}),el(!1)},[l,eh]),eN=(0,c.useCallback)(e=>{if(!C)throw Error("Failed to find composed meme id");let t=(0,v.vO)(e.width,e.height);e.panel_layout===h.WV.One&&(V[P].image.selectedAspectRatio=f.tB.Portrait,t=(0,v.vO)(V[P].image.width,V[P].image.height)),L({action:"update-panel",idx:P,type:"generated",image:{...e.prompt,width:e.width,height:e.height,id:e.id,src:e.url,prevSrc:e.url,selectedAspectRatio:t}}),J(a=>{var l;let i=a.findIndex(e=>e.id===C);if(-1===i)return a;let s=P.toString(),r=a[i],n={...r,panels:{...r.panels,[s]:{...null===(l=r.panels)||void 0===l?void 0:l[s],id:e.id,idx:P,panel_type:"generated",panel_config:{meme:{...e,prompt:{aspect_ratio:t}},prompt:{...e.prompt,aspect_ratio:t},text_overlay:e.text_overlay},created_at:1e6*Date.now()}}};return[...a.slice(0,i),n,...a.slice(i+1)]});let a=V[P].id;(0,j.v2)(C,a,{panel_type:"generated",panel_config:{meme:e.id}})},[P,C,V]),e_=(0,c.useCallback)(e=>{if(e===P)return;I(e);let t=V.find(t=>t.idx===e);if(!t)throw Error("Failed to find active panel");"generated"===t.type&&t.image.src&&!t.image.posPrompt?R("library"):R(t.type)},[P,V]),ek=(0,c.useCallback)(e=>{R(e),L({action:"update-panel",idx:P,type:(0,f.JY)(e)})},[P]),eC=(0,c.useCallback)(async e=>{D(null),I(0),et(!0);let a=eh(),i=e.panel_layout,s=e.panels;try{if(s&&i){let e=(0,j.xe)(s,l);await ef(a,i,{...Object.fromEntries(Object.entries(e).map(e=>{let[t,a]=e;return[t,{panel_type:a.type,panel_config:eg(a)}]}))})}else console.log("No panels found in meme, creating a new one"),await (0,d.P)(a,e),s=(await x.P.getMeme(a)).panels,i=h.WV.One}catch(e){throw(0,o.yv)("Failed to remix meme",{variant:"error"}),Error("Failed to init panels server side")}finally{et(!1)}let r={id:a,source:"composed",panel_layout:i,panels:s=Object.fromEntries(Object.entries(null!=s?s:{}).map(e=>{let[t,a]=e,l=a.panel_type,i=a.panel_config;if("generated"===l&&i.prompt){let e={...a,panel_config:{...i,prompt:{...i.prompt,seed_type:"fixed"}}};return console.log("newPanel",e),[t,e]}return[t,a]})),by:t.user.id};J(e=>[r,...e]),ey(r);let n=new URL(window.location.href);n.searchParams.delete("remix"),window.history.replaceState({},"",n.toString())},[l,eh,ef,ey,eg,t.user.id]),ez=(0,c.useCallback)(async e=>{if(e===T)return;M(e),I(0);let t={};if(e===h.WV.TwoVertical)t={selectedAspectRatio:f.tB.Portrait};else if(e===h.WV.TwoHorizontal)t={selectedAspectRatio:f.tB.Portrait};else if(e===h.WV.Four)t={selectedAspectRatio:f.tB.Square};else{let e=null==ep?void 0:ep.image.selectedAspectRatio;t={selectedAspectRatio:null!=e?e:f.tB.Square}}if(L({action:"update-panel",idx:P,image:t}),J(t=>{let a=t.findIndex(e=>e.id===C);if(-1===a)return t;let l={...t[a],panel_layout:e};return[...t.slice(0,a),l,...t.slice(a+1)]}),!C)throw Error("Failed to find composed meme id");x.P.updateComposedMemeLayout(C,{panel_layout:e})},[ep,P,C,T]),eS=(0,c.useCallback)(async e=>{et(!0);let a=eh(),l=await ef(a,T,{});e&&"string"==typeof e&&(l={...l,0:{...l[0],panel_config:{...l[0].panel_config,prompt:{...l[0].panel_config.prompt,character:e}}}}),L({action:"blank-slate"}),Object.values(l).map(e=>{L({action:"update-panel",idx:e.idx,id:e.id})}),J(e=>{let i={id:a,source:"composed",panel_layout:T,panels:l,by:t.user.id};return ey(i),[i,...e]}),el(!1),et(!1)},[ef,ey,t.user.id,T,eh]),eA=(0,c.useCallback)(async e=>{let t=l.characters.find(t=>t.id===e);if(t)console.log("Found character",t);else throw Error("Failed to find character");L({action:"update-panel",idx:0,image:{selectedCharacter:t}}),await eS(e);let a=new URL(window.location.href);a.searchParams.delete("character"),window.history.replaceState({},"",a.toString())},[l.characters,eS]),eO=(0,c.useCallback)(async e=>{let t=e.filter(e=>e.is_creator);J(t);let{remixMemeId:a,memeId:l,characterId:i}=r,s=()=>{t[0]?ey(t[0]):eS()};try{let e;let i=null!=a?a:l;if(i&&(e=t.find(e=>e.id.replace("meme:","")===i)||await x.P.getMeme(i)),!e)throw Error("Failed to find matching meme for query param");a?eC(e):l?ey(e):s()}catch(e){console.error(e),s()}i&&eA(i)},[r,ey,eS,eC,eA]),eD=(0,c.useCallback)(async()=>{if(C)try{Y(!0),await x.P.deleteMeme(C);let e=async()=>{let e=await x.P.getLibrary({source:["composed"],start:0,limit:1});e?eO(e):await eS()};J(t=>{let a=t.findIndex(e=>e.id===C);if(-1===a)return t;t[a+1]?ey(t[a+1]):t[a-1]?ey(t[a-1]):(L({action:"blank-slate"}),z(null),A(null),D(null),M(h.WV.One),R("generated"));let l=[...t.slice(0,a),...t.slice(a+1)];return 0===l.length&&e(),l});let t=new URL(window.location.href);t.searchParams.delete("meme"),window.history.replaceState({},"",t.toString())}catch(e){(0,o.yv)("Failed to delete meme",{variant:"error"})}finally{Y(!1)}},[C,ey,eS,eO]),eP=(0,c.useCallback)(async()=>{if(O)try{Q(!0),await x.P.deletePost(O),D(null),J(e=>{let t=e.findIndex(e=>e.id===C);return -1===t?e:[...e.slice(0,t),{...e[t],posts:[]},...e.slice(t+1)]}),k(O)}catch(e){(0,o.yv)("Failed to delete post",{variant:"error"})}finally{Q(!1)}},[C,O,k]),eI=(0,c.useCallback)(async(e,a)=>{let l=a.slice(0,u.i4[e]);try{$(!0),L({action:"blank-slate"}),Object.values(l).map(e=>{L({action:"update-panel",...e})});let a=eh();await ef(a,e,{...Object.fromEntries(Object.entries(l).map(e=>{let[t,a]=e;return[t,{panel_type:a.type,panel_config:eg(a)}]}))}),J(l=>[{id:a,source:"composed",panel_layout:e,panels:(0,j.eZ)(V),prompt:{aspect_ratio:u.aN[e]},by:t.user.id},...l]),D(null)}catch(e){(0,o.yv)("Failed to duplicate post",{variant:"error"})}finally{$(!1)}},[ef,eg,V,t.user.id,eh]),eF=(0,c.useCallback)((e,t,l,i)=>{var s;let r=V[e],n={panel_id:r.id,faceswap_strength:r.faceswap.strength,face_image:t,base_image:l,base_width:i.width,base_height:i.height},o=C;o||(console.warn("No composed meme_id in memory, generating a new one"),o=eh());let c={kind:"generate_faceswap",meme_id:o,panel_index:e,panel_layout:T,data:n};console.log("Generating faceswap",c),L({idx:e,action:"update-panel",type:"faceswap",image:{isGenerating:!0,src:void 0,prevSrc:null===(s=V[e])||void 0===s?void 0:s.image.src,seed:0},text:{text:""}}),a.send(JSON.stringify(c))},[C,eh,V,T,a]),eW=(0,c.useCallback)((e,l)=>{var s;let r=l.image,n="fixed"===r.seedType?r.seed:(0,w.q)(),o={workflow:"combined",quality:"fast",do_prompt_expansion:r.isExpandedPrompt,user_id:t.user.id,positive_prompt:r.posPrompt,negative_prompt:r.negPrompt,seed:n,top_text:r.topText,bottom_text:r.bottomText,aspect_ratio:T!==h.WV.One?u.aN[T]:r.selectedAspectRatio,character:r.selectedCharacter.id?{id:r.selectedCharacter.id,strength_model:1}:null,styler:{id:"photorealistic",strength_model:1},aesthetic:(null===(s=r.selectedAesthetic)||void 0===s?void 0:s.id)?r.selectedAesthetic.id:null,cfg_scale:r.guidanceScale};L({idx:e,action:"update-panel",type:"generated",image:{isGenerating:!0,src:void 0,prevSrc:r.src,seed:n,width:en.paneWidth,height:en.paneHeight},text:{text:""},faceswap:{faceImage:void 0,baseImage:void 0,strength:1}}),W(i.WAITING);let c=C;c||(console.warn("No composed meme_id in memory, generating a new one"),c=eh());let d={kind:"generate_image",meme_id:c,data:o};console.log("sending payload",d=T!==h.WV.One?{...d,panel_index:e,panel_layout:T}:{...d,panel_index:0,panel_layout:h.WV.One}),a.send(JSON.stringify(d))},[C,eh,t.user.id,T,en.paneHeight,en.paneWidth,a]),eE=(0,c.useCallback)(async()=>{if(!C)throw Error("Failed to post composed meme");try{q(!0);let e=await (0,g.jt)(V,T,(0,v.vO)(en.paneWidth,en.paneHeight)),{canvasWidth:a,canvasHeight:l}=(0,v.GJ)(T,en),i={filetype:"image/jpeg",bytes:Array.from(new Uint8Array(e)),width:a,height:l},s=await x.P.composedUpload(C,i).catch(e=>(console.error("Failed to compile composed meme",e),null));if(!s)throw Error("Failed to post composed meme");A(s.url);let r=await x.P.createPost({post_type:{meme:C}}).catch(e=>{throw console.error("Failed to post composed meme",e),e});if(!r)throw Error("Failed to post composed meme");let n={id:C,url:s.url,posts:[r.id],width:i.width,height:i.height};D(r.id),_([n],t),es(!0)}catch(e){console.error("Failed to compile composed meme",e)}finally{q(!1)}},[_,C,V,t,T,en]);return(0,c.useEffect)(()=>{a.onmessage=e=>{let a=V.find(e=>e.image.isGenerating);if(!a){console.error("Failed to find generating panel");return}if("started"===(e=JSON.parse(e.data)).status&&W(i.STARTED),"faceswap_generated"===e.type){console.log("Faceswap generated",e);let t=e.data,l=new Uint8Array(t),i=new Blob([l],{type:"image/jpeg"}),s=new FileReader;s.onloadend=()=>{let t=s.result;L({idx:a.idx,action:"update-panel",type:"faceswap",image:{src:t,progress:100,isGenerating:!1,width:e.dimensions[0],height:e.dimensions[1],selectedAspectRatio:(0,v.vO)(e.dimensions[0],e.dimensions[1])},faceswap:{swappedImage:t,baseWidth:e.dimensions[0],baseHeight:e.dimensions[1]}});let l={id:e.id,url:t,width:e.dimensions[0],height:e.dimensions[1],created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()};J(e=>{let i=e.findIndex(e=>e.id===C);if(-1===i)return e;let s=e[i].panels,r={id:a.id,idx:a.idx,panel_type:"generated",panel_config:{meme:l,base_image:a.faceswap.baseImage,face_image:a.faceswap.faceImage,base_width:a.faceswap.baseWidth,base_height:a.faceswap.baseHeight,swapped_image:t},created_at:1e6*Date.now()},n={...s,[a.idx]:r},o={...e[i],panels:n};return[...e.slice(0,i),o,...e.slice(i+1)]})},s.readAsDataURL(i)}else if("image_generating"===e.type||"image_generating"===e.kind){let t=e.data,l=new Uint8Array(t),i=new Blob([l],{type:"image/jpeg"}),s=new FileReader;s.onloadend=()=>{let t=s.result;L({idx:a.idx,action:"update-panel",image:{src:t,progress:e.progress}})},s.readAsDataURL(i)}else if("image_generated"===e.kind||"meme_created"===e.type){let l=e.data,i=new Uint8Array(l),s=new Blob([i],{type:"image/jpeg"}),r=new FileReader;r.onloadend=()=>{var l,i;let s=e.id,n=e.prompt_config,o=r.result;if(!a)throw Error("Failed to find active panel");let c={top_text:null!==(l=a.image.topText)&&void 0!==l?l:"",bottom_text:null!==(i=a.image.bottomText)&&void 0!==i?i:"",top_text_size:"md",bottom_text_size:"md",additional_config:null},d={id:s,url:o,prompt:{...n,seed:"random"===a.image.seedType?(0,w.q)():n.seed,styler:n.styler.id,character:n.character.id,user_positive_prompt:n.positive_prompt,user_negative_prompt:n.negative_prompt},text_overlay:{...c,created_at:1e6*Date.now(),updated_at:1e6*Date.now()},created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()};if(L({idx:a.idx,action:"update-panel",type:"generated",image:{id:s,src:o,prevSrc:o,progress:100,isGenerating:!1}}),!C)throw Error("Failed to find composed meme id");J(e=>{let l=e.findIndex(e=>e.id===C);if(-1===l)return e;let i=e[l].panels,s={id:a.id,idx:a.idx,panel_type:"generated",panel_config:{meme:d,prompt:d.prompt,text_overlay:{...c,by:t.user.id,created_at:1e6*Date.now(),updated_at:1e6*Date.now()}},created_at:1e6*Date.now()},r={...i,[a.idx]:s},n={...e[l],panels:r};return[...e.slice(0,l),n,...e.slice(l+1)]})},r.readAsDataURL(s)}else"same_prompt"===e.kind&&L({idx:a.idx,action:"update-panel",image:{progress:100,src:a.image.prevSrc,isGenerating:!1}})}},[C,V,t.user.id,a]),(0,c.useEffect)(()=>{let e=localStorage.getItem("isExpandedPrompt");e&&L({action:"update-panel",idx:P,image:{isExpandedPrompt:JSON.parse(e)}})},[P,ey]),(0,s.jsx)(N.Provider,{value:{activePanelIdx:P,activeJobStatus:F,selectedTab:E,selectedLayout:T,activePanel:ep,panels:V,history:H,library:G,postId:O,composedMemeId:C,composedMemeUrl:S,isMounting:ex,isPostDisabled:eu,isPosting:B,isUnpublishing:K,isDeleting:Z,isDuplicating:X,isCreatingProject:ee,isPostModalOpen:ei,isSidebarMenuOpen:ea,isGenerateDisabled:em,canvasDimensions:ec,canvasAspectRatio:ed,paneDimensions:en,paneAspectRatio:eo,setActiveJobStatus:W,setLibrary:U,setHistory:J,toggleIsSidebarMenuOpen:()=>el(e=>!e),onClickResetPromptSettings:ev,onClickRandomPrompt:ew,onChangeTextPanel:eb,onChangeTextOverlay:ej,onClosePostModal:()=>es(!1),onClickHistory:ey,onClickLibrary:eN,onClickPane:e_,onClickTab:ek,onFetchHistory:eO,onSelectStudioLayout:ez,onClickNewProject:eS,onClickDelete:eD,onClickUnpublish:eP,onClickDuplicatePost:eI,onClickGenerate:eW,onClickFaceswap:eF,onClickPost:eE,dispatchPanelAction:L},children:n})},k=()=>{let e=(0,c.useContext)(N);if(void 0===e)throw Error("useFeed must be used within StudioProvider");return e};var C=a(53350),z=a(98224),S=a(67425),A=a(19783);let O=e=>{let{label:t,imageRef:a,isBaseImage:l=!1,initialSrc:i,setImage:r}=e,{composedMemeId:n,activePanelIdx:o,activePanel:d,dispatchPanelAction:u}=k(),m=async(e,t,a,i)=>{var s;if(!n||!d)return;let c=await x.P.faceswapUpload(n,d.id,{bytes:Array.from(e),filetype:"image/jpeg",is_face:!l}),m=null==c?void 0:c.panel_config;if(!m)return;let p=l?m.base_image:m.face_image;p&&r(p),u({idx:o,action:"update-panel",type:"faceswap",image:{src:void 0,selectedAspectRatio:l?i:d.image.selectedAspectRatio,width:l?t:m.base_width,height:l?a:m.base_height},faceswap:{faceImage:m.face_image,baseImage:m.base_image,strength:null!==(s=m.strength)&&void 0!==s?s:1,baseWidth:l?t:m.base_width,baseHeight:l?a:m.base_height}})},p=(0,c.useCallback)(async()=>{n&&d&&(await x.P.faceswapDelete(n,d.id,{is_face:!l}),r(void 0))},[d,n,l,r]);return(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("p",{className:"text-white-400 font-medium text-small",children:t}),(0,s.jsx)(A.U,{imageRef:a,initialSrc:i,onParseImage:m,onClickDeleteMeme:p})]})},D=()=>{var e,t;let{activePanel:a,activePanelIdx:l,onClickFaceswap:i,dispatchPanelAction:r}=k(),n=(0,c.useRef)(null),o=(0,c.useCallback)(e=>{r({idx:l,action:"update-panel",faceswap:{strength:e}})},[l,r]),d=(0,c.useCallback)(e=>{r({idx:l,action:"update-panel",faceswap:{faceImage:e}})},[l,r]),u=(0,c.useCallback)(e=>{r({idx:l,action:"update-panel",faceswap:{baseImage:e}})},[l,r]),m=null==a?void 0:null===(e=a.faceswap)||void 0===e?void 0:e.baseImage,p=null==a?void 0:null===(t=a.faceswap)||void 0===t?void 0:t.faceImage;return(0,s.jsxs)("div",{className:"flex size-full flex-col gap-3 justify-between",children:[(0,s.jsxs)("section",{className:" w-full flex-1 flex flex-col gap-4 overflow-hidden lg:overflow-y-scroll",children:[(0,s.jsx)(O,{imageRef:n,label:"Base Image",isBaseImage:!0,initialSrc:null!=m?m:null,setImage:u},"faceswap-base-image"),(0,s.jsx)(O,{label:"Face Image",initialSrc:null!=p?p:null,setImage:d},"faceswap-face-image"),(0,s.jsx)(z.L,{size:"md",step:.01,color:"warning",label:(0,s.jsx)("p",{className:"text-white-400 font-medium text-small",children:"Faceswap Strength"}),maxValue:1,minValue:0,value:null==a?void 0:a.faceswap.strength,onChange:e=>o(e),className:"w-full my-1"})]}),(0,s.jsx)("footer",{className:"w-full pb-3",children:a&&(0,s.jsx)(S.A,{fullWidth:!0,className:"text-md h-11 min-h-11",variant:"shadow",color:"primary",size:"md",isLoading:a.image.isGenerating,isDisabled:!p||!m,onClick:()=>{var e,t;if(!p||!m||!n.current)return;let l={width:null===(e=n.current)||void 0===e?void 0:e.naturalWidth,height:null===(t=n.current)||void 0===t?void 0:t.naturalHeight};i(a.idx,p,m,l)},children:(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(C.JO,{icon:"tabler:replace-filled",className:"fill-orange-400 size-5"}),(0,s.jsx)("h4",{children:"Swap Faces"})]})},"desktop-faceswap")})]},"faceswap-controls-".concat(l))};var P=a(85432),I=a(13398),F=a(26151),W=a(46766),E=a(37734);let R=()=>{let{activePanelIdx:e,activePanel:t,isGenerateDisabled:a,onChangeTextOverlay:l,onClickGenerate:i}=k();if(!t)return null;let{topText:r,bottomText:n}=t.image;return(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)(W.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Top text",placeholder:"Add top text",value:r,onValueChange:t=>{l(e,"topText",t)},maxLength:120,isClearable:!0,onKeyDown:l=>{"Enter"!==l.key||a||(l.preventDefault(),i(e,t))}},"desktop-top-text-overlay"),(0,s.jsx)(W.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Bottom text",placeholder:"Add bottom text",value:n,onValueChange:t=>{l(e,"bottomText",t)},maxLength:120,isClearable:!0,onKeyDown:l=>{"Enter"!==l.key||a||(l.preventDefault(),i(e,t))}},"desktop-bottom-text-overlay")]})},T=e=>{let{isMobile:t=!1}=e,{activePanelIdx:a,activePanel:l,isGenerateDisabled:i,onClickGenerate:r,dispatchPanelAction:n}=k();if(!l)return null;let{negPrompt:o,seed:c,seedType:d}=l.image;return(0,s.jsxs)(P.d,{variant:"shadow",className:"border-default-200 dark:border-default-100",children:[(0,s.jsx)(I.G,{classNames:{title:"text-base",content:"pt-0 pb-4 flex flex-col gap-6"},"aria-label":"Text",title:"Text",subtitle:"Add text to your image",children:(0,s.jsx)(R,{})},"1"),(0,s.jsxs)(I.G,{classNames:{title:"text-base",content:"pt-0 pb-4 flex flex-col gap-6"},"aria-label":"Advanced",title:"Advanced",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"inline-flex flex-row gap-2 justify-between",children:[(0,s.jsx)("label",{className:"text-white-400 font-medium text-small",children:"Seed"}),(0,s.jsxs)(F.g,{children:[(0,s.jsx)(S.A,{size:"sm",className:"h-5 px-0",color:"warning",variant:"fixed"===d?"solid":"bordered",onClick:()=>{n({idx:a,action:"update-panel",image:{seedType:"fixed"}})},children:"Fixed"}),(0,s.jsx)(S.A,{size:"sm",className:"h-5 px-0",color:"warning",variant:"random"===d?"solid":"bordered",onClick:()=>{n({idx:a,action:"update-panel",image:{seed:(0,w.q)(),seedType:"random"}})},children:"Random"})]})]}),(0,s.jsx)(W.Y,{fullWidth:!0,type:"number",label:null,classNames:{input:"placeholder:text-white-400/30",inputWrapper:"!bg-black-400 rounded-lg"},value:(null!=c?c:"").toString(),onValueChange:e=>{let t=parseInt(e);isNaN(t)&&(t=void 0),n({idx:a,action:"update-panel",image:{seed:t}})}})]}),!t&&(0,s.jsx)(E.Y,{className:"px-0",classNames:{input:"placeholder:text-white-400/30",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Negative prompt",labelPlacement:"outside",placeholder:'What do you want the image NOT to look like? E.g. "no cats"',value:o,onValueChange:e=>{n({idx:a,action:"update-panel",image:{negPrompt:e}})},onKeyDown:e=>{"Enter"!==e.key||i||(e.preventDefault(),r(a,l))}},"desktop-negative-prompt")]},"2")]})},M=()=>{let{activePanelIdx:e,activePanel:t,dispatchPanelAction:a}=k();if(!t)return null;let{guidanceScale:l}=t.image;return(0,s.jsxs)("div",{className:"w-full my-1 flex flex-col gap-2 px-0",children:[(0,s.jsx)(z.L,{size:"md",step:.1,color:"foreground",label:(0,s.jsxs)("div",{className:"flex flex-row gap-1.5 items-center",children:[(0,s.jsx)("p",{className:"text-white-400 font-medium text-small",children:"Guidance "}),(0,s.jsx)("p",{className:"text-default-500 font-normal text-tiny",children:"(cfg_scale)"})]}),showSteps:!0,maxValue:3,minValue:1.5,value:l,onChange:t=>{a({idx:e,action:"update-panel",image:{guidanceScale:t}})}}),(0,s.jsx)("p",{className:"text-default-500 font-normal text-small",children:"How close the AI follows the prompt, lower is more creative."})]})};var V=a(86628);let L=e=>{var t;let{isMobile:a=!1}=e,{activePanel:l,activePanelIdx:i,dispatchPanelAction:r}=k(),{selectedAesthetic:n}=null!==(t=null==l?void 0:l.image)&&void 0!==t?t:{};return(0,s.jsx)(V.d,{selectedAesthetic:n,onSelect:e=>{r({idx:i,action:"update-panel",image:{selectedAesthetic:e}})},isMobile:a})};var H=a(98832);let J=()=>{var e;let{activePanel:t,activePanelIdx:a,dispatchPanelAction:l}=k(),{selectedStyler:i,selectedCharacter:r}=null!==(e=null==t?void 0:t.image)&&void 0!==e?e:{};return(0,s.jsx)(H.z,{selectedStyler:i,selectedCharacter:r,onSelect:e=>{e&&l({idx:a,action:"update-panel",image:{selectedCharacter:e}})},showClearButton:!1})};var G=a(32162),U=a(72893),B=a(85344),q=a(87140);let Z={base:(0,G.cn)("inline-flex flex-col m-0 p-2 max-w-[100%] items-center justify-center","w-full cursor-pointer rounded-lg 3 !border-medium border-default-100","data-[selected=true]:border-warning bg-black-300 hover:border-white-400/10"),label:"inline-flex flex-col items-center",labelWrapper:"m-0 gap-1 min-w-0 max-w-full",description:"truncate text-center text-white-400/90 max-w-full",wrapper:"hidden"},Y={square:"icon-park-twotone:square-small",landscape:"icon-park-twotone:rectangle-small",portrait:"icon-park-twotone:rectangle-small"},K=()=>{let{config:e}=(0,q.useDiffusionConfig)(),{activePanel:t,activePanelIdx:a,selectedLayout:l,dispatchPanelAction:i}=k();if(!e||!t)return null;let{selectedAspectRatio:r}=t.image;return l!==h.WV.One?null:(0,s.jsx)(U.X,{classNames:{wrapper:"flex-nowrap gap-2",label:"text-white-400 font-medium text-small"},defaultValue:"square",label:"Aspect Ratio",orientation:"horizontal",value:r,onValueChange:e=>{i({idx:a,action:"update-panel",image:{selectedAspectRatio:e}})},children:Object.entries(e.quality.quality).sort((e,t)=>{let[a]=e,[l]=t;return a.localeCompare(l)}).map(e=>{let[t]=e;return(0,s.jsxs)(B.J,{classNames:Z,value:t,children:[(0,s.jsx)("div",{className:"w-full flex justify-center",children:(0,s.jsx)(C.JO,{icon:Y[t],className:"portrait"===t?"rotate-90":"",width:40})}),(0,s.jsx)("p",{className:"text-sm text-white-400/90 text-center",children:t.charAt(0).toUpperCase()+t.slice(1)})]},t)})})};var Q=a(98833);let X=()=>{let{activePanelIdx:e,activePanel:t,dispatchPanelAction:a}=k();if(!t)return null;let{isExpandedPrompt:l}=t.image;return(0,s.jsx)("div",{className:"flex flex-row gap-2 justify-start",children:(0,s.jsx)(Q.i,{size:"sm",color:"warning",classNames:{thumb:"bg-white-400",label:"text-white-400/75"},onValueChange:t=>{a({idx:e,action:"update-panel",image:{isExpandedPrompt:t}})},isSelected:l,children:"Expand details in your prompt with AI."})})},$=()=>{let{activePanel:e,activePanelIdx:t,isGenerateDisabled:a,dispatchPanelAction:l,onClickGenerate:i}=k();if(!e)return null;let{posPrompt:r}=e.image;return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(E.Y,{classNames:{input:"placeholder:text-white-400/25"},fullWidth:!0,label:"Prompt",endContent:(0,s.jsx)(S.A,{isIconOnly:!0,isDisabled:!r,style:{display:r?"flex":"none"},size:"sm",radius:"full",variant:"light",className:"absolute top-1 right-1",onClick:()=>{l({idx:t,action:"update-panel",image:{posPrompt:""}})},children:(0,s.jsx)(C.JO,{icon:"ic:baseline-clear",width:16,className:"text-white-400"})}),autoFocus:!0,isMultiline:!0,isRequired:!0,placeholder:"Describe the meme you want to generate",value:r,onValueChange:e=>{l({idx:t,action:"update-panel",image:{posPrompt:e}})},onKeyDown:l=>{"Enter"!==l.key||a||(l.preventDefault(),i(t,e))}},"desktop-prompt"),(0,s.jsx)(X,{})]})},ee=e=>{let{isMobile:t=!1}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(J,{}),(0,s.jsx)(L,{isMobile:t}),!t&&(0,s.jsx)($,{}),(0,s.jsx)(K,{}),(0,s.jsx)(M,{}),(0,s.jsx)(T,{isMobile:t})]})};var et=a(45155),ea=a(73139);let el=()=>{let{activePanelIdx:e,activePanel:t,isGenerateDisabled:a,onClickRandomPrompt:l,onClickResetPromptSettings:i,onClickGenerate:r}=k();if(!t)return null;let{isGenerating:n,isRandomizing:o}=t.image;return(0,s.jsxs)("div",{className:"flex flex-col gap-3 p-3",children:[(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(S.A,{className:"flex-1 text-md h-11",variant:"solid",size:"md",startContent:(0,s.jsx)(C.JO,{icon:"ic:baseline-refresh",width:20}),onClick:i,children:(0,s.jsx)("h1",{children:"Reset"})},"desktop-clear"),(0,s.jsx)(S.A,{className:"flex-1 text-md h-11",variant:"solid",size:"md",startContent:(0,s.jsx)(C.JO,{icon:"ion:dice-sharp",width:20}),isLoading:o,onClick:l,children:(0,s.jsx)("h1",{children:"Random"})},"desktop-lucky")]}),(0,s.jsx)(S.A,{fullWidth:!0,className:"text-md h-11",variant:"shadow",color:"primary",size:"md",isLoading:n,isDisabled:a,onClick:()=>{r(e,t)},children:(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[!n&&(0,s.jsx)(et.default,{src:ea.Z,alt:"Generate",className:"size-5"}),(0,s.jsx)("h1",{children:"Generate"})]})},"desktop-generate")]})};var ei=a(24645),es=a(8485),er=a(23136),en=a(5265),eo=a(74859);async function ec(e,t){return x.P.getLibrary({source:["generated","upload"],...e},t)}let ed=(0,eo.k)(ec,500),eu=()=>{let{activePanel:e,library:t,setLibrary:a,onClickLibrary:l}=k(),[i,r]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),{isFetching:d,hasMore:u,onReachedEnd:m,onSearch:p}=(0,en.M)({feed:t,setFeed:a,hasFetched:i,searchQuery:n,setSearchQuery:o,storeUrlParams:!1,setHasFetched:r,fetchFn:ed,fetchOnLoad:!0,pageSize:20,ignoreWindowScroll:!0}),x=(0,c.useCallback)(e=>{let{scrollLeft:t,clientWidth:a,scrollWidth:l}=e.currentTarget;t+a>=l-400&&u&&m()},[u,m]);return e?(0,s.jsxs)("div",{className:"flex size-full min-h-0 flex-col gap-3",children:[(0,s.jsx)("div",{children:(0,s.jsx)(er.T,{value:n,placeholder:"Search your library",onSearch:p})}),(0,s.jsx)("div",{className:"flex-1 w-full min-h-0 overflow-y-scroll overflow-x-hidden",onScroll:x,children:(0,s.jsx)(es.o,{memes:t,hasFetched:i,hasSearched:n.length>0,isFetching:d,className:"overflow-hidden -mr-3",breakpoints:{default:2},renderItem:(t,a)=>(0,s.jsx)(ei.Y,{meme:t,isSelected:t.id===e.image.id,onClick:()=>l(t)},"".concat(a,"-").concat(t.id))})})]}):null};var em=a(13343);let ep=()=>{let{activePanelIdx:e,selectedTab:t,onClickTab:a}=k();return(0,s.jsxs)("header",{className:"flex gap-3 p-3 items-center justify-between",children:[(0,s.jsxs)("h1",{className:"text-lg uppercase tracking-wide",children:["Panel ",e+1]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(em.E,{content:"AI Generation",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"generated"===t?"warning":"default",onClick:()=>a("generated"),children:(0,s.jsx)(C.JO,{icon:"ph:sparkle-fill",className:"fill-orange-400 size-5"})})}),(0,s.jsx)(em.E,{content:"Text",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"text"===t?"warning":"default",onClick:()=>a("text"),children:(0,s.jsx)(C.JO,{icon:"fluent:text-t-24-filled",className:"fill-orange-400 size-6"})})}),(0,s.jsx)(em.E,{content:"Your Library",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"library"===t?"warning":"default",onClick:()=>a("library"),children:(0,s.jsx)(C.JO,{icon:"fluent:emoji-meme-24-regular",className:"fill-orange-400 size-5"})})}),(0,s.jsx)(em.E,{content:"Faceswap",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"faceswap"===t?"warning":"default",onClick:()=>a("faceswap"),children:(0,s.jsx)(C.JO,{icon:"tabler:replace-filled",className:"fill-orange-400 size-5"})})})]})]})},ex=()=>{let{activePanel:e,activePanelIdx:t,onChangeTextPanel:a}=k();if(!e)return null;let{text:l}=e.text;return(0,s.jsx)("div",{children:(0,s.jsx)(W.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-500 rounded-lg"},fullWidth:!0,label:"Panel text",placeholder:"Add panel text",value:l,onValueChange:l=>{a(t,e.id,l)},maxLength:120,isClearable:!0},"desktop-panel-text")})},eh=e=>{let{isMobile:t}=e,{selectedTab:a,isMounting:l}=k();return l?null:(0,s.jsxs)("section",{className:"flex flex-1 flex-col size-full",children:[(0,s.jsx)(ep,{}),(0,s.jsx)("div",{className:"flex flex-1 flex-col w-full min-h-0 overflow-hidden",children:(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-4 px-3 overflow-y-auto",children:["generated"===a&&(0,s.jsx)(ee,{isMobile:t}),"text"===a&&(0,s.jsx)(ex,{}),"library"===a&&(0,s.jsx)(eu,{}),"faceswap"===a&&(0,s.jsx)(D,{})]})}),"generated"===a&&!t&&(0,s.jsx)(el,{})]})};var ef=a(99957),eg=a(4930),ev=a(2406),ew=a(80780),eb=a(52154);let ej=()=>{var e;let{composedMemeId:t,activePanelIdx:a}=k(),[l,i]=(0,c.useState)(null);if((0,c.useEffect)(()=>{t&&x.P.getMeme(t).then(e=>{i(e)})},[t]),!l)return(0,s.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,s.jsx)(eg.c,{})});let r=Object.values(null!==(e=l.panels)&&void 0!==e?e:{}).find(e=>e.idx===a),n=null==r?void 0:r.panel_config,o=null==n?void 0:n.prompt;return(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)("header",{className:"my-2 flex flex-col gap-5",children:(0,s.jsx)(ew.B,{handle:l.creator_handle,name:l.creator_name,avatar:l.creator_avatar,createdAt:l.created_at,publishedAt:l.published_at})}),o&&(0,s.jsx)(eb.R,{prompt:o}),(0,s.jsx)("div",{children:(0,s.jsx)(ev.I,{size:"md",memeId:l.id,initialVotes:l.votes,userId:"",readOnly:!0,addVoteApi:x.P.createMemeReaction,removeVoteApi:x.P.deleteMemeReaction})})]})},ey=()=>{let{postId:e,activePanel:t,activePanelIdx:a,isGenerateDisabled:l,dispatchPanelAction:i,onClickGenerate:r}=k();if(!t)return null;let{posPrompt:n,isGenerating:o}=t.image;return(0,s.jsx)("div",{className:(0,ef.cn)("w-full flex flex-col lg:hidden","min-h-96 max-h-96 overflow-y-scroll","border-white-400/10 border-t bg-black-400"),children:e?(0,s.jsx)("section",{className:"w-full p-4 pb-24",children:(0,s.jsx)(ej,{},e)}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{className:"w-full flex gap-3 p-4",children:[(0,s.jsx)(E.Y,{label:"Prompt",placeholder:"Describe the meme you want to generate",size:"lg",classNames:{base:"flex-1",input:"placeholder:text-white-400/25",label:"z-1"},fullWidth:!0,isRequired:!0,isMultiline:!0,value:n,onValueChange:e=>{i({idx:a,action:"update-panel",image:{posPrompt:e}})},onKeyDown:e=>{"Enter"!==e.key||l||(e.preventDefault(),r(a,t))}},"mobile-prompt"),(0,s.jsx)(S.A,{isIconOnly:!0,className:"text-md",variant:"solid",color:"primary",radius:"full",isLoading:o,isDisabled:l,onClick:()=>{r(a,t)},children:(0,s.jsx)(et.default,{src:ea.Z,alt:"Generate",className:"size-6"})},"mobile-generate")]}),(0,s.jsx)("section",{className:"w-full p-1 pb-24",children:(0,s.jsx)(eh,{isMobile:!0})})]})})};var eN=a(30640),e_=a(1718),ek=a(88036);let eC={[h.WV.One]:{label:"One Pane",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/one-pane.2f9a7f4d.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[h.WV.TwoVertical]:{label:"Two Vertical",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/two-pane-vertical.bcad13c4.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[h.WV.TwoHorizontal]:{label:"Two Horizontal",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/two-pane-horizontal.ad349fa3.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[h.WV.Four]:{label:"Four Panes",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/four-pane.09ada0ab.svg",height:30,width:30,blurWidth:0,blurHeight:0}}},ez=()=>{let{selectedLayout:e,onSelectStudioLayout:t,isCreatingProject:a,postId:l}=k();return(0,s.jsx)(e_.g,{size:"sm",value:e,isDisabled:a||!!l,selectedKeys:[e],defaultSelectedKeys:[h.WV.One],startContent:(0,s.jsx)(et.default,{src:eC[e].icon,alt:eC[e].label,width:24,height:24}),classNames:{base:"min-w-20 max-w-20 sm:max-w-48",value:"hidden sm:block"},onChange:e=>{let a=e.target.value;a&&t(a)},"aria-label":"Panel Layout",children:Object.entries(eC).map(e=>{let[t,{label:a,icon:l}]=e;return(0,s.jsx)(ek.R,{value:t,"aria-label":a,startContent:(0,s.jsx)(et.default,{src:l,alt:a,width:24,height:24}),classNames:{title:"hidden sm:block"},children:a},t)})})};var eS=a(5070),eA=a(12854),eO=a(29365),eD=a(52053),eP=a(44394),eI=a(90252);let eF=e=>{let{meme:t}=e,{config:a}=(0,q.useDiffusionConfig)(),l=(0,c.useRef)(null);return(0,c.useEffect)(()=>{(async()=>{if(!a)return;let e=l.current;if(!e)return;let i=t.panels,s=t.panel_layout;if(!i||!s)return;let r=(0,j.xe)(i,a),n=r[0];n&&await (0,g.mr)({canvas:e,studioPanels:r,studioLayout:s,paneAspectRatio:n.image.selectedAspectRatio})})()},[a,t.panel_layout,t.panels]),(0,s.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,s.jsx)("canvas",{ref:l,className:"w-full max-h-full object-contain"})})},eW=(0,c.createContext)({}),eE=e=>{let{children:t}=e,{history:a,setHistory:l,onFetchHistory:i}=k(),[r,n]=(0,c.useState)(!1),{isFetching:o,hasMore:d,onReachedEnd:u}=(0,en.M)({feed:a,setFeed:l,hasFetched:r,setHasFetched:n,fetchFn:(e,t)=>{let{start:a,limit:l}=e;return x.P.getLibrary({source:["composed"],start:a,limit:l},t)},fetchOnLoad:!0,onFetchOnLoad:i,pageSize:20,ignoreWindowScroll:!0});return(0,s.jsx)(eW.Provider,{value:{isFetching:o,hasMore:d,onReachedEnd:u},children:t})},eR=()=>{let e=(0,c.useContext)(eW);if(void 0===e)throw Error("useFeed must be used within StudioHistoryProvider");return e},eT=()=>{let{config:e}=(0,q.useDiffusionConfig)(),{composedMemeId:t,history:a,onClickHistory:l}=k(),i=a.filter(e=>!e.is_saved),{isFetching:r,hasMore:n,onReachedEnd:o}=eR(),d=(0,c.useCallback)(e=>{let{clientHeight:t,scrollHeight:a,scrollTop:l}=e;t+l>=a-400&&o()},[o]),u=(0,c.useCallback)(t=>{let{index:a}=t;if(a===i.length)return n?178:12;let l=i[a],s=null==l?void 0:l.panels,r=null==l?void 0:l.panel_layout;if(s&&r&&e){let t=(0,j.xe)(s,e).find(e=>0===e.idx);if(!t)throw Error("Failed to find first panel");let a=t.image.selectedAspectRatio,l=(0,v.rf)(r,a),{canvasWidth:i,canvasHeight:n}=(0,v.GJ)(r,l);return 269/(i/n)+12}return 178},[e,n,i]),m=(0,c.useCallback)(e=>{var a;let{rowIndex:n,key:o,style:c}=e;if(n===i.length)return r?(0,s.jsx)("div",{style:c,className:"flex w-full justify-center px-3",children:(0,s.jsx)(eg.c,{})},o):null;let d=i[n],u=d.id===t;if(!d)return null;let m=(null!==(a=d.posts)&&void 0!==a?a:[]).length>0;return(0,s.jsx)("div",{style:c,className:"w-full pb-3 cursor-pointer",onClick:()=>l(d),children:(0,s.jsxs)("div",{className:(0,ef.cn)("size-full relative bg-black-0 rounded-md border-2 overflow-hidden",u?"border-blue-500":"border-white-400/10"),children:[(0,s.jsx)(eF,{meme:d}),!m&&(0,s.jsx)(eD.z,{size:"sm",variant:"solid",radius:"sm",color:"default",className:"absolute top-1.5 right-1 font-medium shadow-2xl",children:"Draft"})]})},o)},[t,i,r,l]);return(0,s.jsxs)("div",{className:"flex-1 flex-col gap-4 flex border-r-1 border-black-100 overflow-hidden",children:[0===i.length&&(0,s.jsx)("p",{className:"mx-3 text-white-400/50 text-sm",children:"No images generated yet"}),(0,s.jsx)("div",{className:"flex-1 min-h-0",children:(0,s.jsx)(eP.ZP,{children:e=>{let{height:t}=e;return(0,s.jsx)(eI.rj,{scrollDirection:"vertical",className:"px-3 overflow-x-hidden overflow-y-auto",width:293,height:t,rowCount:i.length+1,rowHeight:u,columnCount:1,columnWidth:269,overscanColumnCount:10,onScroll:d,cellRenderer:m})}})})]})};var eM=a(71402);let eV=()=>{let e=(0,r.useRouter)(),{profile:t}=(0,eM.useProfile)(),a=(0,eA.br)(eA.mQ.Home,!1),{isSidebarMenuOpen:l,toggleIsSidebarMenuOpen:i,isCreatingProject:n,onClickNewProject:o}=k();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eO.Z,{isOpen:l,onClick:i,children:(0,s.jsx)("div",{})}),(0,s.jsx)("aside",{className:(0,ef.cn)("fixed top-0 left-0 h-full w-72 z-[100]","bg-black-300 shadow-2xl","transform transition-transform duration-200",{"translate-x-0":l,"-translate-x-full":!l}),children:(0,s.jsxs)("div",{className:"size-full flex flex-col gap-3 pb-3",children:[(0,s.jsx)("section",{className:"flex flex-col px-3",children:(0,s.jsxs)("header",{className:"h-14 min-h-14 flex items-center justify-between gap-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.A,{isIconOnly:!0,size:"sm",variant:"light",onClick:i,children:(0,s.jsx)(C.JO,{icon:"mdi:menu",className:"size-6"})}),(0,s.jsx)(eN.B,{keepStudio:!0})]}),(0,s.jsx)(S.A,{isIconOnly:!0,size:"sm",variant:"light",onClick:()=>{if(!t)return i();e.push("/u/".concat(t.user.twitter_handle))},children:t&&(0,s.jsx)(eS.h,{size:"sm",name:t.twitter_profile.screen_name,src:t.twitter_profile.profile_image_url_https})})]})}),(0,s.jsxs)("section",{className:"flex flex-col gap-3 pb-3 px-3",children:[(0,s.jsx)(S.A,{size:"md",variant:"flat",color:"warning",className:"min-w-0",isLoading:n,onClick:()=>o(),startContent:!n&&(0,s.jsx)(C.JO,{className:"size-4",icon:"akar-icons:plus"}),children:"New meme"}),(0,s.jsx)(S.A,{size:"md",variant:"flat",startContent:(0,s.jsx)(C.JO,{icon:a,className:"size-5"}),onClick:()=>{e.push("/home")},children:"Return home"})]}),(0,s.jsx)("div",{className:"border-b px-3 border-white-400/10",children:(0,s.jsx)("h3",{className:"text-sm text-white-400/50",children:"History"})}),l&&(0,s.jsx)(eT,{})]})})]})},eL=()=>{let{toggleIsSidebarMenuOpen:e}=k();return(0,s.jsx)(S.A,{isIconOnly:!0,size:"sm",variant:"light",onClick:e,children:(0,s.jsx)(C.JO,{icon:"mdi:menu",className:"size-6"})})};var eH=a(45179),eJ=a(76241),eG=a(91245),eU=a(69004),eB=a.n(eU);let eq=()=>{let{panels:e,paneAspectRatio:t,selectedLayout:a,activePanel:l,postId:i,isCreatingProject:r,isPosting:n,isPostDisabled:d,isGenerateDisabled:u,isDeleting:m,isUnpublishing:p,isDuplicating:x,onClickDuplicatePost:h,onClickDelete:f,onClickUnpublish:v,onClickPost:w}=k(),b=r||m||x||n||p||u,j=(0,c.useCallback)(async()=>{try{let i=await (0,g.jt)(e,a,t),s=new Blob([i],{type:"image/jpeg"});eB().saveAs(s,"".concat(null==l?void 0:l.image.id,".jpg"))}catch(t){console.error("Error downloading meme:",t);let e=(0,o.yv)((0,s.jsxs)("div",{className:"flex items-center gap-3",children:["Error downloading meme",(0,s.jsx)(S.A,{isIconOnly:!0,variant:"flat",color:"danger",size:"sm",className:"text-white-400",onClick:()=>{(0,o.sy)(e)},children:(0,s.jsx)(C.JO,{className:"size-5 ",icon:"mdi:close",color:"white"})})]}),{variant:"error",autoHideDuration:3e3})}},[e,a,t,null==l?void 0:l.image.id]),y=t=>{let{showLabels:l=!1}=t;return(0,s.jsxs)(s.Fragment,{children:[!i&&(0,s.jsx)(em.E,{content:"Delete meme",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsxs)(S.A,{size:"sm",variant:"flat",className:"w-full md:w-auto backdrop-blur-sm bg-red-500/20 md:justify-center justify-start",isIconOnly:!l,color:"danger",isLoading:m,isDisabled:b,onClick:f,children:[!m&&(0,s.jsx)(C.JO,{className:"size-5 !text-red-500",icon:"mdi:delete"}),l&&(0,s.jsx)("h3",{className:"text-sm",children:"Delete"})]})}),(0,s.jsx)(em.E,{content:"Duplicate meme",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsxs)(S.A,{size:"sm",variant:"flat",isIconOnly:!l,className:"w-full md:w-autobackdrop-blur-sm md:justify-center justify-start",isLoading:x,isDisabled:b,onClick:()=>h(a,e),children:[!x&&(0,s.jsx)(C.JO,{className:"size-5",icon:"ion:duplicate-outline"}),l&&(0,s.jsx)("h3",{className:"text-sm",children:"Duplicate"})]})}),(0,s.jsx)(em.E,{content:"Download",delay:500,showArrow:!0,closeDelay:200,children:(0,s.jsxs)(S.A,{size:"sm",variant:"flat",color:"default",className:"w-full md:w-autobackdrop-blur-sm md:justify-center justify-start",isDisabled:d||b,isIconOnly:!l,onClick:j,children:[(0,s.jsx)(C.JO,{className:"size-5",icon:"mingcute:download-line"}),l&&(0,s.jsx)("h3",{className:"text-sm",children:"Download"})]})})]})};return l?(0,s.jsxs)("div",{className:"flex gap-2.5 items-center z-1",children:[(0,s.jsx)("div",{className:"hidden md:flex gap-2.5 items-center",children:(0,s.jsx)(y,{})}),(0,s.jsx)("div",{className:"flex md:hidden",children:(0,s.jsxs)(eH.j,{children:[(0,s.jsx)(eJ.b,{children:(0,s.jsx)(S.A,{isIconOnly:!0,className:"flex lg:hidden z-1",size:"sm",variant:"flat",children:(0,s.jsx)(C.JO,{className:"size-5",icon:"tabler:dots"})})}),(0,s.jsx)(eG.g,{className:"flex flex-col-reverse gap-3 p-3 bg-[#0F0F0F] border-1 border-black-100",children:(0,s.jsx)(y,{showLabels:!0})})]})}),(0,s.jsx)(S.A,{size:"sm",variant:"flat",isDisabled:d||b,isLoading:i?p:n,onClick:i?v:w,children:(0,s.jsx)("h3",{className:"text-sm",children:i?"Unpublish":"Publish"})})]}):null},eZ=()=>(0,s.jsx)("header",{className:"flex w-full flex-col justify-center gap-4 h-14 min-h-14 px-3 lg:flex-row lg:justify-between",children:(0,s.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-1 items-center text-large font-medium select-none z-[1]",children:[(0,s.jsx)(eL,{}),(0,s.jsx)(eV,{}),(0,s.jsx)(eN.B,{})]}),(0,s.jsx)("div",{className:"sm:absolute inset-x-0 flex justify-center z-0 gap-2",children:(0,s.jsx)(ez,{})}),(0,s.jsx)(eq,{})]})}),eY=e=>{let{aspectRatio:t=1,children:a}=e;return(0,s.jsx)("div",{className:"container",children:(0,s.jsx)("div",{style:{aspectRatio:t},className:"square",children:a})})};var eK=a(20967),eQ=a(87840),eX=a(81254),e$=a(92378),e0=a(68887);let e1={[i.WAITING]:"Waiting in queue...",[i.STARTED]:"Running...",[i.COMPLETED]:"Completed"},e4=e=>{let{index:t}=e,{activeJobStatus:a,panels:l}=k(),i=l[t];if(!i)return null;let r=i.image;return(0,s.jsx)(eQ.E.div,{className:"absolute bottom-10 w-full flex items-center justify-center",initial:{opacity:0,scale:.85},animate:{opacity:r.src?0:1,scale:r.src?.9:1,transition:{duration:.3}},exit:{opacity:0,scale:.9},children:(0,s.jsx)(e$.w,{shadow:"none",className:"h-12 w-48 text-sm mx-3 flex flex-row justify-center items-center gap-2 p-2 rounded-xl border-2 border-orange-400",children:(0,s.jsx)(e0.M,{mode:"wait",children:(0,s.jsx)(eQ.E.h2,{className:"text-orange-400 truncate",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e1[a]},a)})})})},e3=e=>{let{index:t}=e,{activePanelIdx:a,panels:l,selectedLayout:i,paneDimensions:r,onClickPane:n}=k(),o=l[t],c=a===t;if(!o)return console.error("Panel not found for index",t),null;let d=o.image.isGenerating,m=o.image,p=o.text,x=u.WN[i];return(0,s.jsxs)("div",{style:{aspectRatio:r.paneWidth/r.paneHeight},className:(0,ef.cn)(x,"relative flex-1 border-3 overflow-hidden mx-auto my-0 bg-black-400",c?"border-orange-400":"border-transparent"),onClick:()=>n(t),children:[m.isGenerating&&!m.src&&(0,s.jsx)(eQ.E.div,{className:"size-full flex items-center justify-center backdrop-blur-lg",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,s.jsx)(eK.X,{className:"size-full opacity-50"})}),m.isGenerating&&(0,s.jsx)(e4,{index:t}),(0,s.jsx)(eQ.E.div,{className:"size-full max-h-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},children:(0,s.jsx)(eX.g,{type:o.type,src:m.src,topText:m.topText,progress:d?m.progress:100,bottomText:m.bottomText,centerText:p.text,imageWidth:m.width,imageHeight:m.height,canvasWidth:r.paneWidth,canvasHeight:r.paneHeight},m.src)})]})},e5=()=>{let{selectedLayout:e,canvasAspectRatio:t,isMounting:a}=k(),l=(0,c.useMemo)(()=>u.i4[e],[e]);return(0,s.jsx)(eY,{aspectRatio:t,children:(0,s.jsx)("div",{className:"size-full flex items-center justify-center overflow-hidden max-h-full max-w-full min-h-0",children:a?(0,s.jsx)(eg.c,{}):(0,s.jsx)("div",{className:(0,ef.cn)("max-h-full max-w-full grid",u.J2[e]),children:Array.from({length:l}).map((e,t)=>(0,s.jsx)(e3,{index:t},t))})})})},e2=()=>{let{isPostModalOpen:e,postId:t,composedMemeId:a,composedMemeUrl:l,onClosePostModal:i}=k();return(0,s.jsxs)("div",{className:"fixed z-50 flex flex-row items-center justify-between h-screen overflow-y-auto dot-grid inset-x-0 min-h-screen max-h-screen t-0",children:[(0,s.jsxs)("div",{className:"relative flex flex-col flex-1 size-full min-h-0 overflow-hidden",children:[(0,s.jsx)(eZ,{}),(0,s.jsx)("main",{className:"size-full relative flex justify-end flex-1 max-w-[100vw]",children:(0,s.jsxs)("div",{className:"flex flex-col size-full transition-all",children:[(0,s.jsx)("div",{className:"size-full min-h-0 overflow-hidden p-3 lg:px-6 lg:py-3 flex flex-row justify-center",children:(0,s.jsx)(e5,{})}),(0,s.jsx)(ey,{})]})}),e&&a&&l&&(0,s.jsx)(n.F,{postId:null!=t?t:void 0,memeId:a,memeUrl:l,onClose:i})]}),t?(0,s.jsx)("div",{className:"p-3 pl-0 h-full hidden lg:flex",children:(0,s.jsx)("div",{className:"p-3 rounded-2xl bg-[#0F0F0F] border-1 border-black-100 w-96 max-h-full flex-none flex-col gap-4 lg:h-full",children:(0,s.jsx)(ej,{},t)})}):(0,s.jsx)("div",{className:"p-3 pl-0 h-full hidden lg:flex",children:(0,s.jsx)("div",{className:"rounded-2xl bg-[#0F0F0F] border-1 border-black-100 w-96 max-h-full flex-none flex-col gap-4 lg:h-full",children:(0,s.jsx)(eh,{})})})]})},e8=()=>(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(eg.c,{size:"sm",color:"white"}),"Connecting to server"]}),e6=(0,eo.D)(()=>{(0,o.yv)((0,s.jsx)(e8,{}),{key:"reconnect",variant:"warning",hideIconVariant:!0,preventDuplicate:!0,persist:!0})},1e3),e7=()=>{let{profile:e}=(0,eM.useProfile)(),[t,a]=(0,c.useState)(null),l=(0,c.useRef)(!1),i=(0,c.useCallback)(()=>{if(!e)return;let t=new WebSocket("".concat((0,p.s)(),"/").concat(e.user.id));return t.onopen=()=>{console.log("Connected to server"),(0,o.sy)()},t.onclose=()=>{!0!==l.current&&(console.log("Disconnected from server"),setTimeout(()=>{i()},2e3),e6())},a(t),t},[e]);return(0,c.useEffect)(()=>{let e=i();return l.current=!1,()=>{e&&e.close(),l.current=!0,(0,o.sy)()}},[i]),{socket:t}};function e9(){var e,t,a;let l=(0,r.useSearchParams)(),i=null!==(e=l.get("remix"))&&void 0!==e?e:void 0,n=null!==(t=l.get("meme"))&&void 0!==t?t:void 0,o=null!==(a=l.get("character"))&&void 0!==a?a:void 0,{profile:c}=(0,eM.useProfile)(),{socket:d}=e7(),{config:u}=(0,q.useDiffusionConfig)();return c&&d&&u&&window.localStorage?(0,s.jsx)(_,{profile:c,socket:d,config:u,queryParams:{memeId:n,remixMemeId:i,characterId:o},children:(0,s.jsx)(eE,{children:(0,s.jsx)(e2,{})})}):null}},19783:function(e,t,a){"use strict";a.d(t,{U:function(){return v}});var l=a(57348),i=a(53350),s=a(92378),r=a(6526),n=a(950),o=a(4930),c=a(67425),d=a(12465),u=a(15346),m=a(69467),p=a(39543),x=a(38857);let h=async e=>new Promise((t,a)=>{let l=new Image,i=new FileReader;i.onload=()=>{l.src=i.result},l.onload=()=>{let a=(0,p.vO)(l.width,l.height),{paneWidth:i,paneHeight:s}=(0,p.rf)(m.WV.One,a),r=document.createElement("canvas");r.width=i,r.height=s;let n=r.getContext("2d");if(!n)return;let o=l.width,c=l.height;(0,x.h)({ctx:n,image:l,targetWidth:i,targetHeight:s,imageWidth:o,imageHeight:c}),t({base64:r.toDataURL(e.type),aspectRatio:a,targetWidth:i,targetHeight:s})},i.onerror=e=>{a(e)},i.readAsDataURL(e)});var f=a(99957),g=a(81727);let v=e=>{let{initialSrc:t,imageRef:a,bgColor:m="bg-black-300",onParseImage:p,onClickDeleteMeme:x}=e,[v,w]=(0,u.useState)(t),[b,j]=(0,u.useState)(!1),[y,N]=(0,u.useState)(!1),_=(0,u.useCallback)(async e=>{if(e){if((0,d.sy)(),e.length>10){(0,d.yv)("Please upload 10 files or less",{variant:"error"});return}for(let t=0;t<e.length;t++)if(e[t].size>33554432){(0,d.yv)("Please upload files 32MB or less",{variant:"error"});return}j(!0);try{if(0===e.length)return;let t=e[0],{base64:a,aspectRatio:l,targetWidth:i,targetHeight:s}=await h(t),r=a.split(",")[1],n=Uint8Array.from(atob(r),e=>e.charCodeAt(0));await p(n,i,s,l),w(a)}catch(e){console.error("Error uploading files",e),(0,d.yv)("Error uploading files",{variant:"error"})}finally{j(!1)}}},[p]),k=(0,u.useCallback)(async()=>{N(!0);try{await x(),w(null)}catch(e){console.error("Error deleting meme",e)}finally{N(!1)}},[x]);return(0,l.jsxs)(s.w,{radius:"md",shadow:"none",className:(0,f.cn)(m,"border-1 border-transparent transition-all",v?"":"hover:border-orange-400"),children:[(0,l.jsx)("div",{className:"relative size-full max-h-full max-w-full aspect-square flex items-center justify-center ".concat(v?"":"cursor-pointer"),children:v?(0,l.jsx)(r.J,{ref:a,alt:"Image input",classNames:{wrapper:"size-full min-w-full min-h-full",img:"size-full object-cover rounded-none"},src:v}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.JO,{className:"size-8",icon:"hugeicons:image-upload-01"}),(0,l.jsx)("input",{type:"file",multiple:!1,accept:g.RL,className:"absolute inset-0 size-full cursor-pointer opacity-0",onChange:e=>_(e.target.files)})]})}),(0,l.jsxs)(n.i,{className:"gap-4 justify-end min-h-10 overflow-hidden absolute w-full z-10 -top-2.5 -right-2.5",children:[b?(0,l.jsx)(o.c,{size:"sm",color:"warning"}):null,v&&!b?(0,l.jsx)(c.A,{size:"sm",variant:"flat",radius:"full",className:"backdrop-blur-sm bg-red-900/70",isIconOnly:!0,color:"danger",isLoading:y,onClick:k,children:(0,l.jsx)(i.JO,{className:"size-5 !text-red-400",icon:"ic:baseline-close"})}):null]})]})}},13343:function(e,t,a){"use strict";a.d(t,{E:function(){return r}});var l=a(57348),i=a(81015),s=a(54167);let r=e=>{let{children:t,...a}=e;return s.BB||s.cm?(0,l.jsx)(i.e,{...a,children:t}):(0,l.jsx)(l.Fragment,{children:t})}},8485:function(e,t,a){"use strict";a.d(t,{o:function(){return n}});var l=a(57348),i=a(4930),s=a(82896);let r={default:3,1100:3,700:2,500:1},n=e=>{let{memes:t,isFetching:a,hasFetched:n,hasSearched:o,noResultsMessage:c="No memes",className:d="overflow-hidden pl-3 pt-3",breakpoints:u=r,renderItem:m}=e;return(0,l.jsxs)("div",{className:d,children:[!a&&0===t.length&&(n||o)?(0,l.jsx)("div",{className:"text-white-400/75",children:c}):null,a&&0===t.length&&(0,l.jsx)("div",{className:"flex w-full justify-center p-3",children:(0,l.jsx)(i.c,{})}),(0,l.jsx)(s.Z,{breakpointCols:u,className:"my-masonry-grid min-w-full max-w-full",columnClassName:"my-masonry-grid_column",children:t.map(m)}),a&&t.length>0&&(0,l.jsx)("div",{className:"flex w-full justify-center p-3",children:(0,l.jsx)(i.c,{})})]})}},24645:function(e,t,a){"use strict";a.d(t,{Y:function(){return u}});var l=a(57348),i=a(45155),s=a(15346),r=a(18491),n=a(81254),o=a(73421),c=a(69467),d=a(62568);let u=e=>{var t,a,u,m,p,x,h,f,g,v;let{meme:w,isSelected:b,showCreator:j=!1,onClick:y}=e,{onOpenMeme:N}=(0,o.useMemeModal)(),[_,k]=(0,s.useState)((0,c.kl)(w)),{memeDescription:C,memeCreator:z}=(0,d.VU)(w);return(0,l.jsx)("article",{className:"relative w-full cursor-pointer select-none overflow-hidden rounded-lg border-2 ".concat(b?"border-blue-500":"border-transparent"),onClick:()=>y?y():N(w.id),children:(0,l.jsxs)("div",{className:"group flex w-full flex-col",children:["generated"===w.source?(0,l.jsx)(n.g,{type:w.source,src:w.url,alt:C,canvasWidth:null!==(u=w.width)&&void 0!==u?u:1024,canvasHeight:null!==(m=w.height)&&void 0!==m?m:1024,imageWidth:null!==(p=w.width)&&void 0!==p?p:1024,imageHeight:null!==(x=w.height)&&void 0!==x?x:1024,topText:null!==(h=null===(t=w.text_overlay)||void 0===t?void 0:t.top_text)&&void 0!==h?h:null,bottomText:null!==(f=null===(a=w.text_overlay)||void 0===a?void 0:a.bottom_text)&&void 0!==f?f:null,centerText:null,className:"z-0 size-full rounded-lg bg-white-400/5 transition-transform group-hover:scale-105"}):(0,l.jsx)(i.default,{className:"z-0 size-full rounded-lg bg-white-400/5 transition-transform group-hover:scale-105",src:w.url,alt:C,width:null!==(g=w.width)&&void 0!==g?g:1024,height:null!==(v=w.height)&&void 0!==v?v:1024}),_&&(0,l.jsx)(r.T,{src:w.url,onClickShow:()=>k(!1)}),j&&(0,l.jsx)("div",{className:"absolute inset-0 z-0 flex select-none items-end px-1.5 py-1 opacity-0 transition-opacity hover:opacity-100",children:(0,l.jsx)("div",{className:"flex flex-1 items-center gap-2",children:(0,l.jsxs)("div",{className:"flex flex-1 items-center gap-2 truncate p-1 text-sm font-semibold drop-shadow-[0.5px_0.5px_1px_rgba(0,0,0,80)]",children:[(0,l.jsx)(i.default,{src:w.creator_avatar||"",alt:z,className:"rounded-full hover:scale-105",width:24,height:24}),w.creator_handle]})})})]})})}},12854:function(e,t,a){"use strict";var l,i;function s(e){return"Trending"===e}a.d(t,{W1:function(){return s},br:function(){return r},c1:function(){return n},mQ:function(){return l}}),(0,a(75952).Cb)("all"),(i=l||(l={})).Home="Home",i.Trending="Trending",i.Library="My Library",i.Profile="Profile";let r=(e,t)=>{switch(e){case"Home":return t?"fluent:home-24-filled":"fluent:home-24-regular";case"Trending":return t?"ph:fire-fill":"ph-fire";case"My Library":return t?"fluent:emoji-meme-24-filled":"fluent:emoji-meme-24-regular";case"Profile":return t?"fluent:person-24-filled":"fluent:person-24-regular"}},n=(e,t)=>{switch(e){case"Home":return"/home";case"Trending":return"/trending";case"My Library":return"/library";case"Profile":return"/u/".concat(t)}}},30640:function(e,t,a){"use strict";a.d(t,{B:function(){return n}});var l=a(57348),i=a(45155),s=a(21008),r=a(99957);let n=e=>{let{keepMemeDeck:t=!1,keepStudio:a=!1}=e;return(0,l.jsxs)("div",{className:"flex items-center h-8 min-h-8",children:[(0,l.jsx)(i.default,{priority:!0,src:s.Z,alt:"Meme Deck",className:(0,r.cn)("h-8 w-auto xl:block",t?"":"hidden"),draggable:!1}),(0,l.jsx)("h1",{className:(0,r.cn)("text-stone-300 text-lg sm:block",a?"":"hidden"),children:"Studio"})]})}},86628:function(e,t,a){"use strict";a.d(t,{d:function(){return d}});var l=a(57348),i=a(53350),s=a(51934),r=a(67425),n=a(88036),o=a(15346),c=a(87140);let d=e=>{var t;let{selectedAesthetic:a,onSelect:d,hideDescription:u=!1,isMobile:m=!1}=e,{config:p}=(0,c.useDiffusionConfig)(),[x,h]=(0,o.useState)("None selected"),f=(0,o.useCallback)(e=>{if(e||d(null),!p)return;let t=p.aesthetics.find(t=>t.id===e);d(null!=t?t:null)},[p,d]);return p?(0,l.jsx)(s.d,{"aria-label":"aesthetic selector",label:"Style",placeholder:x,description:u?null:null!==(t=null==a?void 0:a.description)&&void 0!==t?t:"Applies a style to the prompt",selectedKey:a?a.id:null,size:"md",onFocus:e=>{m&&e.preventDefault()},onOpenChange:e=>{e?h("Type to filter"):h("None selected")},className:"z-0",isClearable:!1,endContent:a&&(0,l.jsx)(r.A,{size:"sm",isIconOnly:!0,variant:"flat",onClick:()=>d(null),children:(0,l.jsx)(i.JO,{icon:"material-symbols-light:close",className:"size-4 text-white-400"})}),onSelectionChange:f,children:p.aesthetics.map(e=>(0,l.jsx)(n.R,{"aria-label":e.name,className:"flex flex-column justify-center gap-2",children:(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{children:e.name}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:e.description})]})},e.id))}):null}},98832:function(e,t,a){"use strict";a.d(t,{z:function(){return x}});var l=a(57348),i=a(53350),s=a(1718),r=a(67425),n=a(5070),o=a(88036),c=a(15346),d=a(87140);let u=e=>"base"===e?0:1,m=e=>{switch(e){case 0:return"Meme Characters";case 1:return"Crypto Friends";default:return"Other"}},p=e=>{let t=-1,a=[];for(let l of e)l.section!==t&&(a.push({id:Math.random().toString(),section:l.section,isDivider:!0}),t=l.section),a.push(l);return a},x=e=>{let{selectedCharacter:t,selectedStyler:a,onSelect:x,showClearButton:h=!0}=e,{config:f}=(0,d.useDiffusionConfig)(),[g,v]=(0,c.useState)(!1),w=(0,c.useMemo)(()=>{var e;return null!==(e=null==f?void 0:f.characters)&&void 0!==e?e:[]},[null==f?void 0:f.characters]),b=(0,c.useMemo)(()=>null==t?void 0:t.id,[t]),j=(0,c.useMemo)(()=>p(w.sort((e,t)=>"normal"===e.id?1:"normal"===t.id?-1:0).map(e=>{var t;return{...e,avatar:null!==(t=e.thumbnail)&&void 0!==t?t:"",section:u(e.grouping),isSelected:b===e.id,isDivider:!1}}).sort((e,t)=>e.section-t.section)),[w,b]),y=(0,c.useCallback)(e=>{let t=w.find(t=>t.id===e);t&&x(t)},[w,x]),N=(0,c.useMemo)(()=>j.filter(e=>0===e.section).length,[j]),_=(0,c.useMemo)(()=>j.filter(e=>1===e.section).length,[j]);return(0,l.jsx)(s.g,{items:j,isOpen:g,onOpenChange:v,placeholder:"Select a character","aria-label":"Character",classNames:{trigger:"h-[80px]",popoverContent:"bg-[#0F0F0F] border-1 border-black-100",listbox:"h-fit selector-list-box",listboxWrapper:"min-h-[400px]"},selectedKeys:[b].filter(Boolean),onChange:e=>y(e.target.value),endContent:b&&h&&(0,l.jsx)(r.A,{size:"sm",isIconOnly:!0,variant:"flat",onClick:()=>x(null),children:(0,l.jsx)(i.JO,{icon:"material-symbols-light:close",className:"size-4 text-white-400"})}),renderValue:e=>e.map(e=>{var t,a,i,s;return(null===(t=e.data)||void 0===t?void 0:t.isDivider)?null:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(n.h,{alt:(null===(a=e.data)||void 0===a?void 0:a.id)+"-avatar",className:"shrink-0 mr-2",radius:"md",size:"lg",src:null===(i=e.data)||void 0===i?void 0:i.avatar}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("span",{className:"text-tiny text-default-600",children:"Character"}),(0,l.jsx)("h3",{className:"text-xl font-semibold",children:null===(s=e.data)||void 0===s?void 0:s.name})]})]},e.key)}),children:e=>e.isDivider?(0,l.jsx)(o.R,{hideSelectedIcon:!0,isReadOnly:!0,"aria-disabled":!0,className:"col-span-full",classNames:{base:"bg-transparent hover:!bg-transparent cursor-default"},children:(0,l.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,l.jsxs)("h3",{className:"uppercase text-xs tracking-wide font-medium text-white-400/50 select-none",children:[m(e.section)," "]}),(0,l.jsx)("div",{className:"text-xs font-normal text-white-400/70 bg-white-400/10 rounded-full px-1 py-0.5 min-w-[20px] text-center",children:0===e.section?N:_}),(0,l.jsx)("hr",{className:"flex-1 opacity-10"},"divider-".concat(Math.random()))]})},null==e?void 0:e.id):(0,l.jsx)(o.R,{"aria-label":null==e?void 0:e.name,color:e.isSelected?"primary":"default",variant:"solid","data-hover":!0,hideSelectedIcon:!0,classNames:{base:"flex-1 flex flex-col gap-0 ".concat(e.isSelected?"bg-primary-400":""),wrapper:"flex flex-col"},children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 items-center",children:[(0,l.jsx)(n.h,{alt:(null==e?void 0:e.id)+"-avatar",radius:"md",size:"lg",src:null==e?void 0:e.avatar}),(0,l.jsx)("div",{className:"flex items-center gap-1",children:(0,l.jsx)("span",{className:"text-sm font-medium",children:null==e?void 0:e.name})})]})},null==e?void 0:e.id)})}},23136:function(e,t,a){"use strict";a.d(t,{T:function(){return o}});var l=a(57348),i=a(46766),s=a(45155),r=a(15346),n=a(82739);let o=e=>{let{value:t,autofocus:a,initialSearch:o,placeholder:c="Search for memes. (i.e. pepe)",onFocus:d,onSearch:u}=e,m=(0,r.useRef)(null);return(0,l.jsx)(i.Y,{isClearable:!0,onClear:()=>{null==u||u("")},radius:"full",classNames:{base:"flex-1",input:"text-base placeholder:text-base placeholder:text-white-400/50"},startContent:(0,l.jsx)(s.default,{priority:!0,src:n.Z,alt:"Dropdown",onClick:e=>{var t;e.preventDefault(),null===(t=m.current)||void 0===t||t.focus()},className:"mr-1 size-5 cursor-text select-none opacity-75"}),ref:m,autoFocus:a,defaultValue:o,placeholder:c,className:"h-10 min-w-24 flex-1 rounded-full border border-white-400/5 bg-white-400/5 shadow-sm outline-none placeholder:text-xl placeholder:text-white-400/50",value:t,onFocus:d,onChange:e=>null==u?void 0:u(e.target.value)})}},87140:function(e,t,a){"use strict";a.r(t),a.d(t,{DiffusionConfigProvider:function(){return n},useDiffusionConfig:function(){return o}});var l=a(57348),i=a(15346),s=a(55771);let r=(0,i.createContext)(void 0),n=e=>{let{children:t}=e,[a,n]=(0,i.useState)(!0),[o,c]=(0,i.useState)(null);return(0,i.useEffect)(()=>{n(!0),s.p.getConfig().then(c).finally(()=>n(!1))},[]),(0,l.jsx)(r.Provider,{value:{config:o,isFetchingConfig:a},children:t})},o=()=>{let e=(0,i.useContext)(r);if(void 0===e)throw Error("useDiffusionConfig must be used within DiffusionConfigProvider");return e}},82739:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/search.3dc28276.svg",height:18,width:18,blurWidth:0,blurHeight:0}},21008:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/logo-wide.572ec4d3.svg",height:256,width:702,blurWidth:0,blurHeight:0}}},function(e){e.O(0,[7398,7425,4175,3159,8797,2079,6002,3881,7686,1639,6440,9028,4822,1510,6814,1718,5952,9394,874,6016,958,5878,8852,5658,937,7114,1744],function(){return e(e.s=43939)}),_N_E=e.O()}]);