(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4243],{6e4:function(e,t,l){Promise.resolve().then(l.bind(l,10382))},10382:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return ew}});var r=l(59547),n=l(74600),i=l(1463),a=l(30912),s=l(95320),c=l(56582),d=l(21278),o=l(71904),u=l(58741);let m=async e=>{let{deckId:t,name:l,description:r,memes:n,onStartSaving:a,onFinishSaving:s}=e;null==a||a();let c=Object.values(n).reduce((e,t,l)=>(t&&(e[String(l)]={id:null,meme_id:t.id,index:l,origin:t.type||"creator"}),e),{});await i.P.updateDeck(t,{name:l,description:r,memes:c}),null==s||s()},f=(0,u.k)(m,1e3);var h=l(15361),x={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/checkmark.icloud.635aaf11.svg",height:51,width:67,blurWidth:0,blurHeight:0},g={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/sync.69735e91.svg",height:10,width:10,blurWidth:0,blurHeight:0};let p=e=>{let{saving:t=!1}=e;return(0,r.jsxs)("div",{className:"flex w-20 items-center gap-2",children:[(0,r.jsx)(h.default,{src:t?g:x,className:"w-5 opacity-50",alt:"Saving"}),(0,r.jsx)("p",{className:"text-white-400/50 text-sm",children:t?"Saving...":"Saved"})]})};var v=l(21087);let b=(0,u.k)(i.P.tagResource,1e3),j=e=>{let{deckId:t,tags:l}=e,[n,s]=(0,a.useState)(l),c=n.length<10?[...n,{id:"",name:""}]:n,d=async e=>{await i.P.untagResource(t,e),s(t=>t.filter(t=>t.id!==e))},o=async(e,l)=>{let r=l.toLowerCase().replaceAll(" ","_").replaceAll("-","_");s(t=>{let n=[...t];return n[e]={id:r,name:l},n});try{var a;await b(t,l),(null===(a=n[e])||void 0===a?void 0:a.id)&&await i.P.untagResource(t,n[e].id)}catch(e){s(n)}};return(0,r.jsx)("div",{className:"mx-2 flex gap-2 overflow-x-auto",children:c.map((e,t)=>(0,r.jsx)(v.V,{tagId:e.id,tagName:e.name,onUpdateTag:e=>o(t,e),onDeleteTag:()=>d(e.id)},"tag-pill-".concat(e.id,"-").concat(t)))})};var w=l(77376),y=l(23059),k=l(62350),N=l(79700);let C=e=>{let{onClickView:t,onClickDelete:l,onClickUnpublish:n}=e,[i,s]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),o=e=>{e.target.closest("#edit-btn")||s(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.M,{isOpen:c,onCancel:()=>d(!1),onConfirm:l}),(0,r.jsx)(k.O,{id:"edit-btn",src:y.Z,alt:"Edit deck",margin:"m-0",onClick:()=>(s(!0),document.addEventListener("click",o),()=>{document.removeEventListener("click",o)})}),i&&(0,r.jsx)(w.L,{width:"w-28",position:"absolute right-0 top-16",itemPadding:"px-3",items:[{label:"View",onClick:t},{label:"Unpublish",onClick:n},{label:"Delete",type:"danger",onClick:()=>d(!0)}]})]})};var _=l(99854),S=l(40123),I=l(82972);let D=e=>{let{deckId:t,name:l,description:i,tags:a,isSaving:s,isDraft:c,isPublishDisabled:d,isPublishing:o,onChangeName:u,onChangeDescription:m,onClickPublish:f,onClickUnpublish:h,onClickDelete:x}=e,g=(0,n.useRouter)();return(0,r.jsxs)("div",{className:"border-white-400/5 flex flex-col gap-2 p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col-reverse md:flex-row md:gap-8",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,r.jsx)(_.Y,{type:"text",placeholder:"Deck name",variant:"flat",classNames:{inputWrapper:"bg-transparent",input:"w-full text-2xl font-bold"},autoFocus:!l,value:l,onChange:u}),(0,r.jsx)(S.Y,{variant:"flat",placeholder:"Deck description",maxRows:2,classNames:{inputWrapper:"bg-transparent",input:"!text-white-400/70"},className:" hover:border-white-400/5 focus:border-white-400/15 resize-none rounded-md border border-transparent bg-transparent py-1 outline-none",value:i,onChange:m})]}),(0,r.jsxs)("div",{className:"flex h-12 items-center justify-end gap-4",children:[(0,r.jsx)(p,{saving:s}),c?(0,r.jsx)(I.A,{variant:"shadow",color:"primary",isLoading:o,isDisabled:d,onClick:f,children:"Publish"}):(0,r.jsx)(C,{onClickView:()=>{g.push("/deck/".concat(t))},onClickDelete:x,onClickUnpublish:h})]})]}),(0,r.jsx)(j,{deckId:t,tags:a})]})};var O=l(48822),P=l(10758),L=l(55364),z=l(52645),A=l.n(z),R=l(26524),E=l.n(R),M=l(58512),H=l.n(M);let U=e=>{let{innerRef:t,active:l,className:n,cursor:i,style:a,...s}=e;return(0,r.jsx)("button",{ref:t,className:A()(H().Action,n),tabIndex:0,style:{...a,cursor:i,"--fill":null==l?void 0:l.fill,"--background":null==l?void 0:l.background},...s})},W=e=>(0,r.jsx)(U,{cursor:"grab","data-cypress":"draggable-handle",...e,children:(0,r.jsx)("svg",{viewBox:"0 0 20 20",width:"12",children:(0,r.jsx)("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})}),F=e=>(0,r.jsx)(U,{...e,active:{fill:"rgba(255, 70, 70, 0.95)",background:"rgba(255, 70, 70, 0.1)"},children:(0,r.jsx)("svg",{width:"8",viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M2.99998 -0.000206962C2.7441 -0.000206962 2.48794 0.0972617 2.29294 0.292762L0.292945 2.29276C-0.0980552 2.68376 -0.0980552 3.31682 0.292945 3.70682L7.58591 10.9998L0.292945 18.2928C-0.0980552 18.6838 -0.0980552 19.3168 0.292945 19.7068L2.29294 21.7068C2.68394 22.0978 3.31701 22.0978 3.70701 21.7068L11 14.4139L18.2929 21.7068C18.6829 22.0978 19.317 22.0978 19.707 21.7068L21.707 19.7068C22.098 19.3158 22.098 18.6828 21.707 18.2928L14.414 10.9998L21.707 3.70682C22.098 3.31682 22.098 2.68276 21.707 2.29276L19.707 0.292762C19.316 -0.0982383 18.6829 -0.0982383 18.2929 0.292762L11 7.58573L3.70701 0.292762C3.51151 0.0972617 3.25585 -0.000206962 2.99998 -0.000206962Z"})})});var T=l(97426);let Z=e=>{let{dragOverlay:t,dragging:l,disabled:n,fadeIn:i,handle:s,handleProps:c,height:d,index:o,listeners:u,innerRef:m,onRemove:f,renderItem:h,sorting:x,style:g,transition:p,transform:v,value:b,...j}=e;return(0,a.useEffect)(()=>{if(t)return document.body.style.cursor="grabbing",()=>{document.body.style.cursor=""}},[t]),h?h({dragOverlay:!!t,dragging:!!l,sorting:!!x,index:o,fadeIn:!!i,listeners:u,ref:null!=m?m:null,style:g,transform:v,transition:p,value:b}):(0,r.jsx)("li",{ref:m,className:A()(E().Wrapper,i&&E().fadeIn,x&&E().sorting,t&&E().dragOverlay),style:{transition:[p].filter(Boolean).join(", "),"--translate-x":v?"".concat(Math.round(v.x),"px"):void 0,"--translate-y":v?"".concat(Math.round(v.y),"px"):void 0,"--scale-x":(null==v?void 0:v.scaleX)?"".concat(v.scaleX):void 0,"--scale-y":(null==v?void 0:v.scaleY)?"".concat(v.scaleY):void 0,"--index":o},children:(0,r.jsxs)("div",{className:A()("size-64 flex items-center justify-center",E().Item,l&&E().dragging,s&&E().withHandle,t&&E().dragOverlay,n&&E().disabled),style:g,"data-cypress":"draggable-item",...s?void 0:u,...j,tabIndex:s?void 0:0,children:[(0,r.jsx)(T.h,{imageUrl:b}),(0,r.jsxs)("span",{className:E().Actions,children:[f?(0,r.jsx)(F,{className:E().Remove,onClick:f}):null,s?(0,r.jsx)(W,{...c,...u}):null]})]})})};var B=l(27332),K=l.n(B);let V=e=>{let{children:t,footer:l,className:n,innerRef:i,handleProps:a,horizontal:s,hover:c,onClick:d,onRemove:o,label:u,scrollable:m,shadow:f,unstyled:h,...x}=e;return(0,r.jsxs)(d?"button":"div",{...x,ref:i,className:A()(n,K().Container,h&&K().unstyled,s&&K().horizontal,c&&K().hover,m&&K().scrollable,f&&K().shadow),onClick:d,tabIndex:d?0:void 0,children:[u?(0,r.jsxs)("div",{className:K().Header,children:[(0,r.jsx)("div",{className:"text-white-400/75 text-sm font-medium uppercase tracking-wide",children:u}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:K().Remove,children:o?(0,r.jsx)(F,{onClick:o}):void 0}),(0,r.jsx)(W,{...a})]})]}):null,t,l]})},G=e=>(0,L.cP)({...e,wasDragging:!0}),Q=e=>{var t;let{children:l,className:n,disabled:i,id:a,items:s,...c}=e,{active:d,attributes:o,listeners:u,over:m,setNodeRef:f}=(0,L.nB)({id:a,data:{type:"container",children:s},animateLayoutChanges:G}),h=(null==d?void 0:null===(t=d.data.current)||void 0===t?void 0:t.type)==="container",x=!!m&&(a===m.id&&h||s.includes(m.id));return(0,r.jsx)(V,{innerRef:i?void 0:f,className:n,hover:x,handleProps:{...o,...u},...c,children:l})},X=e=>{let{title:t}=e;return(0,r.jsx)("div",{className:"border-white-400/5 bg-black-200 flex h-10 min-h-10 flex-row items-center border-y px-4",children:(0,r.jsx)("p",{className:"text-sm",children:t})})},Y=e=>{let{disabled:t,id:l,index:n,renderItem:i,style:s,containerId:c,getIndex:d}=e,{setNodeRef:o,listeners:u,isDragging:m,isSorting:f,over:h,overIndex:x,transform:g,transition:p}=(0,L.nB)({id:l}),v=function(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=setTimeout(()=>t(!0),500);return()=>clearTimeout(e)},[]),e}(),b=m&&!v;return(0,r.jsx)(Z,{innerRef:t?void 0:o,value:l,dragging:m,sorting:f,index:n,style:null==s?void 0:s({index:n,value:l,isDragging:m,isSorting:f,overIndex:h?d(h.id):x,containerId:c}),transition:p,transform:g,fadeIn:b,listeners:u,renderItem:i})},q=[P.g4.Down,P.g4.Right,P.g4.Up,P.g4.Left],J=(e,t)=>{let{context:{active:l,droppableRects:r,droppableContainers:n,collisionRect:i}}=t;if(q.includes(e.code)){if(e.preventDefault(),!l||!i)return;let t=[];n.getEnabled().forEach(n=>{if(!n||(null==n?void 0:n.disabled))return;let a=r.get(n.id);if(!a)return;let s=n.data.current;if(s){let{type:e,children:t}=s;if("container"===e&&(null==t?void 0:t.length)>0){var c;if((null===(c=l.data.current)||void 0===c?void 0:c.type)!=="container")return}}switch(e.code){case P.g4.Down:i.top<a.top&&t.push(n);break;case P.g4.Up:i.top>a.top&&t.push(n);break;case P.g4.Left:i.left>=a.left+a.width&&t.push(n);break;case P.g4.Right:i.left+i.width<=a.left&&t.push(n)}});let s=(0,P.ey)({active:l,collisionRect:i,droppableRects:r,droppableContainers:t,pointerCoordinates:null}),c=(0,P._8)(s,"id");if(null!=c){let e=n.get(c),t=null==e?void 0:e.node.current,l=null==e?void 0:e.rect.current;if(t&&l){var a;return"placeholder"===e.id?{x:l.left+(l.width-i.width)/2,y:l.top+(l.height-i.height)/2}:(null===(a=e.data.current)||void 0===a?void 0:a.type)==="container"?{x:l.left+20,y:l.top+74}:{x:l.left,y:l.top}}}}},$=e=>{let{meme:t}=e,{profile:l}=(0,c.O)();return l?(0,r.jsxs)("footer",{className:"flex h-12 items-center gap-2 px-4",children:[(0,r.jsx)(h.default,{className:"rounded-full",src:(null==t?void 0:t.creator_avatar)||l.twitter_profile.profile_image_url_https,alt:"Profile image",width:20,height:20}),(0,r.jsx)("p",{className:"text-sm font-medium text-white-400/75",children:(null==t?void 0:t.creator_handle)||l.twitter_profile.screen_name})]}):null};var ee=l(33135);let et=()=>(0,r.jsxs)("div",{className:"bg-white-400/5 flex w-full flex-col p-3",children:[(0,r.jsx)("div",{className:"h-12"}),(0,r.jsxs)("div",{className:"flex h-64 w-full select-none flex-col items-center justify-center gap-1",children:[(0,r.jsx)(h.default,{src:ee.Z,alt:"Add meme",width:24,height:24,className:"size-12 rounded-full p-3 opacity-50",priority:!0}),(0,r.jsx)("p",{className:"mb-1 text-xs opacity-50",children:"Add meme"})]}),(0,r.jsx)("div",{className:"h-12"})]});var el={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/circle.007be7eb.svg",height:54,width:54,blurWidth:0,blurHeight:0};let er=()=>(0,r.jsxs)("div",{className:"flex size-64 select-none flex-col items-center justify-center gap-4",children:[(0,r.jsx)(h.default,{src:el,alt:"Drag and drop a meme",width:24,height:24,className:"size-7 opacity-50",priority:!0}),(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Drag and drop"})]});var en=l(49955),ei=l(6566);let ea="uploads",es="saved",ec=e=>{let{selectedTab:t,setSelectedTab:l,refetchUploads:n,refetchSaved:i}=e;return(0,r.jsx)("div",{className:"border-white-400/5 bg-black-200 flex h-10 min-h-10 flex-row items-center border-y px-1",children:(0,r.jsxs)(en.n,{size:"md",color:"primary",variant:"underlined",selectedKey:t,onSelectionChange:e=>{l(e.toString()),e===ea?n():i()},classNames:{base:"h-10",tab:"h-9"},children:[(0,r.jsx)(ei.r,{title:"Uploads"},ea),(0,r.jsx)(ei.r,{title:"Saved"},"saved")]})})},ed={sideEffects:(0,P.Ai)({styles:{active:{opacity:"0.5"}}})},eo=[],eu=e=>{let{memes:t,items:l,setItems:n,refetchUploads:i,refetchSaved:s,onDropMemeInNode:c,onDropMemeInUploadsZone:d,onReorderMemeNodes:o,uploadOrPasteImageComponent:u}=e,[m,f]=(0,a.useState)(ea),[h,x]=(0,a.useState)(Object.keys(l)),g=(0,a.useMemo)(()=>h.filter(e=>!["add",ea,es].includes(e)),[h]),[p,v]=(0,a.useState)(null),b=(0,a.useRef)(null),j=(0,a.useRef)(!1),w=!!p&&h.includes(p),[y,k]=(0,a.useState)(null),N=(0,P.Dy)((0,P.VT)(P.MA),(0,P.VT)(P.LO),(0,P.VT)(P.Lg,{coordinateGetter:J})),C=(0,a.useCallback)(e=>{if(p&&p in l)return(0,P.pE)({...e,droppableContainers:e.droppableContainers.filter(e=>e.id in l)});let t=(0,P.j2)(e),r=t.length>0?t:(0,P.Xo)(e),n=(0,P._8)(r,"id");if(null!=n){if(n in l){let t=l[n];if(t.length>0){var i;n=null===(i=(0,P.pE)({...e,droppableContainers:e.droppableContainers.filter(e=>e.id!==n&&t.includes(e.id))})[0])||void 0===i?void 0:i.id}}return b.current=n,[{id:n}]}return j.current&&(b.current=p),b.current?[{id:b.current}]:[]},[p,l]);return(0,a.useEffect)(()=>{requestAnimationFrame(()=>{j.current=!1})},[l]),(0,r.jsxs)(P.LB,{sensors:N,collisionDetection:C,measuring:{droppable:{strategy:P.uN.Always}},onDragStart:function(e){let{active:t}=e;v(t.id),k(l)},onDragOver:function(e){let{active:t,over:r}=e,i=null==r?void 0:r.id;if(null==i||t.id in l)return;let a=_(i),s=_(t.id);a&&s&&s!==a&&n(e=>{let l=e[s],n=e[a],c=n.indexOf(i),d=l.indexOf(t.id);if(g.includes(a)&&e[a].length>0)return e;let o=0;if(i in e)o=n.length+1;else if(r&&t.rect.current.translated){let e=r.rect.top+r.rect.height,l=t.rect.current.translated.top>e;o=c>=0?c+(l?1:0):n.length+1}return j.current=!0,{...e,[s]:e[s].filter(e=>e!==t.id),[a]:[...e[a].slice(0,o),e[s][d],...e[a].slice(o,e[a].length)]}})},onDragEnd:function(e){let{active:t,over:r}=e;t.id in l&&(null==r?void 0:r.id)&&x(e=>{let n=e.indexOf(t.id),i=e.indexOf(r.id),a=(0,L.Rp)(e,n,i);return o(a.filter(e=>!["add",ea,es].includes(e)).map(e=>String(l[e][0]))),a});let i=_(t.id);if(!i){v(null);return}let a=null==r?void 0:r.id;if(null==a){v(null);return}if("add"===a){let e=D();c(g.length,String(t.id)),(0,O.unstable_batchedUpdates)(()=>{x(t=>[...t,e]),n(l=>({...l,[i]:l[i].filter(e=>e!==p),[e]:[t.id]})),v(null)});return}let s=_(a);if(s){let e=l[i].indexOf(t.id),r=l[s].indexOf(a);if(g.includes(s)){if(l[s].length>0&&l[s][0]!==t.id)return l;c(g.indexOf(s),String(t.id))}else d(String(t.id));e!==r&&n(t=>({...t,[s]:(0,L.Rp)(t[s],e,r)}))}v(null)},onDragCancel:function(){y&&n(y),v(null),k(null)},children:[(0,r.jsx)(X,{title:"Deck editor"}),(0,r.jsx)("div",{className:"flex flex-1 items-center gap-4 overflow-x-auto p-4",children:(0,r.jsxs)(L.Fo,{items:[...g,"add"],strategy:L.qw,children:[g.map((e,n)=>(0,r.jsx)(Q,{id:e,label:"Meme ".concat(n+1),items:l[e],scrollable:!0,className:"min-w-72 rounded-xl bg-black-300",footer:(0,r.jsx)($,{meme:t[n]}),onRemove:()=>I(e),children:(0,r.jsx)("div",{className:"p-3",children:l[e].length?l[e].map((t,l)=>(0,r.jsx)(Y,{disabled:w,id:t,index:l,containerId:e,getIndex:S},t)):(0,r.jsx)(er,{})})},e)),(0,r.jsx)(Q,{id:"add",disabled:w,items:eo,className:"relative min-w-72 rounded-xl hover:bg-black-300",onClick:function(){let e=D();(0,O.unstable_batchedUpdates)(()=>{x(t=>[...t,e]),n(t=>({...t,[e]:[]}))})},children:(0,r.jsx)(et,{})})]})}),(0,O.createPortal)((0,r.jsx)(P.y9,{dropAnimation:ed,children:p?h.includes(p)?function(e){let n=l[e][0],i=g.indexOf(e);return(0,r.jsx)(V,{label:"Meme ".concat(i+1),shadow:!0,className:"flex w-full flex-col rounded-xl bg-black-300",footer:(0,r.jsx)($,{meme:t[i]}),children:(0,r.jsx)("div",{className:"flex-1 p-3",children:n?(0,r.jsx)(Z,{value:n},n):(0,r.jsx)(er,{})})})}(p):(0,r.jsx)(Z,{value:p,dragOverlay:!0}):null}),document.body),(0,r.jsx)(ec,{selectedTab:m,setSelectedTab:f,refetchUploads:i,refetchSaved:s}),(0,r.jsxs)("div",{className:"flex",children:[m===ea&&u,(0,r.jsx)(Q,{id:m,horizontal:!0,items:l[m],scrollable:!0,className:"flex w-full bg-white-400/5",onRemove:()=>I(m),children:(0,r.jsx)("div",{className:"flex flex-1 gap-3 overflow-x-auto p-3",children:(0,r.jsxs)(L.Fo,{items:l[m],strategy:L.PG,children:[l[m].map((e,t)=>(0,r.jsx)(Y,{disabled:w,id:e,index:t,containerId:m,getIndex:S},e)),(0,r.jsx)("div",{className:"h-64"})]})})})]})]});function _(e){return e in l?e:Object.keys(l).find(t=>l[t].includes(e))}function S(e){let t=_(e);return t?l[t].indexOf(e):-1}function I(e){e!==m&&n(t=>{let r=Array.from(new Set([...l[m],...l[e]])),n={...t};return d(String(n[e][0])),delete n[e],n[m]=r,n}),x(t=>t.filter(t=>t!==e))}function D(){let e=Object.keys(l);return String.fromCharCode(e[e.length-1].charCodeAt(0)+1)}};var em={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/photo.on.rectangle.angled.4446df88.svg",height:66,width:78,blurWidth:0,blurHeight:0},ef=l(39992);let eh=e=>{let{onChooseFiles:t}=e,l=e=>{if(e){if((0,o.sy)(),e.length>10){(0,o.yv)("Please upload 10 files or less",{variant:"error"});return}for(let t=0;t<e.length;t++)if(e[t].size>33554432){(0,o.yv)("Please upload files 32MB or less",{variant:"error"});return}t(e)}};return(0,r.jsxs)("div",{className:"relative mx-auto h-12 w-44 cursor-pointer",children:[(0,r.jsxs)("button",{type:"button",className:"flex size-full cursor-pointer items-center justify-center gap-3 rounded-3xl bg-white-400/10",children:[(0,r.jsx)(h.default,{src:em,alt:"Upload",className:"w-4 opacity-70"}),(0,r.jsx)("p",{className:"text-white-400/70",children:"Choose files"})]}),(0,r.jsx)("input",{type:"file",multiple:!0,accept:ef.RL,className:"absolute inset-0 size-full cursor-pointer opacity-0",onChange:e=>l(e.target.files)})]})},ex=e=>{let{bg:t="bg-transparent",className:l,innerRef:n,...i}=e;return(0,r.jsx)("input",{...i,ref:n,className:"text-white-400 hover:border-white-400/5 focus:border-white-400/15 rounded-md border border-transparent px-2 outline-none ".concat(t," ").concat(l),onKeyDown:e=>{var t;null===(t=i.onKeyDown)||void 0===t||t.call(i,e),"Enter"===e.key&&e.currentTarget.blur()}})};var eg=l(47177);let ep=()=>{let{startUpload:e,pasteImageLink:t}=(0,eg.useUpload)(),[l,n]=(0,a.useState)(!1),[i,s]=(0,a.useState)(""),c=i.startsWith("http"),d=async()=>{if(!c){(0,o.yv)("Invalid image link",{variant:"error"});return}s(""),n(!0);try{await t(i)}finally{n(!1)}},u=async t=>{if(t&&0!==t.length&&!l){n(!0);for(let l=0;l<t.length;l++){let r=t[l];await e(r)}n(!1)}};return(0,r.jsx)("div",{className:"flex items-center justify-center px-10",children:(0,r.jsxs)("div",{className:"flex h-[240px] flex-col justify-center gap-6",children:[(0,r.jsx)(ex,{type:"text",placeholder:"Paste image link...",disabled:l,bg:"bg-white-400/10",className:"w-full p-2 text-sm",value:i,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&d()}}),(0,r.jsxs)("div",{className:"relative flex w-full justify-center",children:[(0,r.jsx)("div",{className:"h-px w-52 bg-white-400/10"}),(0,r.jsx)("p",{className:"absolute left-1/2 top-0 -translate-x-1/2 -translate-y-1/2 px-4 text-xs text-white-400/35",children:"or"})]}),(0,r.jsx)(eh,{onChooseFiles:u})]})})};var ev=l(74491);let eb=e=>{let{deck:t,uploads:l,saved:s,refetchUploads:u,refetchSaved:m}=e,h=(0,n.useRouter)(),{profile:x}=(0,c.O)(),{setUploads:g,setSaved:p,removeItemFromFeed:v,appendDeckToFeed:b}=(0,ev.useFeed)(),[j,w]=(0,a.useState)(t.is_draft),[y,k]=(0,a.useState)(t.name),[N,C]=(0,a.useState)(t.description),[_,S]=(0,a.useState)(t.memes),[I,O]=(0,a.useState)(Object.keys(t.memes).reduce((e,l)=>(e[l]=[t.memes[l].url],e),{[ea]:l.map(e=>e.url),[es]:s.map(e=>e.url)}));(0,a.useEffect)(()=>{O(e=>({...e,[ea]:l.map(e=>e.url)}))},[l]),(0,a.useEffect)(()=>{O(e=>({...e,[es]:s.map(e=>e.url)}))},[s]);let P=(0,a.useMemo)(()=>Object.keys(_).length>0&&y.length>0,[_,y]),[L,z]=(0,a.useState)(!1),[A,R]=(0,a.useState)(!1),E=()=>z(!0),M=()=>z(!1),H=e=>{f({deckId:t.id,name:y,description:N,memes:_,onStartSaving:E,onFinishSaving:M,...e})};return(0,r.jsxs)("div",{className:"relative flex size-full flex-col",children:[(0,r.jsx)(D,{deckId:t.id,name:y,description:N,tags:t.tags,isSaving:L,isDraft:j,isPublishDisabled:!P||L,isPublishing:A,onChangeName:e=>{let t=e.target.value;k(t),H({name:t})},onChangeDescription:e=>{let t=e.target.value;C(t),H({description:t})},onClickPublish:()=>{t&&P&&!L&&!A&&x&&(R(!0),i.P.createPost({post_type:{deck:t.id}}).then(e=>{if(!e)throw Error("No deck returned");let t=e.post;b({...t,cover_image_url:t.memes[0].url,created_at:e.created_at,updated_at:e.updated_at,votes:e.votes,reactions:e.reactions,memes:e.post.memes.reduce((e,t)=>(e[t.id]=t,e),{})},x),(0,o.yv)("Deck published",{variant:"success"}),h.push((0,d.c1)(d.mQ.Home))}).catch(e=>{v(t.id),(0,o.yv)("Something went wrong",{variant:"error"}),console.error(e)}).finally(()=>{R(!1)}))},onClickUnpublish:()=>{t&&x&&(v(t.id),i.P.publishDeck(t.id,!0).then(()=>{(0,o.yv)("Deck drafted",{variant:"info"}),w(!0)}).catch(e=>{(0,o.yv)("Something went wrong",{variant:"error"}),console.error(e),b(t,x)}))},onClickDelete:()=>{t&&x&&(v(t.id),i.P.deleteDeck(t.id).then(()=>{(0,o.yv)("Deck deleted",{variant:"info"}),h.push((0,d.c1)(d.mQ.Home))}).catch(e=>{(0,o.yv)("Something went wrong",{variant:"error"}),console.error(e),b(t,x)}))}}),(0,r.jsx)(eu,{uploadOrPasteImageComponent:(0,r.jsx)(ep,{}),memes:_,items:I,setItems:O,refetchUploads:u,refetchSaved:m,onDropMemeInNode:(e,t)=>{let r=Object.values(_).find(e=>e.url===t)||l.find(e=>e.url===t)||s.find(e=>e.url===t);if(!r)return;let n={..._};n[String(e)]=r,S(n),g(l.filter(e=>e.id!==r.id)),p(s.filter(e=>e.id!==r.id)),H({memes:n})},onDropMemeInUploadsZone:e=>{let t=Object.values(_).find(t=>t.url===e)||l.find(t=>t.url===e)||s.find(t=>t.url===e);if(!t)return;g(l.find(e=>e.id===t.id)?l:[...l,t]),p(s.filter(e=>e.id!==t.id));let r={..._},n=Object.keys(r).find(e=>{var l;return(null===(l=r[e])||void 0===l?void 0:l.id)===t.id});n&&delete r[n],S(r),H({memes:r})},onReorderMemeNodes:e=>{let t=e.reduce((e,t,l)=>{let r=Object.values(_).find(e=>e.url===t);return r&&(e[String(l)]=r),e},{});S(t),H({memes:t})}})]})};var ej=l(71112);function ew(e){let{params:t}=e,{uploads:l,setUploads:d,saved:o,setSaved:u}=(0,ev.useFeed)(),{deckId:m}=(0,ej.u)({params:t,key:"deckId",index:3}),f=(0,n.useRouter)(),{profile:h}=(0,c.O)(),[x,g]=(0,a.useState)(),p=(0,a.useCallback)(async e=>{let t=await i.P.getUploads({start:0,limit:50}),l=[];for(let r of t)Object.values(e.memes).some(e=>e.id===r.id||e.url===r.url)||l.push(r);d(l)},[d]),v=(0,a.useCallback)(async e=>{let t=await i.P.getSavedMemes({start:0,limit:50}),l=[];for(let r of t)Object.values(e.memes).some(e=>e.id===r.id||e.url===r.url)||l.push(r);u(l)},[u]);return((0,a.useEffect)(()=>{if(!h)return;let e=decodeURIComponent(m);i.P.getDeck(e).then(async e=>{if(e&&e.creator_handle===h.twitter_profile.screen_name){g(e),p(e);return}f.push("/deck/edit")})},[m,p,h,f]),x)?(0,r.jsx)(eb,{deck:x,uploads:l,saved:o,refetchUploads:()=>p(x),refetchSaved:()=>v(x)}):(0,r.jsx)("div",{className:"flex size-full items-center justify-center",children:(0,r.jsx)(s.Ew,{})})}},95320:function(e,t,l){"use strict";l.d(t,{hd:function(){return d},Ew:function(){return o},QB:function(){return u}});var r=l(59547),n=l(79886),i=l(15361),a={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/logo.a86b8f2b.svg",height:256,width:256,blurWidth:0,blurHeight:0},s=l(7692),c=l(1489);let d=()=>(0,r.jsx)("div",{className:"flex h-16 select-none items-center justify-center lg:px-2 lg:text-left",children:(0,r.jsxs)(n.default,{href:"/home",children:[(0,r.jsx)("div",{className:"hidden lg:block lg:w-[170px]",children:(0,r.jsx)(u,{})}),(0,r.jsx)("div",{className:"lg:hidden",children:(0,r.jsx)(o,{})})]})}),o=()=>(0,r.jsx)(i.default,{src:a,alt:"".concat(c.jG," Icon"),className:"h-10 w-full select-none"}),u=e=>{let{className:t="h-12"}=e;return(0,r.jsx)(i.default,{priority:!0,src:s.Z,alt:"".concat(c.jG," Logo"),className:t,draggable:!1})}},97426:function(e,t,l){"use strict";l.d(t,{h:function(){return i}});var r=l(59547),n=l(15361);let i=e=>{let{imageUrl:t,alt:l="Meme"}=e;return(0,r.jsxs)("div",{className:"relative size-full select-none overflow-hidden rounded-xl bg-white-400/10",children:[(0,r.jsx)(n.default,{className:"absolute z-0 inset-0 object-cover blur-lg scale-110 size-full",src:t,alt:"Meme blur",width:400,height:400,loading:"eager"}),(0,r.jsx)(n.default,{draggable:!1,className:"deckpreviewimg absolute z-1 inset-0 size-full object-contain",src:t,alt:l,width:640,height:640,sizes:"640px",loading:"lazy"})]})}},27694:function(e,t,l){"use strict";l.d(t,{u:function(){return a}});var r=l(59547),n=l(15361),i=l(69919);let a=e=>{let{title:t,children:l,isOpen:a,glow:s=!0,hideOnCloseButton:c=!1,onClose:d}=e;return a?(0,r.jsx)("div",{className:"bg-white-100 fixed inset-0 z-50 flex size-full max-h-full min-h-0 items-center justify-center overflow-y-auto overflow-x-hidden p-4",onClick:d,children:(0,r.jsxs)("div",{className:"".concat(s?"glow":""," bg-black-400 relative flex w-full max-w-md flex-col items-center gap-6 rounded-lg px-6 pb-8 pt-6 shadow-lg"),onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("header",{className:"relative flex w-full items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:t}),d&&!c&&(0,r.jsx)("button",{onClick:d,className:"absolute right-0 translate-x-1/4 p-2",children:(0,r.jsx)(n.default,{src:i.Z,alt:"close",className:"w-3"})})]}),(0,r.jsx)("div",{children:l})]})}):null}},77376:function(e,t,l){"use strict";l.d(t,{L:function(){return n}});var r=l(59547);let n=e=>{let{items:t,position:l="absolute inset-x-0 -top-16",width:n="w-auto",itemPadding:i="px-2"}=e;return(0,r.jsx)("div",{id:"profile-dropdown",className:"border-white-400/10 bg-black-300 z-10 mb-2 flex cursor-default flex-col items-center rounded-lg border py-2 drop-shadow ".concat(l," ").concat(n),children:t.map((e,t)=>(0,r.jsx)("button",{className:"hover:bg-black-400 w-full cursor-pointer text-left text-sm font-semibold leading-10 ".concat(i),onClick:e.onClick,children:(0,r.jsx)("p",{className:"truncate ".concat("danger"===e.type?"text-red-500":""),children:e.label})},"dropdown-item-".concat(e.label,"-").concat(t)))})}},79700:function(e,t,l){"use strict";l.d(t,{M:function(){return i}});var r=l(59547),n=l(27694);let i=e=>{let{isOpen:t,onCancel:l,onConfirm:i}=e;return(0,r.jsx)(n.u,{isOpen:t,onClose:l,title:"Are you sure?",glow:!1,children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("p",{className:"mt-2 text-white-400/75",children:"This action cannot be undone. Are you sure you want to delete this deck?"}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,r.jsx)("div",{}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{className:"px-4 py-2 text-white-400",onClick:l,children:"Cancel"}),(0,r.jsx)("button",{className:"rounded-lg bg-red-500 px-4 py-2 text-white-400",onClick:i,children:"Delete"})]})]})]})})}},62350:function(e,t,l){"use strict";l.d(t,{O:function(){return i}});var r=l(59547),n=l(15361);let i=e=>{let{src:t,alt:l,id:i,margin:a="m-2",onClick:s}=e;return(0,r.jsx)("button",{id:i,className:"flex size-9 items-center justify-center rounded-full hover:bg-black-100 ".concat(a),onClick:s,children:(0,r.jsx)(n.default,{priority:!0,src:t,alt:l,className:"w-3.5 opacity-85 xs:w-4"})})}},21278:function(e,t,l){"use strict";var r,n;l.d(t,{br:function(){return i},c1:function(){return a},mQ:function(){return r}}),(0,l(60858).Cb)("all"),(n=r||(r={})).Home="Home",n.Explore="Explore",n.Library="My Library",n.Invite="Invite Friends",n.Profile="Profile";let i=(e,t)=>{switch(e){case"Home":return t?"fluent:home-24-filled":"fluent:home-24-regular";case"Explore":return"fluent:search-24-filled";case"My Library":return t?"fluent:emoji-meme-24-filled":"fluent:emoji-meme-24-regular";case"Profile":return t?"fluent:person-24-filled":"fluent:person-24-regular";case"Invite Friends":return t?"fluent:ticket-diagonal-24-filled":"fluent:ticket-diagonal-24-regular"}},a=(e,t)=>{switch(e){case"Home":return"/home";case"Explore":return"/explore";case"My Library":return"/library";case"Profile":return"/u/".concat(t);case"Invite Friends":return"/invite"}}},21087:function(e,t,l){"use strict";l.d(t,{V:function(){return h}});var r=l(59547),n=l(30912),i=l(15361),a=l(89005),s=l(81926),c=l(69919),d=l(1463),o=l(33135),u=l(58741);let m=[],f=(0,u.k)(d.P.searchTags,1e3),h=e=>{let{tagId:t,tagName:l,minW:d="min-w-36",variant:u,onUpdateTag:h,onDeleteTag:x,onClick:g}=e,p=(0,n.useRef)(null),[v,b]=(0,n.useState)(l),[j,w]=(0,n.useState)(t),[y,k]=(0,n.useState)([]),[N,C]=(0,n.useState)(!1),[_,S]=(0,n.useState)(!1),I=async e=>{C(!0);let t=await f(e);t&&(k(t),C(!1))},D=e=>{if(e!==l)return C(!1),S(!1),k([]),null==h?void 0:h(e)},O=async()=>{k([]),C(!1),S(!0),await (null==x?void 0:x()),S(!1),b("")};return(0,r.jsx)(a.d,{ref:p,allowsCustomValue:!0,defaultInputValue:"",inputValue:v,defaultSelectedKey:"",selectedKey:j,defaultItems:m,items:y,maxLength:20,isLoading:N,isDisabled:_,className:"inline-flex w-auto max-w-0 ".concat(d),color:"default",variant:u,radius:"full",onBlur:()=>D(v),onInputChange:e=>{null!==e&&(b(e),""===e?k([]):e.length>2&&I(e))},onSelectionChange:e=>{w(e);let t=y.find(t=>t.id===e);t&&(k([]),b(t.name),D(t.name))},placeholder:"Add tag","aria-label":"Add tag",disableSelectorIconRotation:!0,selectorIcon:v.length>0?(0,r.jsx)(i.default,{src:c.Z,className:"w-2.5 opacity-75",alt:"Clear tag"}):(0,r.jsx)(i.default,{src:o.Z,className:"w-3 opacity-75",alt:"Add tag"}),isClearable:!1,selectorButtonProps:{disableRipple:!0,onClick:()=>{v.length>0&&O()}},onKeyDown:e=>{var t,l;"Escape"===e.key?null===(t=p.current)||void 0===t||t.blur():"Enter"===e.key&&0===y.length&&(null===(l=p.current)||void 0===l||l.blur())},onClick:g,children:e=>(0,r.jsx)(s.R,{value:e.id,children:e.name},e.id)})}},71112:function(e,t,l){"use strict";l.d(t,{u:function(){return n}});var r=l(74600);let n=e=>{var t;let{key:l,index:n,params:i}=e,a=(0,r.usePathname)(),s=null!==(t=a&&a.split("/")[n||2])&&void 0!==t?t:"",c=i[l]||s;return{[l]:c}}},1489:function(e,t,l){"use strict";l.d(t,{K7:function(){return i},jG:function(){return n},vk:function(){return a}});var r=l(60044);let n="MemeDeck",i="Meme With Frens",a="Create & discover memes with AI.";"".concat(n," â€“ ").concat(i),new URL(r.j7?"http://localhost:8080":"https://memedeck.xyz")},27332:function(e){e.exports={Container:"Container_Container__pQ52v",Header:"Container_Header__r6_bO",Remove:"Container_Remove__XPmyf"}},58512:function(e){e.exports={Action:"Action_Action__evDjg"}},26524:function(e){e.exports={Wrapper:"Item_Wrapper__mK2SU",fadeIn:"Item_fadeIn__ABl0L",dragOverlay:"Item_dragOverlay__3Kr9H",Item:"Item_Item__zPcUs",withHandle:"Item_withHandle__GLsS_",dragging:"Item_dragging__k70uw",pop:"Item_pop__8TG1j"}},23059:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/ellipsis.a4814300.svg",height:10,width:49,blurWidth:0,blurHeight:0}},33135:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/plus.63a0d87f.svg",height:24,width:24,blurWidth:0,blurHeight:0}},69919:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/xmark.ac6fe3e8.svg",height:48,width:48,blurWidth:0,blurHeight:0}},7692:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/logo-wide.572ec4d3.svg",height:256,width:702,blurWidth:0,blurHeight:0}}},function(e){e.O(0,[2290,1904,2972,9886,8651,2974,7957,4283,9005,858,2142,7714,7177,7930,3957,1744],function(){return e(e.s=6e4)}),_N_E=e.O()}]);