"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5866],{81840:function(e,t,l){l.d(t,{c:function(){return r}});var a=l(59547),s=l(47177),i=l(30912),n=l(39992);let r=e=>{let{deckId:t,children:l,isUploading:r,hasBorder:o=!0,hasClick:c=!0,disabled:d=!1,setIsUploading:m,onFinish:u}=e,{startUpload:h}=(0,s.useUpload)(),[x,f]=(0,i.useState)(!1),p=async e=>{e.preventDefault(),e.stopPropagation(),f(!1),m(!0);let l=e.dataTransfer.files;for(let e=0;e<l.length;e++){let a=l[e];a.type.includes("image")&&await h(a,t)}m(!1),null==u||u()},g=async e=>{if(e&&0!==e.length&&!r){m(!0);for(let l=0;l<e.length;l++){let a=e[l];await h(a,t)}m(!1),null==u||u()}};return d?(0,a.jsx)("main",{className:"relative size-full min-h-0 flex flex-col items-center justify-center gap-4 border-2 border-transparent",children:l}):(0,a.jsxs)("main",{onDragOver:e=>{e.preventDefault(),e.stopPropagation(),f(!0)},onDragLeave:()=>f(!1),onDrop:p,className:"relative size-full min-h-0 flex flex-col items-center justify-center gap-4 rounded-xl hover:bg-black-300 border-2 border-dashed ".concat(x?"border-blue-400":o?"border-white-400/10":"border-transparent"),children:[l,c&&(0,a.jsx)("input",{type:"file",multiple:!0,accept:n.RL,className:"absolute inset-0 size-full cursor-pointer opacity-0",onChange:e=>g(e.target.files)})]})}},36313:function(e,t,l){l.d(t,{R:function(){return n}});var a=l(59547),s=l(30912);let i=e=>{let t=new Image;return t.src=e,t.complete},n=e=>{let{src:t,alt:l,width:n,height:r,draggable:o=!0,style:c,noAnimation:d,prefetch:m=!1,initialLoader:u=!1,className:h}=e,[x,f]=(0,s.useState)(!u),p=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(t&&m&&!i(t)){let e=new Image;e.src=t,e.onload=()=>{f(!0)}}},[t,m]),(0,s.useEffect)(()=>{t&&p.current&&p.current.complete&&f(!0)},[p,t]),(0,a.jsxs)("div",{className:"relative flex size-full max-h-full min-h-0 flex-col justify-center",children:[!x&&(0,a.jsx)("div",{className:"absolute left-0 top-0 size-full animate-pulse"}),(0,a.jsx)("img",{ref:p,style:c,src:t,alt:l,width:n,height:r,draggable:o,className:"flex max-h-full min-h-0 select-none ".concat(d?"":"transition-opacity duration-300"," ").concat(x?"opacity-100":"opacity-0","  ").concat(h),onLoad:()=>f(!0)})]})}},67630:function(e,t,l){l.d(t,{$:function(){return n}});var a=l(59547),s=l(79886),i=l(17432);let n=e=>{let{tags:t,wrap:l="flex-wrap",onClickTag:n}=e;return(0,a.jsx)("div",{className:"flex gap-2 ".concat(l),children:t.map((e,t)=>(0,a.jsx)(s.default,{href:"/explore?query=".concat(e),onClick:()=>null==n?void 0:n(e),children:(0,a.jsx)(i.z,{variant:"flat",children:e.replace("tag:","")})},"tag-".concat(e,"-").concat(t)))})}},62350:function(e,t,l){l.d(t,{O:function(){return i}});var a=l(59547),s=l(15361);let i=e=>{let{src:t,alt:l,id:i,margin:n="m-2",w:r="w-3.5",onClick:o}=e;return(0,a.jsx)("button",{id:i,className:"flex size-9 items-center justify-center rounded-full hover:bg-black-100 ".concat(n),onClick:o,children:(0,a.jsx)(s.default,{priority:!0,src:t,alt:l,className:"opacity-85 ".concat(r)})})}},10822:function(e,t,l){l.d(t,{I:function(){return d}});var a=l(59547),s=l(30912),i=l(54939),n=l(82972),r=l(7502),o=l(93078),c=l(74491);let d=e=>{let{itemId:t,initialVotes:l={up:[],down:[]},userId:d,size:m="sm",addVoteApi:u,removeVoteApi:h}=e,{getItem:x,voteOnItem:f}=(0,c.useFeed)(),p=(0,s.useMemo)(()=>x(t),[x,t]),g=(0,s.useMemo)(()=>p?p.votes:l,[l,p]),v=(0,s.useMemo)(()=>g.up,[g.up,g.up.length]),w=(0,s.useMemo)(()=>g.down,[g.down,g.down.length]),j=(0,s.useMemo)(()=>v.length-w.length,[v,w]),b=(0,s.useMemo)(()=>v.some(e=>e.by===d),[v,v.length,d]),y=(0,s.useMemo)(()=>w.some(e=>e.by===d),[w,w.length,d]);return(0,a.jsxs)(i.g,{size:m,children:[(0,a.jsxs)(n.A,{isIconOnly:0===j,onClick:e=>{e.stopPropagation(),e.preventDefault(),b?(h(t,"upvote"),f(d,t,"remove","upvote")):(u(t,"upvote"),f(d,t,"add","upvote"))},className:b?"bg-blue-600":"",variant:"ghost",color:b?"primary":"default",children:[(0,a.jsx)(o.JO,{icon:"majesticons:arrow-up",width:20,color:"white"}),0!==j&&(0,a.jsx)(r.E.div,{initial:{opacity:0,y:j<0?10:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:0,transition:{duration:.1}},transition:{duration:.2},children:(0,a.jsx)("span",{className:"text-base font-semibold text-white-400",children:j})},j)]}),(0,a.jsx)(n.A,{isIconOnly:!0,onClick:e=>{e.stopPropagation(),e.preventDefault(),y?(h(t,"downvote"),f(d,t,"remove","downvote")):(u(t,"downvote"),f(d,t,"add","downvote"))},className:y?"bg-warning-400":"",variant:"ghost",color:y?"warning":"default",children:(0,a.jsx)(o.JO,{icon:"majesticons:arrow-down",color:y?"black":"white",width:20})})]})}},7700:function(e,t,l){l.d(t,{g:function(){return r}});var a=l(59547),s=l(15361),i=l(30912),n=l(82311);let r=e=>{let{src:t,topText:l,bottomText:r,centerText:o,id:c="image-canvas",imageWidth:d=1024,imageHeight:m=1024,canvasWidth:u=1024,canvasHeight:h=1024,alt:x="Generated Image",progress:f=100,className:p=""}=e,g=(0,i.useRef)(new Image),v=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=g.current,a=v.current;a&&(t?(e.onload=()=>{(0,n.el)(e,a,l,r,o,u,h,d,m)},e.src=t):o?(e.height=m,e.width=d,(0,n.el)(e,a,null,null,o,u,h,d,m)):(e.src="",(0,n.el)(e,a,null,null,null,u,h,d,m)))},[r,h,u,o,m,d,t,l]),(0,a.jsx)("div",{id:c,className:"size-full flex items-center justify-center",children:f&&f<100&&f>0?(0,a.jsx)(s.default,{draggable:!1,priority:!0,src:t,alt:x,style:{borderRadius:"0px",filter:f<100?"blur(".concat(70/f,"px)"):"none",transition:"filter 0.5s"},className:"transition-all object-contain rounded-2xl  w-[".concat(d,"px] h-[").concat(m,"px]  ").concat(p),width:d,height:m}):(0,a.jsx)("canvas",{ref:v,className:"w-full max-h-full object-contain ".concat(p)})})}},82311:function(e,t,l){l.d(t,{jt:function(){return u},sU:function(){return d},el:function(){return c},mr:function(){return m}});var a=l(60044),s=l(81737),i=l(19517);let n="bold ".concat(80,"px Impact");function r(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];e.font=n,e.fillStyle=t?"white":"black",e.strokeStyle=t?"black":"white",e.lineWidth=3,e.lineJoin="round",e.textAlign="center",(0,a.Dt)()&&(e.shadowColor=t?"black":"white",e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=0)}function o(e,t,l,s,i,n){for(var r=t.split(" "),o="",c=[],d=0;d<r.length;d++){var m=o+r[d]+" ";e.measureText(m).width>i&&d>0?(c.push({text:o,y:s}),o=r[d]+" ",s+=100):o=m}if(c.push({text:o.trim(),y:s}),"bottom"===n){let e=100*c.length;c=c.map(t=>({text:t.text,y:t.y-e+100}))}if("center"===n){let e=100*c.length;c=c.map(t=>({text:t.text,y:t.y-e/2+50}))}c.forEach(t=>{(0,a.Dt)()?(e.strokeText(t.text,l,t.y),e.fillText(t.text,l,t.y)):(e.fillText(t.text,l,t.y),e.strokeText(t.text,l,t.y))})}function c(e,t,l,a,s,i,n,c,d){let m=t.getContext("2d");if(!m)return;if(e.width=c,e.height=d,t.width=i,t.height=n,s)m.fillStyle="white",m.fillRect(0,0,t.width,t.height);else if(c!==i||d!==n){let l=Math.max(t.width/c,t.height/d),a=c*l,s=d*l,i=(t.width-a)/2,n=(t.height-s)/2;m.drawImage(e,i,n,a,s)}else{let l=(t.width-c)/2,a=(t.height-d)/2;m.drawImage(e,l,a)}if(!l&&!a&&!s)return;r(m,!s);let u=e.width-40,h=e.width/2;l&&o(m,l,h,120,u,"top"),s&&o(m,s,h,e.height/2,u,"center"),a&&o(m,a,h,e.height-64,u,"bottom")}function d(e){let t=0,l=0;if(e===s.L.TwoVertical)t=1024,l=1536;else if(e===s.L.TwoHorizontal)t=1536,l=1024;else if(e===s.L.Four)t=4096,l=4096;else throw Error("Unsupported panel layout");return{width:t,height:l}}async function m(e,t,l,a,n){let c=e.getContext("2d");if(!c)throw Error("Failed to create canvas context");let d=(e,t,l,a)=>{c.fillStyle="black",c.fillRect(e,t,l,a)},m=0,u=0,h=0,x=0;if(a===s.L.One){if(n){let e=i.e5[n];m=e[0],u=e[1]}else u=1024,h=m=1024,x=u}else if(a===s.L.TwoVertical)u=768,h=m=1024,x=2*u;else if(a===s.L.TwoHorizontal)u=1024,h=2*(m=768),x=u;else if(a===s.L.Four)u=1024,h=2*(m=1024),x=2*u;else throw Error("Unsupported panel layout");e.width=h,e.height=x;let f=async(e,t,l)=>{let a,s;let i=new Image;i.crossOrigin="Anonymous",i.src=e.url,await new Promise((e,t)=>{i.onload=e,i.onerror=t});let n=i.width/i.height;n>1?(a=m,s=m/n):(s=u,a=u*n);let r=(m-a)/2,o=(u-s)/2;c.drawImage(i,t+r,l+o,a,s)},p=Object.values(t),g=Object.values(l);for(let e=0;e<Math.min(i._j[a],p.length+g.length);e++){let i=t[e],n=l[e];console.log("meme",i),console.log("panelText",n);let d=0,h=0;if(a===s.L.TwoHorizontal?(d=e%2==0?0:m,h=0):a===s.L.TwoVertical?(d=0,h=e%2==0?0:u):a===s.L.Four&&(d=e%2*m,h=Math.floor(e/2)*u),i)try{var v,w;await f(i,d,h),r(c);let e=null===(v=i.text_overlay)||void 0===v?void 0:v.top_text,t=null===(w=i.text_overlay)||void 0===w?void 0:w.bottom_text,l=m-40,a=d+m/2;if(e){let t=h+120;o(c,e,a,t,l,"top")}if(t){let e=h+u-64;o(c,t,a,e,l,"bottom")}}catch(e){console.error("Failed to load image from URL: ".concat(i.url),e)}else if(n){c.fillStyle="white",c.fillRect(d,h,m,u),r(c,!1);let e=m-40;o(c,n,d+m/2,h+u/2,e,"center")}}a===s.L.TwoHorizontal?d(m,0,10,x):a===s.L.TwoVertical?d(0,u,h,10):a===s.L.Four&&(d(m,0,10,x),d(0,u,h,10)),function(e){let t=new Image;t.src="/memedeck:memedeck:meme-deck.os/_next/static/media/logo.650a12fc.png",t.onload=()=>{let l=e.canvas.width-40,a=e.canvas.height-40;e.globalAlpha=.4,e.drawImage(t,l,a,32,32)}}(c)}async function u(e,t,l){let a=document.createElement("canvas");return console.log("panelMemes",e),console.log("panelTexts",t),console.log("panelLayout",l),await m(a,e,t,l),h(a)}let h=async e=>await new Promise((t,l)=>{e.toBlob(e=>{if(!e){l(Error("Failed to create blob"));return}let a=new FileReader;a.onload=()=>{let e=a.result;t(new Uint8Array(e))},a.readAsArrayBuffer(e)},"image/jpeg")})},19517:function(e,t,l){l.d(t,{j2:function(){return u},WN:function(){return d},B5:function(){return o},HS:function(){return r},_j:function(){return n},W$:function(){return m},e5:function(){return c}});var a,s,i=l(81737);(a=s||(s={})).Square="square",a.Landscape="landscape",a.Portrait="portrait";let n={[i.L.One]:1,[i.L.TwoHorizontal]:2,[i.L.TwoVertical]:2,[i.L.Four]:4},r={[i.L.One]:"grid-rows-1 h-fit w-fit",[i.L.TwoHorizontal]:"grid-cols-2 w-full h-fit",[i.L.TwoVertical]:"grid-rows-2 w-fit h-full",[i.L.Four]:"grid-cols-2 grid-rows-2"},o={[i.L.One]:1,[i.L.TwoHorizontal]:.75,[i.L.TwoVertical]:1024/768,[i.L.Four]:1},c={[s.Square]:[1024,1024],[s.Landscape]:[1024,768],[s.Portrait]:[768,1024]},d={[i.L.One]:"h-auto w-fit",[i.L.TwoHorizontal]:"w-full h-fit",[i.L.TwoVertical]:"w-fit h-full",[i.L.Four]:"w-fit h-fit"},m={[i.L.One]:s.Square,[i.L.TwoHorizontal]:s.Portrait,[i.L.TwoVertical]:s.Landscape,[i.L.Four]:s.Square},u=e=>{let[t,l]=e;return t>l?s.Landscape:t<l?s.Portrait:s.Square}},21087:function(e,t,l){l.d(t,{V:function(){return x}});var a=l(59547),s=l(30912),i=l(15361),n=l(89005),r=l(81926),o=l(69919),c=l(1463),d=l(33135),m=l(58741);let u=[],h=(0,m.k)(c.P.searchTags,1e3),x=e=>{let{tagId:t,tagName:l,minW:c="min-w-36",variant:m,onUpdateTag:x,onDeleteTag:f,onClick:p}=e,g=(0,s.useRef)(null),[v,w]=(0,s.useState)(l),[j,b]=(0,s.useState)(t),[y,k]=(0,s.useState)([]),[N,_]=(0,s.useState)(!1),[C,P]=(0,s.useState)(!1),I=async e=>{_(!0);let t=await h(e);t&&(k(t),_(!1))},S=e=>{if(e!==l)return _(!1),P(!1),k([]),null==x?void 0:x(e)},z=async()=>{k([]),_(!1),P(!0),await (null==f?void 0:f()),P(!1),w("")};return(0,a.jsx)(n.d,{ref:g,allowsCustomValue:!0,defaultInputValue:"",inputValue:v,defaultSelectedKey:"",selectedKey:j,defaultItems:u,items:y,maxLength:20,isLoading:N,isDisabled:C,className:"inline-flex w-auto max-w-0 ".concat(c),color:"default",variant:m,radius:"full",onBlur:()=>S(v),onInputChange:e=>{null!==e&&(w(e),""===e?k([]):e.length>2&&I(e))},onSelectionChange:e=>{b(e);let t=y.find(t=>t.id===e);t&&(k([]),w(t.name),S(t.name))},placeholder:"Add tag","aria-label":"Add tag",disableSelectorIconRotation:!0,selectorIcon:v.length>0?(0,a.jsx)(i.default,{src:o.Z,className:"w-2.5 opacity-75",alt:"Clear tag"}):(0,a.jsx)(i.default,{src:d.Z,className:"w-3 opacity-75",alt:"Add tag"}),isClearable:!1,selectorButtonProps:{disableRipple:!0,onClick:()=>{v.length>0&&z()}},onKeyDown:e=>{var t,l;"Escape"===e.key?null===(t=g.current)||void 0===t||t.blur():"Enter"===e.key&&0===y.length&&(null===(l=g.current)||void 0===l||l.blur())},onClick:p,children:e=>(0,a.jsx)(r.R,{value:e.id,children:e.name},e.id)})}},89204:function(e,t,l){l.r(t),l.d(t,{AppHistoryProvider:function(){return o},useAppHistory:function(){return c}});var a=l(59547),s=l(74600),i=l(71904),n=l(30912);let r=(0,n.createContext)({}),o=e=>{let{children:t}=e,l=(0,s.usePathname)(),o=(0,s.useRouter)(),[c,d]=(0,n.useState)([]),m=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/home",t=arguments.length>1?arguments[1]:void 0;console.log("goBack",{defaultRoute:e,ignoreRouteBase:t});let l=e;c.length>1&&(l=c[c.length-2],void 0!==t&&l.includes(t)&&(l=e)),"string"!=typeof l&&(l="/home"),o.push(l,{scroll:!1})},[c,o]);return(0,n.useEffect)(()=>{d(e=>e[e.length-1]!==l?[...e,l]:e)},[l]),(0,a.jsxs)(r.Provider,{value:{goBack:m},children:[t,(0,a.jsx)(i.wT,{dense:!0,maxSnack:3})]})},c=()=>(0,n.useContext)(r)},25866:function(e,t,l){l.r(t),l.d(t,{MemeModalProvider:function(){return e_},useMemeModal:function(){return eC}});var a,s,i=l(59547),n=l(30912);let r=()=>{(0,n.useEffect)(()=>{if(window.innerWidth>1024){let e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>document.body.style.overflow=e}{let e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>document.body.style.overflow=e}},[])};var o=l(74600),c=l(1463),d=l(79886),m=l(15361),u=l(82972),h=l(88942),x=l(94913),f=l(29619),p=l(35732),g=l(24769),v={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/chevron.6ff4ee05.svg",height:8,width:12,blurWidth:0,blurHeight:0},w=l(36313),j=l(62350),b=l(89204),y=l(69919);let k=e=>{let{maxWidth:t="max-w-4xl",children:l}=e,{goBack:a}=(0,b.useAppHistory)();return(0,i.jsxs)("main",{className:"relative flex max-h-full flex-1 flex-col bg-black-400 md:min-h-full md:overflow-hidden md:bg-transparent lg:overflow-hidden",children:[(0,i.jsx)(j.O,{src:y.Z,alt:"Close",onClick:a}),(0,i.jsx)("div",{className:"relative flex min-h-0 min-w-0 max-w-full flex-1 items-center justify-center md:m-3",children:(0,i.jsx)("div",{className:"relative flex size-full max-h-full min-h-0 min-w-0 items-center justify-center ".concat(t),children:l})})]})},N=e=>{let{deck:t,currentIndex:l,onNextMeme:a,onPrevMeme:s}=e;return(0,i.jsx)(k,{maxWidth:"max-w-6xl",children:(0,i.jsxs)("div",{className:"flex size-full max-h-full min-h-0 flex-row items-center justify-center gap-3 overflow-hidden px-0 lg:gap-6 lg:p-3",children:[(0,i.jsx)(u.A,{isIconOnly:!0,color:"default",variant:"ghost",id:"deck-modal-prev",className:"hidden size-12 rounded-full md:flex",isDisabled:0==l,onClick:s,children:(0,i.jsx)(m.default,{src:v,width:32,height:32,alt:"Profile",className:"mr-[2px] w-4 rotate-90 select-none lg:w-6"})}),(0,i.jsx)(g.ZP,{className:"relative flex h-full max-h-full min-h-0 min-w-0 max-w-full items-center overflow-hidden bg-transparent sm:rounded-lg xs:rounded-none",ignoreNativeScroll:!0,index:l,style:{background:"transparent",maxHeight:"100%",minHeight:0},children:Object.values(t.memes).map((e,l)=>{var a;return(0,i.jsx)("div",{className:"h-full max-h-full min-h-0 px-2 md:px-0",children:(0,i.jsxs)(h.w,{id:"deck-modal",classNames:{base:"max-h-full min-h-full h-full",body:"p-0"},children:[(0,i.jsx)(x.u,{children:(0,i.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-2",children:[e.creator_avatar&&(0,i.jsx)(d.default,{href:"/u/".concat(e.creator_handle),className:"flex items-center",children:(0,i.jsx)(f.z,{classNames:{base:"text-white-400/50 hover:text-white-400/75",name:"truncate"},name:e.creator_name,avatarProps:{src:e.creator_avatar,className:"w-5 h-5 text-tiny"}})}),(0,i.jsxs)("p",{className:"truncate text-sm font-normal text-white-400/50",children:[l+1," of ",Object.keys(t.memes).length]})]})}),(0,i.jsxs)(p.G,{className:"relative flex max-h-full min-h-0 flex-1 flex-row overflow-hidden",children:[(0,i.jsx)("img",{style:{zIndex:0,filter:"brightness(0.5) blur(60px)",transform:"scale(1.2)",border:0,overflow:"hidden"},className:"absolute z-0 size-full max-w-full select-none",src:e.url,alt:null===(a=e.tags)||void 0===a?void 0:a.join(", ")}),(0,i.jsx)(w.R,{prefetch:!0,draggable:!1,src:e.url,alt:"".concat(t.name," meme ").concat(l),className:"max-h-full max-w-full select-none object-contain object-center",noAnimation:!0})]})]})},l)})}),(0,i.jsx)(u.A,{isIconOnly:!0,color:"default",variant:"ghost",id:"deck-modal-next",className:"hidden size-12 rounded-full md:flex",isDisabled:l===Object.keys(t.memes).length-1,onClick:a,children:(0,i.jsx)(m.default,{src:v,width:32,height:32,alt:"Profile",className:"ml-[2px] w-4 -rotate-90 select-none lg:w-6"})})]})})},_=e=>{let{goBack:t}=e;return(0,i.jsxs)("div",{className:"flex w-full items-center justify-between xs:h-[40px] xs:px-1 sm:h-[48px] md:h-[64px] md:px-2 lg:h-[64px] lg:px-2",children:[(0,i.jsx)(u.A,{isIconOnly:!0,className:"size-fit rounded-full hover:bg-black-100 xs:mt-2 md:mt-0 lg:mt-0",variant:"light",onClick:()=>t(),children:(0,i.jsx)(m.default,{className:"opacity-85 xs:size-3.5 sm:size-4 md:size-4 lg:size-4",src:y.Z,alt:"Close"})}),(0,i.jsx)("div",{className:"size-[64px] sm:size-[48px]"})]})},C=()=>(0,i.jsx)("div",{className:"flex size-full flex-col items-center gap-3 sm:gap-1 md:gap-1 xs:gap-1",children:(0,i.jsx)(_,{goBack:()=>null})}),P=e=>{let{children:t}=e;return(0,i.jsx)("aside",{id:"modal-aside",className:"flex sm:min-w-96 max-w-full flex-1 flex-col gap-3 border-l border-white-400/10 bg-black-400 p-3 md:min-h-full md:max-w-96 md:flex-none xs:h-auto",children:t})};var I=l(39992);let S=e=>{let{handle:t,avatar:l,name:a,lastUpdated:s}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(d.default,{href:"/u/".concat(t),children:(0,i.jsx)(m.default,{src:null!=l?l:"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png",alt:null!=t?t:"Anonymous",width:48,height:48,className:"size-10 rounded-full bg-black-300"})}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,i.jsx)(d.default,{href:"/u/".concat(t),children:(0,i.jsx)("h2",{className:"text-sm font-bold",children:null!=a?a:"Anonymous"})}),(0,i.jsxs)("h3",{className:"text-xs font-medium text-white-400/75",children:["Updated ",(0,I.Po)(s)]})]})]})};var z=l(35875),L=l(93078);let A=e=>{let{id:t,saveFn:l=c.P.saveMeme,isSaved:a,variant:s="flat"}=e,[r,o]=(0,n.useState)(a),d=()=>{o(!r),l(t,r).catch(()=>{o(r)})};return(0,i.jsx)(z.e,{content:"Save to library",placement:"bottom",motionProps:{variants:{exit:{opacity:0,transition:{duration:.1,ease:"easeIn"}},enter:{opacity:1,transition:{duration:.15,ease:"easeOut"}}}},children:(0,i.jsx)(u.A,{isIconOnly:!0,size:"md",radius:"full",variant:"ghost",onClick:e=>{e.stopPropagation(),e.preventDefault(),d()},children:(0,i.jsx)(L.JO,{icon:r?"material-symbols:bookmark":"material-symbols:bookmark-outline",width:20})})})};var T=l(49955),D=l(6566),O=l(24449),R={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/checkmark.02facbc0.svg",height:46,width:46,blurWidth:0,blurHeight:0};let M=e=>{let{meme:t,isDeckCreator:l,onAccept:a,onReject:s}=e,{onOpenMeme:n}=eC();return(0,i.jsxs)("div",{className:"flex gap-3 border-b border-white-400/10 py-2",children:[(0,i.jsx)(m.default,{width:100,height:100,src:t.meme_image,alt:t.meme_id,onClick:()=>n(t.meme_id),className:"size-24 cursor-pointer rounded-lg bg-black-400 object-contain object-center"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,i.jsx)("p",{className:"truncate font-medium",children:(0,I.Po)(t.timestamp)}),(0,i.jsxs)("p",{className:"truncate text-white-400/75",children:["by ",t.creator_handle]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(u.A,{isIconOnly:!0,variant:"light",size:"sm",className:"rounded-full",onClick:()=>s(t.meme_id),children:(0,i.jsx)(m.default,{src:y.Z,width:16,height:16,alt:"Accept",className:"w-3"})}),l&&(0,i.jsx)(u.A,{isIconOnly:!0,size:"sm",className:"rounded-full",onClick:()=>a(t.meme_id),children:(0,i.jsx)(m.default,{src:R,width:16,height:16,alt:"Accept",className:"w-3"})})]})]})};var E=l(94667);let F=e=>{let{meme:t}=e,{onOpenMeme:l}=eC();return(0,i.jsxs)("div",{className:"flex cursor-pointer gap-3 border-b border-white-400/10 py-2",onClick:()=>l(t.meme_id),children:[(0,i.jsx)(m.default,{width:100,height:100,src:t.meme_image,alt:t.meme_id,className:"size-24 rounded-lg bg-black-400 object-contain object-center"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,i.jsx)("p",{className:"truncate font-medium",children:(0,I.Po)(t.timestamp)}),(0,i.jsxs)("p",{className:"truncate text-white-400/75",children:["by ",t.creator_handle]})]}),(0,i.jsx)(E.x,{})]})};var H=l(17432);(a=s||(s={})).Pending="Pending",a.Accepted="Accepted";let U=e=>{let{tab:t,badgeCount:l}=e;return(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{children:t}),l>0&&(0,i.jsx)(H.z,{size:"sm",variant:"flat",children:l})]})};var V={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/info.333102d7.svg",height:24,width:24,blurWidth:0,blurHeight:0},W=l(47177),G=l(81840);let B=e=>{let{deckId:t,deck:l,isDeckCreator:a,refetchDeck:r}=e,{startUpload:o}=(0,W.useUpload)(),[d,f]=(0,n.useState)(s.Pending),[g,v]=(0,n.useState)([]),[w,j]=(0,n.useState)(!1),[b,y]=(0,n.useState)(!1),k=g.filter(e=>"pending"===e.status),N=k.length,_=g.filter(e=>"accepted"===e.status),C=_.length,P=(0,n.useCallback)(()=>{j(!0),c.P.getDeckSubmissions(t).then(v).finally(()=>j(!1))},[t]),S=(0,n.useCallback)(e=>{c.P.updateDeckSubmission(t,e,"accepted",Object.keys(l.memes).length+1).then(()=>{r(),P()})},[t,l.memes,r,P]),L=(0,n.useCallback)(e=>{c.P.updateDeckSubmission(t,e,"rejected").then(()=>P())},[t,P]),A=(0,n.useCallback)(e=>{c.P.deleteDeckSubmission(t,e).then(()=>P())},[t,P]),R=async e=>{if(e&&0!==e.length&&!b){y(!0);for(let l=0;l<e.length;l++){let a=e[l];await o(a,t)}y(!1),P()}};return(0,n.useEffect)(()=>{P()},[P]),(0,i.jsxs)(h.w,{children:[(0,i.jsxs)(x.u,{className:"flex gap-3 pb-0 pt-3",children:[(0,i.jsx)("h3",{className:"flex-1 truncate text-lg font-semibold",children:a?"Submissions":"Submit your memes"}),(0,i.jsx)(z.e,{placement:"bottom",content:a?(0,i.jsx)("div",{className:"w-52",children:"Users can submit meme suggestions to your deck. You can either accept or reject them."}):(0,i.jsx)("div",{className:"w-52",children:"Submit your meme suggestions to the deck. They will appear in the deck once accepted by the creator."}),children:(0,i.jsx)(m.default,{src:V,width:16,height:16,alt:"Info"})})]}),(0,i.jsx)(p.G,{className:"h-96",children:(0,i.jsxs)(T.n,{fullWidth:!0,"aria-label":"Memes submissions form",variant:"bordered",selectedKey:d,onSelectionChange:e=>f(e),children:[(0,i.jsx)(D.r,{className:"flex max-h-full min-h-0 flex-1 pb-1",title:(0,i.jsx)(U,{tab:s.Pending,badgeCount:N}),children:(0,i.jsxs)("form",{className:"flex min-h-full flex-1 flex-col gap-3",children:[(0,i.jsx)(G.c,{deckId:t,isUploading:b,hasBorder:0===N,hasClick:0===N,disabled:a||b||w,setIsUploading:y,onFinish:P,children:0===N?(0,i.jsx)("div",{className:"flex flex-1 items-center justify-center",children:w||b?(0,i.jsx)(O.c,{}):(0,i.jsx)("p",{className:"text-sm text-white-400/75",children:a?"No pending submissions":"Click or drop to submit a meme"})}):(0,i.jsx)("div",{className:"max-h-full flex-1 overflow-y-auto w-full",children:k.sort((e,t)=>t.timestamp-e.timestamp).map((e,t)=>(0,i.jsx)(M,{meme:e,isDeckCreator:a,onAccept:S,onReject:a?L:A},t))})}),!a&&(0,i.jsxs)("div",{className:"relative h-10 w-full",children:[(0,i.jsx)(u.A,{color:"primary",className:"h-10 w-full",isDisabled:b,isLoading:b&&N>0,children:b&&N>0?"Uploading":"Upload"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:I.RL,className:"absolute inset-0 size-full cursor-pointer opacity-0",onChange:e=>R(e.target.files)})]})]})},s.Pending),(0,i.jsx)(D.r,{className:"flex max-h-full min-h-0 flex-1 pb-1",title:(0,i.jsx)(U,{tab:s.Accepted,badgeCount:C}),children:(0,i.jsxs)("form",{className:"flex min-h-full flex-1 flex-col gap-3",children:[(0===C||w)&&(0,i.jsx)("div",{className:"flex flex-1 items-center justify-center",children:w?(0,i.jsx)(O.c,{}):(0,i.jsx)("p",{className:"text-sm text-white-400/50",children:"No accepted submissions"})}),C>0&&!w&&(0,i.jsx)("div",{className:"max-h-full flex-1 overflow-y-auto",children:_.map((e,t)=>(0,i.jsx)(F,{meme:e},t))})]})},s.Accepted)]})})]})};var Z=l(10822),q=l(15076);let K=e=>{var t;let{deck:l,refetchDeck:a}=e,s=(0,o.useRouter)(),{profile:n}=(0,q.useProfile)();return(0,i.jsx)(P,{children:l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("header",{className:"my-2 flex flex-col gap-5",children:[(0,i.jsx)(S,{handle:l.creator_handle,name:l.creator_name,avatar:l.creator_avatar,lastUpdated:l.updated_at||l.created_at}),(0,i.jsxs)("div",{className:"ml-1 flex flex-col gap-1",children:[(0,i.jsx)("h2",{className:"text-lg font-bold text-white-400",children:l.name}),(0,i.jsx)("p",{className:"text-white-400/50",children:l.description})]}),(0,i.jsxs)("div",{className:"flex min-w-0 max-w-full flex-1 justify-between gap-2",children:[(0,i.jsx)(Z.I,{size:"md",itemId:l.id,userId:null!==(t=null==n?void 0:n.user.id)&&void 0!==t?t:"",addVoteApi:c.P.createDeckReaction,removeVoteApi:c.P.deleteDeckReaction}),l.is_creator?(0,i.jsx)(u.A,{variant:"solid",onClick:()=>{l&&s.push("/deck/edit/".concat(l.id))},children:"Edit"}):(0,i.jsx)(A,{id:l.id,isSaved:l.is_bookmarked,saveFn:c.P.bookmarkDeck})]})]}),(0,i.jsx)("section",{className:"md:flex-1"}),(0,i.jsx)("footer",{className:"flex flex-col gap-3",children:(0,i.jsx)(B,{deckId:l.id,deck:l,isDeckCreator:l.is_creator,refetchDeck:a})})]})})},J=e=>{let{deckId:t,onClose:l}=e,[a,s]=(0,n.useState)(null),r=(0,n.useMemo)(()=>{var e;return null!==(e=null==a?void 0:a.memes)&&void 0!==e?e:{}},[null==a?void 0:a.memes]),d=(0,o.useSearchParams)().get("memeIndex"),[m,u]=(0,n.useState)(d?parseInt(d):0),h=(0,n.useCallback)(e=>{e.stopPropagation(),m>=Object.keys(r).length-1||u(e=>e+1)},[m,r]),x=(0,n.useCallback)(e=>{e.stopPropagation(),0!=m&&u(e=>e-1)},[m]),f=(0,n.useCallback)(()=>{let e=decodeURIComponent(t);c.P.getDeck(e).then(s)},[t]);return(0,n.useEffect)(()=>{f()},[f]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key?null==l||l():"ArrowLeft"===e.key?x(e):"ArrowRight"===e.key&&h(e)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[l,h,x]),(0,i.jsxs)("div",{className:"flex size-full flex-1 flex-col overflow-y-auto md:flex-row",children:[a?(0,i.jsx)(N,{deck:a,currentIndex:m,onNextMeme:h,onPrevMeme:x}):(0,i.jsx)(C,{}),(0,i.jsx)(K,{deck:a,refetchDeck:f})]})},Y=e=>{let{deckId:t,onClose:l}=e;return r(),(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex size-full min-w-full max-w-full items-center justify-center overflow-y-auto bg-black-400/90 md:overflow-hidden",onClick:e=>{let t=e.target;t.closest("#deck-modal")||t.closest("#deck-modal-prev")||t.closest("#deck-modal-next")||t.closest("#modal-aside")||l()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},children:(0,i.jsx)(J,{deckId:t,onClose:l})})};var $=l(67630),X=l(40538);let Q=e=>{let{deck:t}=e;return(0,i.jsxs)(d.default,{className:"flex w-full min-w-0 items-center gap-3 pt-0",href:(0,X.bb)(t),children:[(0,i.jsx)(m.default,{alt:t.name,src:t.cover_image_url,width:40,height:40,className:"bg-white-400/5 size-10 overflow-hidden rounded-md object-cover object-center"}),(0,i.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,i.jsx)("h3",{className:"truncate text-base font-semibold",children:t.name}),(0,i.jsx)("p",{className:"text-white-400/50 truncate text-sm",children:t.description})]})]})};var ee=l(41917),et=l(6987);let el=e=>{var t;let{meme:l}=e;return(0,i.jsxs)(ee.d,{itemClasses:{subtitle:"text-sm text-white-400/50",trigger:"text-base font-semibold",indicator:"text-lg",content:"pt-0 text-small"},variant:"shadow",selectionMode:"multiple",defaultSelectedKeys:["2","3","4"],children:[l.template_data?(0,i.jsx)(et.G,{"aria-label":l.template_data.title,startContent:(0,i.jsx)(w.R,{className:"size-12 rounded-md object-cover",src:l.template_data.image_url,alt:l.template_data.title}),subtitle:l.template_data.title,classNames:{title:"font-base text-sm text-white-400/50",subtitle:"text-large font-semibold text-white-400",content:"pb-4 pt-0"},title:"Meme Template",children:(0,i.jsx)("p",{className:"text-sm",children:l.template_data.about})},"1"):(0,i.jsx)(et.G,{hideIndicator:!0,isDisabled:!0,title:"Meme template","aria-label":"No template detected",subtitle:"No template detected"},"1"),l.extracted_text?(0,i.jsx)(et.G,{title:"Extracted text",classNames:{base:"pb-2 pt-0",trigger:"pt-4 pb-2 text-base font-semibold",content:"pb-2 pt-0"},children:(0,i.jsx)("p",{className:"text-sm",children:l.extracted_text})},"2"):(0,i.jsx)(et.G,{title:"Extracted text",classNames:{base:"pb-2 pt-0",trigger:"pt-4 pb-2 text-base font-semibold",content:"pb-2 pt-0"},subtitle:"No text was extracted","aria-label":"No extracted text",hideIndicator:!0,isDisabled:!0},"2"),l.tags.length>0?(0,i.jsx)(et.G,{classNames:{content:"pb-4 pt-0"},title:"Keywords (".concat(l.tags.length,")"),children:(0,i.jsx)($.$,{tags:l.tags.map(e=>{let{name:t}=e;return t})})},"3"):(0,i.jsx)(et.G,{hideIndicator:!0,isDisabled:!0,title:"Tags","aria-label":"No tags added",subtitle:"No tags added"},"3"),l.appears_in_count>0?(0,i.jsx)(et.G,{title:"Appears in (".concat(l.appears_in_count,")"),classNames:{content:"pb-4 pt-0"},children:null===(t=l.appears_in)||void 0===t?void 0:t.map((e,t)=>(0,i.jsx)("div",{className:"".concat(t!=l.appears_in_count-1?"mb-2":""),children:(0,i.jsx)(Q,{deck:e},e.id)},t))},"4"):(0,i.jsx)(et.G,{hideIndicator:!0,isDisabled:!0,title:"Appears in","aria-label":"This meme isn't in any decks yet",subtitle:"This meme isn't in any decks yet"},"4")]})};var ea=l(27702);let es=e=>{let{prompt:t}=e;if(!t)return null;let l=t.styler.replace("ai_image_style:",""),a=t.character.replace("ai_character:","");return(0,i.jsxs)(h.w,{classNames:{base:"pb-1"},children:[(0,i.jsx)(x.u,{className:"text-lg font-semibold pb-1",children:"Generation Details"}),(0,i.jsxs)(p.G,{className:"gap-6",children:[(0,i.jsx)(ei,{title:"Positive Prompt",content:t.user_positive_prompt}),(0,i.jsx)(ei,{title:"Negative Prompt",content:t.user_negative_prompt}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsx)(ei,{title:"Style",content:l,hideCopyButton:!0}),(0,i.jsx)(ei,{title:"Character",content:a,hideCopyButton:!0}),(0,i.jsx)(ei,{title:"Aspect Ratio",content:t.aspect_ratio,hideCopyButton:!0}),(0,i.jsx)(ei,{title:"Seed",content:t.seed.toString()}),(0,i.jsx)(ei,{title:"CFG Scale",content:t.cfg_scale.toString(),hideCopyButton:!0})]})]})]})},ei=e=>{let{title:t="",content:l="",hideCopyButton:a=!1}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("p",{className:"text-xs text-white-400/50 font-medium",children:t}),(0,i.jsx)(ea.Z,{hideSymbol:!0,hideCopyButton:a||!l,classNames:{base:"bg-[#27292C] min-h-[44px]",pre:"whitespace-pre-wrap max-w-full"},children:l||(0,i.jsx)("span",{className:"text-white-400/50 select-none",children:"N/A"})})]})},en=e=>{let{meme:t}=e;if("generated"==t.source)return(0,i.jsx)(es,{prompt:t.prompt});if("composed"==t.source){var l,a;let e=Object.values(null!==(a=t.panels)&&void 0!==a?a:{}).find(e=>"meme"in e.panel_config);return e?(0,i.jsx)(es,{prompt:null===(l=e.panel_config)||void 0===l?void 0:l.prompt}):null}return(0,i.jsx)(el,{meme:t})};var er=l(40123),eo=l(21087),ec=l(58741);let ed=(0,ec.k)(c.P.tagResource,1e3),em=e=>{let{memeId:t,tags:l,onUpdateTags:a}=e,s=l.length<10?[...l,{id:"",name:""}]:l,n=async e=>{a(l.filter(t=>t.id!==e));try{await c.P.untagResource(t,e)}catch(e){a(l)}},r=async(e,s)=>{let i=s.toLowerCase().replaceAll(" ","_").replaceAll("-","_"),n=[...l];n[e]={id:i,name:s},a(n);try{var r;await ed(t,s),(null===(r=l[e])||void 0===r?void 0:r.id)&&await c.P.untagResource(t,l[e].id)}catch(e){a(l)}};return(0,i.jsx)("div",{className:"flex mb-3 gap-2 overflow-x-auto scrollbar-hide",children:s.map((e,t)=>(0,i.jsx)(eo.V,{tagId:e.id,tagName:e.name,minW:"min-w-[124px]",variant:"faded",onUpdateTag:e=>r(t,e),onDeleteTag:()=>n(e.id)},"tag-pill-".concat(e.id,"-").concat(t)))})},eu=(0,ec.k)(c.P.updateMeme,1e3),eh=e=>{var t;let{meme:l,setMeme:a,onTogglePublish:s}=e,r=(0,n.useCallback)(async e=>{l&&a({...l,tags:e})},[l,a]),o=(0,n.useCallback)(async e=>{if(l){a({...l,extracted_text:e});try{await eu(l.id,{extracted_text:e})}catch(e){a(l)}}},[l,a]);return l?(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)(er.Y,{label:(0,i.jsxs)("div",{className:"flex gap-1.5 items-center",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Extracted text"}),(0,i.jsx)(z.e,{placement:"bottom",content:(0,i.jsx)("div",{className:"w-52",children:"This is AI extracted text from the meme image. You can correct it if needed here."}),children:(0,i.jsx)(m.default,{src:V,width:19,height:19,alt:"Info"})})]}),placeholder:"This is AI extracted text from the meme image. You can correct it if needed here.",classNames:{base:"p-0 hover:outline-1 border-transparent",mainWrapper:"p-0",inputWrapper:"px-0 py-4 gap-2 bg-content1 hover:bg-content2",label:"flex px-4 text-lg !text-white-400 font-semibold",innerWrapper:"px-4",input:"text-white-400/50"},value:null!==(t=l.extracted_text)&&void 0!==t?t:"",onValueChange:o}),(0,i.jsxs)(h.w,{children:[(0,i.jsx)("header",{className:"p-4",children:(0,i.jsxs)("div",{className:"flex gap-1.5 items-center",children:[(0,i.jsx)("h3",{className:"text-base font-semibold",children:"Keywords"}),(0,i.jsx)(z.e,{placement:"bottom",content:(0,i.jsx)("div",{className:"w-52",children:"The right set of keywords can help others find your meme."}),children:(0,i.jsx)(m.default,{src:V,width:16,height:16,alt:"Info"})})]})}),(0,i.jsx)(p.G,{className:"p-4 pt-0",children:(0,i.jsx)(em,{memeId:l.id,tags:l.tags,onUpdateTags:r})})]})]}):null};var ex=l(74491),ef=l(71904);let ep=e=>{let{memeId:t,onClose:l}=e,{feed:a,setFeed:s,searchResults:r,setSearchResults:o,library:d,setLibrary:m,uploads:h,setUploads:x,saved:f,setSaved:p}=(0,ex.useFeed)(),[g,v]=(0,n.useState)(!1);return(0,i.jsx)(z.e,{content:"Delete",placement:"bottom",motionProps:{variants:{exit:{opacity:0,transition:{duration:.1,ease:"easeIn"}},enter:{opacity:1,transition:{duration:.15,ease:"easeOut"}}}},children:(0,i.jsx)(u.A,{isIconOnly:!0,size:"md",radius:"full",variant:"ghost",color:"danger",isLoading:g,onClick:()=>{v(!0),c.P.deleteMeme(t).then(()=>{s(a.filter(e=>"meme"!==e.post_type||e.post.id!==t)),o(r.filter(e=>e.id!==t)),m(d.filter(e=>e.id!==t)),x(h.filter(e=>e.id!==t)),p(f.filter(e=>e.id!==t)),l(),(0,ef.yv)("Meme deleted",{variant:"success",autoHideDuration:2e3})}).catch(()=>{v(!1),(0,ef.yv)("Failed to delete meme",{variant:"error",autoHideDuration:2e3})})},children:(0,i.jsx)(L.JO,{icon:"fluent:delete-24-regular",width:18})})})};var eg=l(17875),ev=l(81737);let ew=e=>{var t,l;let{meme:a,setMeme:s,onClose:r}=e,d=(0,o.useRouter)(),{profile:h}=(0,q.useProfile)(),{removeItemFromFeed:x,appendMemesToFeed:f}=(0,ex.useFeed)(),[p,g]=(0,n.useState)(!1),[v,w]=(0,n.useState)(!1),[j,b]=(0,n.useState)(!1),y=(0,n.useMemo)(()=>{var e;return Number(null==a?void 0:null===(e=a.posts)||void 0===e?void 0:e.length)>0},[a]),k=(0,n.useCallback)(async(e,t)=>{let l=new Date().getTime(),a={...e,published_at:l,is_public:!0};s(a),f([a],t),await c.P.publishMeme(e.id)||(s(e),x(a.id))},[f,x,s]),N=(0,n.useCallback)(async(e,t)=>{let l={...e,published_at:null,is_public:!1};s(l),x(l.id),await c.P.unpublishMeme(e.id)||(s(e),f([l],t))},[f,x,s]),_=(0,n.useCallback)(e=>{a&&h&&(e?k(a,h):N(a,h))},[a,h,k,N]),C=(0,n.useCallback)(async()=>{a&&(w(!0),await c.P.createPost({post_type:{meme:a.id}}),w(!1),h&&(f([a],h),d.push("/home")))},[f,a,h,d]),I=(0,n.useCallback)(async()=>{var e;if(!a)return;let t=null===(e=a.posts)||void 0===e?void 0:e[0];t&&(b(!0),await c.P.deletePost(t),b(!1),x(a.id),d.push("/home"))},[x,a,d]),z=(0,n.useCallback)(()=>{a&&d.push("/studio?remix=".concat(a.id))},[a,d]);return(0,i.jsx)(P,{children:a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("header",{className:"my-2 flex flex-col gap-5",children:(0,i.jsx)(S,{handle:a.creator_handle,name:a.creator_name,avatar:a.creator_avatar,lastUpdated:a.updated_at||a.published_at||a.created_at})}),p?(0,i.jsx)(eh,{meme:a,setMeme:s,onTogglePublish:_}):(0,i.jsx)(en,{meme:a}),(0,i.jsxs)("footer",{className:"flex justify-between gap-2 md:gap-3",children:[p?y?(0,i.jsx)(u.A,{variant:"solid",color:"danger",isLoading:j,onClick:I,children:"Unpublish"}):(0,i.jsx)(ep,{memeId:a.id,onClose:r}):(0,i.jsxs)("div",{className:"flex flex-1 gap-2 md:gap-3",children:[(0,i.jsx)(Z.I,{size:"md",itemId:a.id,initialVotes:a.votes,userId:null!==(t=null==h?void 0:h.user.id)&&void 0!==t?t:"",addVoteApi:c.P.createMemeReaction,removeVoteApi:c.P.deleteMemeReaction}),(0,i.jsx)(A,{id:a.id,isSaved:null!==(l=a.is_saved)&&void 0!==l&&l})]}),a.is_creator&&p&&(0,i.jsx)(u.A,{variant:"solid",color:"primary",onClick:()=>g(!1),children:"Done"}),a.is_creator&&!p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{variant:"solid",onClick:()=>g(!0),children:"Edit"}),!y&&(0,i.jsx)(u.A,{variant:"solid",color:"primary",isLoading:v,onClick:C,children:"Post"})]}),a.source&&ev.F.includes(a.source)&&!p&&y&&(0,i.jsx)(u.A,{variant:"solid",color:"primary",startContent:(0,i.jsx)(m.default,{src:eg.Z,alt:"Remix",className:"size-4"}),onClick:z,children:"Remix"})]})]})})};var ej=l(7700);let eb=e=>{var t,l,a,s,n,r,o,c,d,u;let{meme:h}=e;return(0,i.jsx)(k,{children:(0,i.jsx)("div",{className:"flex size-full max-h-full min-h-0 flex-row items-center justify-center gap-3 overflow-hidden px-0 lg:gap-6 lg:p-3",children:h&&(0,i.jsx)("div",{className:"w-full max-w-full min-h-0 max-h-full lg:w-[".concat(h.width,"px] lg:h-[").concat(h.height,"px] lg:rounded-xl border-1 border-white-400/5 bg-black-400 overflow-hidden"),children:"generated"===h.source?(0,i.jsx)(ej.g,{id:"meme-lightbox-image",imageWidth:null!==(a=h.width)&&void 0!==a?a:1024,imageHeight:null!==(s=h.height)&&void 0!==s?s:1024,canvasWidth:null!==(n=h.width)&&void 0!==n?n:1024,canvasHeight:null!==(r=h.height)&&void 0!==r?r:1024,src:h.url,alt:h.caption,topText:null!==(o=null===(t=h.text_overlay)||void 0===t?void 0:t.top_text)&&void 0!==o?o:null,bottomText:null!==(c=null===(l=h.text_overlay)||void 0===l?void 0:l.bottom_text)&&void 0!==c?c:null,centerText:null,className:"max-h-canvas"}):(0,i.jsx)("div",{id:"meme-lightbox-image",className:"size-full flex items-center justify-center",children:(0,i.jsx)(m.default,{width:null!==(d=h.width)&&void 0!==d?d:1024,height:null!==(u=h.height)&&void 0!==u?u:1024,src:h.url,alt:h.caption,className:"size-full object-contain max-h-canvas"})})})})})},ey=e=>{let{memeId:t,onClose:l}=e;r();let[a,s]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=decodeURIComponent(t);c.P.getMeme(e).then(e=>{s(e)})},[t]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&l()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[l]),(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex size-full items-center justify-center bg-black-400/90 sm:overflow-y-auto md:overflow-hidden xs:overflow-y-auto",onClick:e=>{let t=e.target;t.closest("#modal-aside")||t.closest("#meme-lightbox-image")||l()},onDragOver:e=>(e.preventDefault(),e.stopPropagation(),!1),children:(0,i.jsxs)("div",{className:"flex size-full flex-1 flex-col sm:overflow-y-auto md:flex-row",children:[(0,i.jsx)(eb,{meme:a}),(0,i.jsx)(ew,{meme:a,setMeme:s,onClose:l})]})})};var ek=l(13296);let eN=(0,n.createContext)({}),e_=e=>{var t,l;let{children:a}=e,s=(0,o.useRouter)(),n=(0,o.usePathname)(),r=(0,o.useSearchParams)(),c=decodeURIComponent(null!==(t=r.get("memeId"))&&void 0!==t?t:""),d=decodeURIComponent(null!==(l=r.get("deckId"))&&void 0!==l?l:""),m=new URLSearchParams(r.toString()),{openMemeModal:u}=(0,ek.T)(),h=()=>{m.delete("memeId");let e=(0,X.wS)(n,m);s.push(e,{scroll:!1})};return(0,i.jsxs)(eN.Provider,{value:{onOpenDeck:e=>{m.delete("memeId");let t=encodeURIComponent(e);m.set("deckId",t);let l=(0,X.wS)(n,m);s.push(l,{scroll:!1})},onOpenMeme:u,onCloseMeme:h},children:[a,c&&(0,i.jsx)(ey,{memeId:c,onClose:h}),d&&(0,i.jsx)(Y,{deckId:d,onClose:()=>{m.delete("deckId"),m.delete("memeIndex");let e=(0,X.wS)(n,m);s.push(e,{scroll:!1})}})]})},eC=()=>(0,n.useContext)(eN)},81737:function(e,t,l){var a,s;l.d(t,{F:function(){return i},L:function(){return a}});let i=["generated","composed"];(s=a||(a={})).One="one",s.TwoVertical="two-vertical",s.TwoHorizontal="two-horizontal",s.Four="four-square"},17875:function(e,t){t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/magic.8c74570a.svg",height:18,width:18,blurWidth:0,blurHeight:0}},33135:function(e,t){t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/plus.63a0d87f.svg",height:24,width:24,blurWidth:0,blurHeight:0}},69919:function(e,t){t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/xmark.ac6fe3e8.svg",height:48,width:48,blurWidth:0,blurHeight:0}}}]);