(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9650],{43939:function(e,t,a){Promise.resolve().then(a.bind(a,29655))},29655:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return e0}});var l=a(57348),i=a(16189),s=a(87840),r=a(59754),n=a(12465),o=a(15346),c=a(46371),d=a(67733),u=a(35971),m=a(55771),p=a(35878),h=a(69467),x=a(66353),f=a(55147),g=a(39543),w=a(99349),v=a(81727),b=a(73492),j=a(71046);let y=(0,o.createContext)({}),_=e=>{let{profile:t,socket:a,config:i,queryParams:s,children:r}=e,{appendMemesToFeed:_,removeItemFromFeed:N}=(0,u.useFeed)(),[k,C]=(0,o.useState)(null),[S,z]=(0,o.useState)(null),[P,A]=(0,o.useState)(null),[O,F]=(0,o.useState)(0),[I,W]=(0,o.useState)("generated"),[D,E]=(0,o.useState)(h.WV.One),[R,T]=(0,o.useReducer)(j.nv,j.ZA),[V,L]=(0,o.useState)([]),[M,H]=(0,o.useState)([]),[U,q]=(0,o.useState)(!1),[J,G]=(0,o.useState)(!1),[Y,Z]=(0,o.useState)(!1),[B,K]=(0,o.useState)(!1),[X,$]=(0,o.useState)(!1),[Q,ee]=(0,o.useState)(!1),[et,ea]=(0,o.useState)(!1),el=(0,o.useMemo)(()=>R.slice(0,d._j[D]).some(e=>"text"===e.type?""===e.text.text:"generated"!==e.type&&"faceswap"!==e.type||""===e.image.src||e.image.isGenerating),[R,D]),ei=(0,o.useMemo)(()=>R.some(e=>e.image.isGenerating),[R]),es=(0,o.useMemo)(()=>R.find(e=>e.idx===O),[R,O]),er=(0,o.useMemo)(()=>!es||"0"===es.id,[es]),en=(0,o.useCallback)(e=>{let t=null!=e?e:(0,v.uZ)();C(t);let a=new URL(window.location.href);return a.searchParams.set("meme",t.replace("meme:","")),window.history.replaceState({},"",a.toString()),t},[]),eo=(0,o.useCallback)(async(e,t,a)=>{let l=Object.entries(null!=a?a:{}).slice(0,d._j[t]),i=a?Object.fromEntries(l):void 0,s=await p.P.createComposedMeme({meme_id:e,panel_layout:t,panel_config_init:i});if(!s)throw Error("Failed to create composed meme");return s},[]),ec=(0,o.useCallback)(e=>{let t={};return"generated"===e.type?t={meme:e.image.id}:"text"===e.type?t={text:e.text.text}:"faceswap"===e.type&&(t={swapped_image:e.faceswap.swappedImage,face_image:e.faceswap.faceImage,base_image:e.faceswap.baseImage,base_width:e.faceswap.baseWidth,base_height:e.faceswap.baseHeight,strength:e.faceswap.strength}),t},[]),ed=(0,o.useCallback)(()=>{T({action:"reset",idx:O})},[O]),eu=(0,o.useCallback)(async()=>{var e,t;T({action:"update-panel",idx:O,image:{isRandomizing:!0}});let a=await m.p.getRandomPrompt();T({action:"update-panel",idx:O,image:{posPrompt:a.user_positive_prompt,negPrompt:a.user_negative_prompt,seed:(0,w.q)(),seedType:"random",topText:"",bottomText:"",guidanceScale:a.cfg_scale,selectedAspectRatio:a.aspect_ratio,selectedCharacter:null!==(e=i.characters.find(e=>e.id===a.character.replace("ai_character:","")))&&void 0!==e?e:i.characters[0],selectedStyler:null!==(t=i.stylers.find(e=>e.id===a.styler.replace("ai_image_style:","")))&&void 0!==t?t:i.stylers[0],isRandomizing:!1}})},[i.characters,i.stylers,O]),em=(0,o.useCallback)(async(e,t,a)=>{if(T({action:"update-panel",idx:e,text:{text:a}}),!k)throw Error("Failed to find composed meme id");let l=await (0,b.v2)(k,t,{panel_type:"text",panel_config:{text:a}});L(e=>{let t=e.findIndex(e=>e.id===k);if(-1===t)return e;let a={...e[t].panels,[O]:l},i={...e[t],panels:a};return[...e.slice(0,t),i,...e.slice(t+1)]})},[k,O]),ep=(0,o.useCallback)((e,t,a)=>{var l,i;if(T({action:"update-panel",idx:e,image:{[t]:a}}),!k)throw Error("Failed to find composed meme id");let s=R.find(t=>t.idx===e);if(!s)throw Error("Failed to find active panel");let r="topText"===t,n={top_text:a,bottom_text:null!==(l=s.image.bottomText)&&void 0!==l?l:""},o={top_text:null!==(i=s.image.topText)&&void 0!==i?i:"",bottom_text:a},c={top_text_size:"md",bottom_text_size:"md",additional_config:null,...r?n:o};(0,b.r_)(s.image.id,c)},[k,R]),eh=(0,o.useCallback)(async e=>{en(e.id),e.posts&&e.posts.length>0?A(e.posts[0]):A(null),E(e.panel_layout);let t=e.panels,a=[],l=(a=t&&Object.keys(t).length>0?(0,b.xe)(t,i):j.ZA)[0];F(0),"text"===l.type?W("text"):l.faceswap.baseImage||l.faceswap.faceImage?W("faceswap"):W("generated"),T({action:"blank-slate"}),a.map(e=>{let t=e.image,a=e.text,l=e.faceswap;T({idx:e.idx,id:e.id,action:"update-panel",type:e.type,image:t,text:a,faceswap:l})})},[i,en]),ex=(0,o.useCallback)(e=>{if(!k)throw Error("Failed to find composed meme id");let t=(0,d.vO)(e.width,e.height);e.panel_layout===h.WV.One&&(R[O].image.selectedAspectRatio="portrait",t=(0,d.vO)(R[O].image.width,R[O].image.height)),T({action:"update-panel",idx:O,type:"generated",image:{...e.prompt,width:e.width,height:e.height,id:e.id,src:e.url,prevSrc:e.url,selectedAspectRatio:t}}),L(a=>{var l;let i=a.findIndex(e=>e.id===k);if(-1===i)return a;let s=O.toString(),r=a[i],n={...r,panels:{...r.panels,[s]:{...null===(l=r.panels)||void 0===l?void 0:l[s],id:e.id,idx:O,panel_type:"generated",panel_config:{meme:{...e,prompt:{aspect_ratio:t}},prompt:{...e.prompt,aspect_ratio:t},text_overlay:e.text_overlay},created_at:1e6*Date.now()}}};return[...a.slice(0,i),n,...a.slice(i+1)]});let a=R[O].id;(0,b.v2)(k,a,{panel_type:"generated",panel_config:{meme:e.id}})},[O,k,R]),ef=(0,o.useCallback)(e=>{if(e===O)return;F(e);let t=R.find(t=>t.idx===e);if(!t)throw Error("Failed to find active panel");console.log("clicking pane",t),"generated"!==t.type||t.image.posPrompt?W(t.type):W("library")},[O,R]),eg=(0,o.useCallback)(e=>{W(e),T({action:"update-panel",idx:O,type:(0,x.JY)(e)})},[O]),ew=(0,o.useCallback)(async e=>{A(null),F(0),$(!0);let a=en(),l=e.panel_layout,s=e.panels;try{if(s&&l){let e=(0,b.xe)(s,i);await eo(a,l,{...Object.fromEntries(Object.entries(e).map(e=>{let[t,a]=e;return[t,{panel_type:a.type,panel_config:ec(a)}]}))})}else console.log("No panels found in meme, creating a new one"),await (0,c.P)(a,e),s=(await p.P.getMeme(a)).panels,l=h.WV.One}catch(e){throw(0,n.yv)("Failed to remix meme",{variant:"error"}),Error("Failed to init panels server side")}finally{$(!1)}let r={id:a,source:"composed",panel_layout:l,panels:s,by:t.user.id};L(e=>[r,...e]),eh(r);let o=new URL(window.location.href);o.searchParams.delete("remix"),window.history.replaceState({},"",o.toString())},[i,en,eo,eh,ec,t.user.id]),ev=(0,o.useCallback)(async e=>{if(e===D)return;E(e),F(0);let t={};if(e===h.WV.TwoVertical)t={selectedAspectRatio:"landscape"};else if(e===h.WV.TwoHorizontal)t={selectedAspectRatio:"portrait"};else if(e===h.WV.Four)t={selectedAspectRatio:"square"};else{let e=null==es?void 0:es.image.selectedAspectRatio;t={selectedAspectRatio:null!=e?e:"square"}}if(T({action:"update-panel",idx:O,image:t}),L(t=>{let a=t.findIndex(e=>e.id===k);if(-1===a)return t;let l={...t[a],panel_layout:e};return[...t.slice(0,a),l,...t.slice(a+1)]}),!k)throw Error("Failed to find composed meme id");p.P.updateComposedMemeLayout(k,{panel_layout:e})},[es,O,k,D]),eb=(0,o.useCallback)(async e=>{$(!0);let a=en(),l=await eo(a,D,{});e&&"string"==typeof e&&(l={...l,0:{...l[0],panel_config:{...l[0].panel_config,prompt:{...l[0].panel_config.prompt,character:e}}}}),T({action:"blank-slate"}),Object.values(l).map(e=>{T({action:"update-panel",idx:e.idx,id:e.id})}),L(e=>{let i={id:a,source:"composed",panel_layout:D,panels:l,by:t.user.id};return eh(i),[i,...e]}),$(!1)},[eo,eh,t.user.id,D,en]),ej=(0,o.useCallback)(async e=>{let t=i.characters.find(t=>t.id===e);if(t)console.log("Found character",t);else throw Error("Failed to find character");T({action:"update-panel",idx:0,image:{selectedCharacter:t}}),await eb(e);let a=new URL(window.location.href);a.searchParams.delete("character"),window.history.replaceState({},"",a.toString())},[i.characters,eb]),ey=(0,o.useCallback)(async e=>{let t=e.filter(e=>e.is_creator);L(t);let{remixMemeId:a,memeId:l,characterId:i}=s,r=()=>{t[0]?eh(t[0]):eb()};try{let e;let i=null!=a?a:l;if(i&&(e=t.find(e=>e.id.replace("meme:","")===i)||await p.P.getMeme(i)),!e)throw Error("Failed to find matching meme for query param");a?ew(e):l?eh(e):r()}catch(e){console.error(e),r()}i&&ej(i)},[s,eh,ej,ew,L]),e_=(0,o.useCallback)(async()=>{if(k)try{G(!0),await p.P.deleteMeme(k);let e=async()=>{let e=await p.P.getLibrary({source:["composed"],start:0,limit:1});e?ey(e):await eb()};L(t=>{let a=t.findIndex(e=>e.id===k);if(-1===a)return t;t[a+1]?eh(t[a+1]):t[a-1]?eh(t[a-1]):(T({action:"blank-slate"}),C(null),z(null),A(null),E(h.WV.One),W("generated"));let l=[...t.slice(0,a),...t.slice(a+1)];return 0===l.length&&e(),l});let t=new URL(window.location.href);t.searchParams.delete("meme"),window.history.replaceState({},"",t.toString())}catch(e){(0,n.yv)("Failed to delete meme",{variant:"error"})}finally{G(!1)}},[k,eh,eb,ey]),eN=(0,o.useCallback)(async()=>{if(P)try{Z(!0),await p.P.deletePost(P),A(null),L(e=>{let t=e.findIndex(e=>e.id===k);return -1===t?e:[...e.slice(0,t),{...e[t],posts:[]},...e.slice(t+1)]}),N(P)}catch(e){(0,n.yv)("Failed to delete post",{variant:"error"})}finally{Z(!1)}},[k,P,N]),ek=(0,o.useCallback)(async(e,a)=>{let l=a.slice(0,d._j[e]);try{K(!0),T({action:"blank-slate"}),Object.values(l).map(e=>{T({action:"update-panel",...e})});let a=en();await eo(a,e,{...Object.fromEntries(Object.entries(l).map(e=>{let[t,a]=e;return[t,{panel_type:a.type,panel_config:ec(a)}]}))}),L(l=>[{id:a,source:"composed",panel_layout:e,panels:(0,b.eZ)(R),prompt:{aspect_ratio:d.W$[e]},by:t.user.id},...l]),A(null)}catch(e){(0,n.yv)("Failed to duplicate post",{variant:"error"})}finally{K(!1)}},[eo,ec,R,t.user.id,en]),eC=(0,o.useCallback)((e,t,l,i)=>{var s;let r=R[e],n={panel_id:r.id,faceswap_strength:r.faceswap.strength,face_image:t,base_image:l,base_width:i.width,base_height:i.height},o=k;o||(console.warn("No composed meme_id in memory, generating a new one"),o=en());let c={kind:"generate_faceswap",meme_id:o,panel_index:e,panel_layout:D,data:n};console.log("Generating faceswap",c),T({idx:e,action:"update-panel",type:"faceswap",image:{isGenerating:!0,src:void 0,prevSrc:null===(s=R[e])||void 0===s?void 0:s.image.src,seed:0},text:{text:""}}),a.send(JSON.stringify(c))},[k,en,R,D,a]),eS=(0,o.useCallback)((e,l)=>{var i;let s=l.image,r="fixed"===s.seedType?s.seed:(0,w.q)(),n={workflow:"combined",quality:"fast",do_prompt_expansion:s.isExpandedPrompt,user_id:t.user.id,positive_prompt:s.posPrompt,negative_prompt:s.negPrompt,seed:r,top_text:s.topText,bottom_text:s.bottomText,aspect_ratio:D!==h.WV.One?d.W$[D]:s.selectedAspectRatio,character:s.selectedCharacter.id?{id:s.selectedCharacter.id,strength_model:1}:null,styler:{id:"photorealistic",strength_model:1},aesthetic:(null===(i=s.selectedAesthetic)||void 0===i?void 0:i.id)?s.selectedAesthetic.id:null,cfg_scale:s.guidanceScale},o=d.e5[s.selectedAspectRatio];T({idx:e,action:"update-panel",type:"generated",image:{isGenerating:!0,src:void 0,prevSrc:s.src,seed:r,width:o[0],height:o[1]},text:{text:""},faceswap:{faceImage:void 0,baseImage:void 0,strength:1}});let c=k;c||(console.warn("No composed meme_id in memory, generating a new one"),c=en());let u={kind:"generate_image",meme_id:c,data:n};console.log("sending payload",u=D!==h.WV.One?{...u,panel_index:e,panel_layout:D}:{...u,panel_index:0,panel_layout:h.WV.One}),a.send(JSON.stringify(u))},[k,t.user.id,D,en,a]),ez=(0,o.useCallback)(async()=>{if(!k)throw Error("Failed to post composed meme");try{q(!0);let e=await (0,f.jt)(R,D),a=R.find(e=>0===e.idx);if(!a)throw Error("Failed to find first panel");let{canvasWidth:l,canvasHeight:i}=(0,g.G)(D,a),s={filetype:"image/jpeg",bytes:Array.from(new Uint8Array(e)),width:l,height:i},r=await p.P.composedUpload(k,s).catch(e=>(console.error("Failed to compile composed meme",e),null));if(!r)throw Error("Failed to post composed meme");z(r.url);let n=await p.P.createPost({post_type:{meme:k}}).catch(e=>{throw console.error("Failed to post composed meme",e),e});if(!n)throw Error("Failed to post composed meme");let o={id:k,url:r.url,posts:[n.id],width:s.width,height:s.height};A(n.id),_([o],t),ea(!0)}catch(e){console.error("Failed to compile composed meme",e)}finally{q(!1)}},[_,k,R,t,D]);return(0,o.useEffect)(()=>{a.onmessage=e=>{let a=R.find(e=>e.image.isGenerating);if(!a){console.error("Failed to find generating panel");return}if("faceswap_generated"===(e=JSON.parse(e.data)).type){console.log("Faceswap generated",e);let t=e.data,l=new Uint8Array(t),i=new Blob([l],{type:"image/jpeg"}),s=new FileReader;s.onloadend=()=>{let t=s.result;T({idx:a.idx,action:"update-panel",type:"faceswap",image:{src:t,progress:100,isGenerating:!1,width:e.dimensions[0],height:e.dimensions[1],selectedAspectRatio:(0,d.vO)(e.dimensions[0],e.dimensions[1])},faceswap:{swappedImage:t,baseWidth:e.dimensions[0],baseHeight:e.dimensions[1]}});let l={id:e.id,url:t,width:e.dimensions[0],height:e.dimensions[1],created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()};L(e=>{let i=e.findIndex(e=>e.id===k);if(-1===i)return e;let s=e[i].panels,r={id:a.id,idx:a.idx,panel_type:"generated",panel_config:{meme:l,base_image:a.faceswap.baseImage,face_image:a.faceswap.faceImage,base_width:a.faceswap.baseWidth,base_height:a.faceswap.baseHeight,swapped_image:t},created_at:1e6*Date.now()},n={...s,[a.idx]:r},o={...e[i],panels:n};return[...e.slice(0,i),o,...e.slice(i+1)]})},s.readAsDataURL(i)}else if("image_generating"===e.type||"image_generating"===e.kind){let t=e.data,l=new Uint8Array(t),i=new Blob([l],{type:"image/jpeg"}),s=new FileReader;s.onloadend=()=>{let t=s.result;T({idx:a.idx,action:"update-panel",image:{src:t,progress:e.progress}})},s.readAsDataURL(i)}else if("image_generated"===e.kind||"meme_created"===e.type){let l=e.data,i=new Uint8Array(l),s=new Blob([i],{type:"image/jpeg"}),r=new FileReader;r.onloadend=()=>{var l,i;let s=e.id,n=e.prompt_config,o=r.result;if(!a)throw Error("Failed to find active panel");let c={top_text:null!==(l=a.image.topText)&&void 0!==l?l:"",bottom_text:null!==(i=a.image.bottomText)&&void 0!==i?i:"",top_text_size:"md",bottom_text_size:"md",additional_config:null},d={id:s,url:o,prompt:{...n,seed:"random"===a.image.seedType?(0,w.q)():n.seed,styler:n.styler.id,character:n.character.id,user_positive_prompt:n.positive_prompt,user_negative_prompt:n.negative_prompt},text_overlay:{...c,created_at:1e6*Date.now(),updated_at:1e6*Date.now()},created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()};if(T({idx:a.idx,action:"update-panel",type:"generated",image:{id:s,src:o,prevSrc:o,progress:100,isGenerating:!1}}),!k)throw Error("Failed to find composed meme id");L(e=>{let l=e.findIndex(e=>e.id===k);if(-1===l)return e;let i=e[l].panels,s={id:a.id,idx:a.idx,panel_type:"generated",panel_config:{meme:d,prompt:d.prompt,text_overlay:{...c,by:t.user.id,created_at:1e6*Date.now(),updated_at:1e6*Date.now()}},created_at:1e6*Date.now()},r={...i,[a.idx]:s},n={...e[l],panels:r};return[...e.slice(0,l),n,...e.slice(l+1)]})},r.readAsDataURL(s)}else"same_prompt"===e.kind&&T({idx:a.idx,action:"update-panel",image:{progress:100,src:a.image.prevSrc,isGenerating:!1}})}},[k,R,t.user.id,a]),(0,o.useEffect)(()=>{let e=localStorage.getItem("isExpandedPrompt");e&&T({action:"update-panel",idx:O,image:{isExpandedPrompt:JSON.parse(e)}})},[O,eh]),(0,l.jsx)(y.Provider,{value:{activePanelIdx:O,selectedTab:I,selectedLayout:D,activePanel:es,panels:R,history:V,library:M,postId:P,composedMemeId:k,composedMemeUrl:S,isMounting:er,isPostDisabled:el,isPosting:U,isUnpublishing:Y,isDeleting:J,isDuplicating:B,isCreatingProject:X,isHistoryOpen:Q,isPostModalOpen:et,isGenerateDisabled:ei,setLibrary:H,setHistory:L,toggleIsHistoryOpen:()=>ee(e=>!e),onClickResetPromptSettings:ed,onClickRandomPrompt:eu,onChangeTextPanel:em,onChangeTextOverlay:ep,onClosePostModal:()=>ea(!1),onClickHistory:eh,onClickLibrary:ex,onClickPane:ef,onClickTab:eg,onFetchHistory:ey,onSelectStudioLayout:ev,onClickNewProject:eb,onClickDelete:e_,onClickUnpublish:eN,onClickDuplicatePost:ek,onClickGenerate:eS,onClickFaceswap:eC,onClickPost:ez,dispatchPanelAction:T},children:r})},N=()=>{let e=(0,o.useContext)(y);if(void 0===e)throw Error("useFeed must be used within StudioProvider");return e};var k=a(53350),C=a(98224),S=a(67425),z=a(19783);let P=e=>{let{label:t,imageRef:a,isBaseImage:i=!1,initialSrc:s,setImage:r}=e,{composedMemeId:n,activePanelIdx:c,activePanel:d,dispatchPanelAction:u}=N(),m=async(e,t,a,l)=>{var s;if(!n||!d)return;let o=await p.P.faceswapUpload(n,d.id,{bytes:Array.from(e),filetype:"image/jpeg",is_face:!i}),m=null==o?void 0:o.panel_config;if(!m)return;let h=i?m.base_image:m.face_image;h&&r(h),u({idx:c,action:"update-panel",type:"faceswap",image:{src:void 0,selectedAspectRatio:i?l:d.image.selectedAspectRatio,width:i?t:m.base_width,height:i?a:m.base_height},faceswap:{faceImage:m.face_image,baseImage:m.base_image,strength:null!==(s=m.strength)&&void 0!==s?s:1,baseWidth:i?t:m.base_width,baseHeight:i?a:m.base_height}})},h=(0,o.useCallback)(async()=>{n&&d&&(await p.P.faceswapDelete(n,d.id,{is_face:!i}),r(void 0))},[d,n,i,r]);return(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("p",{className:"text-white-400 font-medium text-small",children:t}),(0,l.jsx)(z.U,{imageRef:a,initialSrc:s,onParseImage:m,onClickDeleteMeme:h})]})},A=()=>{var e,t;let{activePanel:a,activePanelIdx:i,onClickFaceswap:s,dispatchPanelAction:r}=N(),n=(0,o.useRef)(null),c=(0,o.useCallback)(e=>{r({idx:i,action:"update-panel",faceswap:{strength:e}})},[i,r]),d=(0,o.useCallback)(e=>{r({idx:i,action:"update-panel",faceswap:{faceImage:e}})},[i,r]),u=(0,o.useCallback)(e=>{r({idx:i,action:"update-panel",faceswap:{baseImage:e}})},[i,r]),m=null==a?void 0:null===(e=a.faceswap)||void 0===e?void 0:e.baseImage,p=null==a?void 0:null===(t=a.faceswap)||void 0===t?void 0:t.faceImage;return(0,l.jsxs)("div",{className:"flex size-full flex-col gap-3 justify-between",children:[(0,l.jsxs)("div",{className:"flex size-full flex-col gap-4",children:[(0,l.jsx)(P,{imageRef:n,label:"Base Image",isBaseImage:!0,initialSrc:null!=m?m:null,setImage:u},"faceswap-base-image"),(0,l.jsx)(P,{label:"Face Image",initialSrc:null!=p?p:null,setImage:d},"faceswap-face-image"),(0,l.jsx)(C.L,{size:"md",step:.01,color:"warning",label:(0,l.jsx)("p",{className:"text-white-400 font-medium text-small",children:"Faceswap Strength"}),maxValue:1,minValue:0,value:null==a?void 0:a.faceswap.strength,onChange:e=>c(e),className:"max-w-md"})]}),a&&(0,l.jsx)(S.A,{fullWidth:!0,className:"text-md h-11",variant:"shadow",color:"primary",size:"md",isLoading:a.image.isGenerating,isDisabled:!p||!m,onClick:()=>{var e,t;if(!p||!m||!n.current)return;let l={width:null===(e=n.current)||void 0===e?void 0:e.naturalWidth,height:null===(t=n.current)||void 0===t?void 0:t.naturalHeight};s(a.idx,p,m,l)},children:(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(k.JO,{icon:"tabler:replace-filled",className:"fill-orange-400 size-5"}),(0,l.jsx)("h1",{children:"Swap faces"})]})},"desktop-faceswap")]},"faceswap-controls-".concat(i))};var O=a(85432),F=a(13398),I=a(26151),W=a(46766),D=a(37734);let E=()=>{let{activePanelIdx:e,activePanel:t,isGenerateDisabled:a,onChangeTextOverlay:i,onClickGenerate:s}=N();if(!t)return null;let{topText:r,bottomText:n}=t.image;return(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)(W.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Top text",placeholder:"Add top text",value:r,onValueChange:t=>{i(e,"topText",t)},maxLength:120,isClearable:!0,onKeyDown:l=>{"Enter"!==l.key||a||(l.preventDefault(),s(e,t))}},"desktop-top-text-overlay"),(0,l.jsx)(W.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Bottom text",placeholder:"Add bottom text",value:n,onValueChange:t=>{i(e,"bottomText",t)},maxLength:120,isClearable:!0,onKeyDown:l=>{"Enter"!==l.key||a||(l.preventDefault(),s(e,t))}},"desktop-bottom-text-overlay")]})},R=e=>{let{isMobile:t=!1}=e,{activePanelIdx:a,activePanel:i,isGenerateDisabled:s,onClickGenerate:r,dispatchPanelAction:n}=N();if(!i)return null;let{negPrompt:o,seed:c,seedType:d}=i.image;return(0,l.jsxs)(O.d,{variant:"shadow",className:"border-default-200 dark:border-default-100",children:[(0,l.jsx)(F.G,{classNames:{title:"text-base",content:"pt-0 pb-4 flex flex-col gap-6"},"aria-label":"Text",title:"Text",subtitle:"Add text to your image",children:(0,l.jsx)(E,{})},"1"),(0,l.jsxs)(F.G,{classNames:{title:"text-base",content:"pt-0 pb-4 flex flex-col gap-6"},"aria-label":"Advanced",title:"Advanced",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"inline-flex flex-row gap-2 justify-between",children:[(0,l.jsx)("label",{className:"text-white-400 font-medium text-small",children:"Seed"}),(0,l.jsxs)(I.g,{children:[(0,l.jsx)(S.A,{size:"sm",className:"h-5 px-0",color:"warning",variant:"fixed"===d?"solid":"bordered",onClick:()=>{n({idx:a,action:"update-panel",image:{seedType:"fixed"}})},children:"Fixed"}),(0,l.jsx)(S.A,{size:"sm",className:"h-5 px-0",color:"warning",variant:"random"===d?"solid":"bordered",onClick:()=>{n({idx:a,action:"update-panel",image:{seed:(0,w.q)(),seedType:"random"}})},children:"Random"})]})]}),(0,l.jsx)(W.Y,{fullWidth:!0,type:"number",label:null,classNames:{input:"placeholder:text-white-400/30",inputWrapper:"!bg-black-400 rounded-lg"},value:c.toString(),onValueChange:e=>{let t=parseInt(e);isNaN(t)||n({idx:a,action:"update-panel",image:{seed:t}})}})]}),!t&&(0,l.jsx)(D.Y,{className:"px-0",classNames:{input:"placeholder:text-white-400/30",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Negative prompt",labelPlacement:"outside",placeholder:'What do you want the image NOT to look like? E.g. "no cats"',value:o,onValueChange:e=>{n({idx:a,action:"update-panel",image:{negPrompt:e}})},onKeyDown:e=>{"Enter"!==e.key||s||(e.preventDefault(),r(a,i))}},"desktop-negative-prompt")]},"2")]})},T=()=>{let{activePanelIdx:e,activePanel:t,dispatchPanelAction:a}=N();if(!t)return null;let{guidanceScale:i}=t.image;return(0,l.jsxs)("div",{className:"my-1 flex flex-col gap-2 px-0",children:[(0,l.jsx)(C.L,{size:"md",step:.1,color:"foreground",label:(0,l.jsxs)("div",{className:"flex flex-row gap-1.5 items-center",children:[(0,l.jsx)("p",{className:"text-white-400 font-medium text-small",children:"Guidance "}),(0,l.jsx)("p",{className:"text-default-500 font-normal text-tiny",children:"(cfg_scale)"})]}),showSteps:!0,maxValue:3,minValue:1.5,value:i,onChange:t=>{a({idx:e,action:"update-panel",image:{guidanceScale:t}})},className:"max-w-md"}),(0,l.jsx)("p",{className:"text-default-500 font-normal text-small",children:"How close the AI follows the prompt, lower is more creative."})]})};var V=a(86628);let L=()=>{var e;let{activePanel:t,activePanelIdx:a,dispatchPanelAction:i}=N(),{selectedAesthetic:s}=null!==(e=null==t?void 0:t.image)&&void 0!==e?e:{};return(0,l.jsx)(V.d,{selectedAesthetic:s,onSelect:e=>{i({idx:a,action:"update-panel",image:{selectedAesthetic:e}})}})};var M=a(56889);let H=()=>{var e;let{activePanel:t,activePanelIdx:a,dispatchPanelAction:i}=N(),{selectedStyler:s,selectedCharacter:r}=null!==(e=null==t?void 0:t.image)&&void 0!==e?e:{};return(0,l.jsx)(M.z,{selectedStyler:s,selectedCharacter:r,onSelect:e=>{e&&i({idx:a,action:"update-panel",image:{selectedCharacter:e}})},showClearButton:!1})};var U=a(32162),q=a(72893),J=a(85344),G=a(87140);let Y={base:(0,U.cn)("inline-flex flex-col m-0 p-2 max-w-[100%] items-center justify-center","w-full cursor-pointer rounded-lg 3 !border-medium border-default-100","data-[selected=true]:border-warning bg-black-300 hover:border-white-400/10"),label:"inline-flex flex-col items-center",labelWrapper:"m-0 gap-1 min-w-0 max-w-full",description:"truncate text-center text-white-400/90 max-w-full",wrapper:"hidden"},Z={square:"icon-park-twotone:square-small",landscape:"icon-park-twotone:rectangle-small",portrait:"icon-park-twotone:rectangle-small"},B=()=>{let{config:e}=(0,G.useDiffusionConfig)(),{activePanel:t,activePanelIdx:a,selectedLayout:i,dispatchPanelAction:s}=N();if(!e||!t)return null;let{selectedAspectRatio:r}=t.image;return i!==h.WV.One?null:(0,l.jsx)(q.X,{classNames:{wrapper:"flex-nowrap gap-2",label:"text-white-400 font-medium text-small"},defaultValue:"square",label:"Aspect Ratio",orientation:"horizontal",value:r,onValueChange:e=>{s({idx:a,action:"update-panel",image:{selectedAspectRatio:e}})},children:Object.entries(e.quality.quality).sort((e,t)=>{let[a]=e,[l]=t;return a.localeCompare(l)}).map(e=>{let[t]=e;return(0,l.jsxs)(J.J,{classNames:Y,value:t,children:[(0,l.jsx)("div",{className:"w-full flex justify-center",children:(0,l.jsx)(k.JO,{icon:Z[t],className:"portrait"===t?"rotate-90":"",width:40})}),(0,l.jsx)("p",{className:"text-sm text-white-400/90 text-center",children:t.charAt(0).toUpperCase()+t.slice(1)})]},t)})})};var K=a(98833);let X=()=>{let{activePanelIdx:e,activePanel:t,dispatchPanelAction:a}=N();if(!t)return null;let{isExpandedPrompt:i}=t.image;return(0,l.jsx)("div",{className:"flex flex-row gap-2 justify-start",children:(0,l.jsx)(K.i,{size:"sm",color:"warning",classNames:{thumb:"bg-white-400",label:"text-white-400/75"},onValueChange:t=>{a({idx:e,action:"update-panel",image:{isExpandedPrompt:t}})},isSelected:i,children:"Expand details in your prompt with AI."})})},$=()=>{let{activePanel:e,activePanelIdx:t,isGenerateDisabled:a,dispatchPanelAction:i,onClickGenerate:s}=N();if(!e)return null;let{posPrompt:r}=e.image;return(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(D.Y,{classNames:{input:"placeholder:text-white-400/25"},fullWidth:!0,label:"Prompt",endContent:(0,l.jsx)(S.A,{isIconOnly:!0,isDisabled:!r,style:{display:r?"flex":"none"},size:"sm",radius:"full",variant:"light",className:"absolute top-1 right-1",onClick:()=>{i({idx:t,action:"update-panel",image:{posPrompt:""}})},children:(0,l.jsx)(k.JO,{icon:"ic:baseline-clear",width:16,className:"text-white-400"})}),autoFocus:!0,isMultiline:!0,isRequired:!0,placeholder:"Describe the meme you want to generate",value:r,onValueChange:e=>{i({idx:t,action:"update-panel",image:{posPrompt:e}})},onKeyDown:l=>{"Enter"!==l.key||a||(l.preventDefault(),s(t,e))}},"desktop-prompt"),(0,l.jsx)(X,{})]})},Q=e=>{let{isMobile:t=!1}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(H,{}),(0,l.jsx)(L,{}),!t&&(0,l.jsx)($,{}),(0,l.jsx)(B,{}),(0,l.jsx)(T,{}),(0,l.jsx)(R,{isMobile:t})]})};var ee=a(45155),et=a(73139);let ea=()=>{let{activePanelIdx:e,activePanel:t,isGenerateDisabled:a,onClickRandomPrompt:i,onClickResetPromptSettings:s,onClickGenerate:r}=N();if(!t)return null;let{isGenerating:n,isRandomizing:o}=t.image;return(0,l.jsxs)("div",{className:"flex flex-col gap-3 p-3",children:[(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)(S.A,{className:"flex-1 text-md h-11",variant:"solid",size:"md",startContent:(0,l.jsx)(k.JO,{icon:"ic:baseline-refresh",width:20}),onClick:s,children:(0,l.jsx)("h1",{children:"Reset"})},"desktop-clear"),(0,l.jsx)(S.A,{className:"flex-1 text-md h-11",variant:"solid",size:"md",startContent:(0,l.jsx)(k.JO,{icon:"ion:dice-sharp",width:20}),isLoading:o,onClick:i,children:(0,l.jsx)("h1",{children:"Random"})},"desktop-lucky")]}),(0,l.jsx)(S.A,{fullWidth:!0,className:"text-md h-11",variant:"shadow",color:"primary",size:"md",isLoading:n,isDisabled:a,onClick:()=>{r(e,t)},children:(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[!n&&(0,l.jsx)(ee.default,{src:et.Z,alt:"Generate",className:"size-5"}),(0,l.jsx)("h1",{children:"Generate"})]})},"desktop-generate")]})};var el=a(24645),ei=a(8485),es=a(23136),er=a(5265),en=a(74859);async function eo(e,t){return p.P.getLibrary({source:["generated","upload"],...e},t)}let ec=(0,en.k)(eo,500),ed=()=>{let{activePanel:e,library:t,setLibrary:a,onClickLibrary:i}=N(),[s,r]=(0,o.useState)(!1),[n,c]=(0,o.useState)(""),{isFetching:d,hasMore:u,onReachedEnd:m,onSearch:p}=(0,er.M)({feed:t,setFeed:a,hasFetched:s,searchQuery:n,setSearchQuery:c,storeUrlParams:!1,setHasFetched:r,fetchFn:ec,fetchOnLoad:!0,pageSize:20,ignoreWindowScroll:!0}),h=(0,o.useCallback)(e=>{let{scrollLeft:t,clientWidth:a,scrollWidth:l}=e.currentTarget;t+a>=l-400&&u&&m()},[u,m]);return e?(0,l.jsxs)("div",{className:"flex size-full min-h-0 flex-col gap-3",children:[(0,l.jsx)("div",{children:(0,l.jsx)(es.T,{value:n,placeholder:"Search your library",onSearch:p})}),(0,l.jsx)("div",{className:"flex-1 w-full min-h-0 overflow-y-scroll overflow-x-hidden",onScroll:h,children:(0,l.jsx)(ei.o,{memes:t,hasFetched:s,hasSearched:n.length>0,isFetching:d,className:"overflow-hidden -mr-3",breakpoints:{default:2},renderItem:(t,a)=>(0,l.jsx)(el.Y,{meme:t,isSelected:t.id===e.image.id,onClick:()=>i(t)},"".concat(a,"-").concat(t.id))})})]}):null};var eu=a(13343);let em=()=>{let{activePanelIdx:e,selectedTab:t,onClickTab:a}=N();return(0,l.jsxs)("header",{className:"flex gap-3 p-3 items-center justify-between",children:[(0,l.jsxs)("h1",{className:"text-lg uppercase tracking-wide",children:["Panel ",e+1]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(eu.E,{content:"AI Generation",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"generated"===t?"warning":"default",onClick:()=>a("generated"),children:(0,l.jsx)(k.JO,{icon:"ph:sparkle-fill",className:"fill-orange-400 size-5"})})}),(0,l.jsx)(eu.E,{content:"Text",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"text"===t?"warning":"default",onClick:()=>a("text"),children:(0,l.jsx)(k.JO,{icon:"fluent:text-t-24-filled",className:"fill-orange-400 size-6"})})}),(0,l.jsx)(eu.E,{content:"Your Library",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"library"===t?"warning":"default",onClick:()=>a("library"),children:(0,l.jsx)(k.JO,{icon:"fluent:emoji-meme-24-regular",className:"fill-orange-400 size-5"})})}),(0,l.jsx)(eu.E,{content:"Faceswap",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsx)(S.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"faceswap"===t?"warning":"default",onClick:()=>a("faceswap"),children:(0,l.jsx)(k.JO,{icon:"tabler:replace-filled",className:"fill-orange-400 size-5"})})})]})]})},ep=()=>{let{activePanel:e,activePanelIdx:t,onChangeTextPanel:a}=N();if(!e)return null;let{text:i}=e.text;return(0,l.jsx)("div",{children:(0,l.jsx)(W.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-500 rounded-lg"},fullWidth:!0,label:"Panel text",placeholder:"Add panel text",value:i,onValueChange:l=>{a(t,e.id,l)},maxLength:120,isClearable:!0},"desktop-panel-text")})},eh=e=>{let{isMobile:t}=e,{selectedTab:a,isMounting:i}=N();return i?null:(0,l.jsxs)("section",{className:"flex flex-1 flex-col size-full",children:[(0,l.jsx)(em,{}),(0,l.jsx)("div",{className:"flex flex-1 flex-col w-full min-h-0 overflow-hidden",children:(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-4 px-3 overflow-y-auto",children:["generated"===a&&(0,l.jsx)(Q,{isMobile:t}),"text"===a&&(0,l.jsx)(ep,{}),"library"===a&&(0,l.jsx)(ed,{}),"faceswap"===a&&(0,l.jsx)(A,{})]})}),"generated"===a&&!t&&(0,l.jsx)(ea,{})]})};var ex=a(45179),ef=a(76241),eg=a(91245);let ew=()=>{let{postId:e,activePanel:t,activePanelIdx:a,isGenerateDisabled:i,dispatchPanelAction:s,onClickGenerate:r}=N();if(!t)return null;let{posPrompt:n,isGenerating:o}=t.image;return(0,l.jsxs)("div",{className:"w-full border-black-100 bg-black-400 gap-3 flex lg:hidden p-4 pb-20",children:[(0,l.jsx)(D.Y,{classNames:{base:"flex-1",input:"placeholder:text-white-400/25"},fullWidth:!0,label:"Prompt",isMultiline:!0,isRequired:!0,placeholder:"Describe the meme you want to generate",value:n,onValueChange:e=>{s({idx:a,action:"update-panel",image:{posPrompt:e}})},onKeyDown:e=>{"Enter"!==e.key||i||(e.preventDefault(),r(a,t))}},"mobile-prompt"),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)(S.A,{isIconOnly:!0,className:"text-md",variant:"solid",color:"primary",radius:"full",isLoading:o,isDisabled:i,onClick:()=>{r(a,t)},children:(0,l.jsx)(ee.default,{src:et.Z,alt:"Generate",className:"size-6"})},"mobile-generate"),!e&&(0,l.jsx)("div",{className:"flex lg:hidden flex-row items-center gap-3",children:(0,l.jsxs)(ex.j,{children:[(0,l.jsx)(ef.b,{children:(0,l.jsx)(S.A,{isIconOnly:!0,className:"flex lg:hidden",radius:"full",size:"md",variant:"flat",children:(0,l.jsx)(k.JO,{icon:"ant-design:setting-outlined",width:24})})}),(0,l.jsx)(eg.g,{className:"flex max-h-[50vh] w-[320px] justify-start gap-3 overflow-scroll lg:hidden bg-[#0F0F0F] border-1 border-black-100",children:(0,l.jsx)(eh,{isMobile:!0})})]})})]})]})};var ev=a(4930),eb=a(44394),ej=a(90252);let ey=(0,o.createContext)({}),e_=e=>{let{children:t}=e,{history:a,setHistory:i,onFetchHistory:s}=N(),[r,n]=(0,o.useState)(!1),{isFetching:c,hasMore:d,onReachedEnd:u}=(0,er.M)({feed:a,setFeed:i,hasFetched:r,setHasFetched:n,fetchFn:(e,t)=>{let{start:a,limit:l}=e;return p.P.getLibrary({source:["composed"],start:a,limit:l},t)},fetchOnLoad:!0,onFetchOnLoad:s,pageSize:0===a.length?1:20,ignoreWindowScroll:!0});return(0,l.jsx)(ey.Provider,{value:{isFetching:c,hasMore:d,onReachedEnd:u},children:t})},eN=()=>{let e=(0,o.useContext)(ey);if(void 0===e)throw Error("useFeed must be used within StudioHistoryProvider");return e};var ek=a(81254);let eC=e=>{let{meme:t,aspectRatio:a}=e,{config:i}=(0,G.useDiffusionConfig)(),s=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(async()=>{if(!i)return;let e=s.current;if(!e)return;let l=t.panels,r=t.panel_layout;if(!l||!r)return;let n=(0,b.xe)(l,i);await (0,f.mr)({canvas:e,studioPanels:n,studioLayout:r,aspectRatio:a})})()},[t,t.panels,a,i]),(0,l.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,l.jsx)("canvas",{ref:s,className:"w-full max-h-full object-contain"})})},eS=e=>{var t,a,i,s,r,n;let{meme:o}=e,c=(null===(t=o.prompt)||void 0===t?void 0:t.aspect_ratio)==="square";return"composed"===o.source?(0,l.jsx)(eC,{meme:o,aspectRatio:null===(s=o.prompt)||void 0===s?void 0:s.aspect_ratio}):o.url?(0,l.jsxs)(l.Fragment,{children:[!c&&(0,l.jsx)(ee.default,{src:o.url,width:1024,height:1024,quality:1,priority:!0,alt:"".concat(o.id," background blur"),className:"object-cover object-center blur-md absolute inset-0 z-[-1] scale-[2]"}),(0,l.jsx)(ek.g,{type:"generated",src:o.url,topText:null!==(r=null===(a=o.text_overlay)||void 0===a?void 0:a.top_text)&&void 0!==r?r:null,bottomText:null!==(n=null===(i=o.text_overlay)||void 0===i?void 0:i.bottom_text)&&void 0!==n?n:null,centerText:null,canvasHeight:o.height,canvasWidth:o.width,imageHeight:o.height,imageWidth:o.width,alt:"Generated meme ".concat(o.id)})]}):null},ez=()=>{let{composedMemeId:e,history:t,isHistoryOpen:a,onClickHistory:i}=N(),r=t.filter(e=>!e.is_saved),{isFetching:n,hasMore:c,onReachedEnd:d}=eN(),u=(0,o.useCallback)(e=>{let{clientWidth:t,scrollWidth:a,scrollLeft:l}=e;l+t>=a-400&&d()},[d]),m=(0,o.useCallback)(e=>{let{index:t}=e;return t===r.length?c?172:12:172},[c,r.length]),p=(0,o.useCallback)(t=>{let{columnIndex:a,key:s,style:o}=t;if(a===r.length)return n?(0,l.jsx)("div",{style:o,className:"flex w-full justify-center px-3",children:(0,l.jsx)(ev.c,{})},s):null;let c=r[a],d=c.id===e;return(0,l.jsx)("div",{style:o,className:"min-w-[172px] max-w-[172px] pl-3 py-3 cursor-pointer",onClick:()=>i(c),children:(0,l.jsx)("div",{className:"size-full relative bg-white-400/10 rounded-md border-2 overflow-hidden ".concat(d?"border-blue-500":"border-white-400/10"),children:(0,l.jsx)(eS,{meme:c})})},s)},[e,r,n,i]);return(0,l.jsx)(s.E.div,{initial:{bottom:-184},animate:{bottom:a?0:-184},exit:{bottom:-184},transition:{duration:.3,transitionProperty:"bottom"},className:"absolute inset-x-0 h-0 lg:h-[184px] w-full bg-black-0 border-black-100 border-t hidden lg:flex",children:(0,l.jsxs)("div",{className:"size-full flex-none flex-col gap-4 flex border-r-1 border-black-100 overflow-hidden",children:[0===r.length&&(0,l.jsx)("p",{className:"mx-3 text-white-400/50 text-sm",children:"No images generated yet"}),(0,l.jsx)("div",{className:"flex-1 min-h-0",children:(0,l.jsx)(eb.ZP,{children:e=>{let{width:t}=e;return(0,l.jsx)(ej.rj,{scrollDirection:"horizontal",className:"overflow-x-auto !overflow-y-hidden",width:t,height:184,rowCount:1,rowHeight:184,columnCount:r.length+1,columnWidth:m,overscanColumnCount:10,onScroll:u,cellRenderer:p})}})})]})})};var eP=a(2406),eA=a(30355),eO=a(58422);let eF=()=>{var e;let{composedMemeId:t,activePanelIdx:a}=N(),[i,s]=(0,o.useState)(null);if((0,o.useEffect)(()=>{t&&p.P.getMeme(t).then(e=>{s(e)})},[t]),!i)return(0,l.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,l.jsx)(ev.c,{})});let r=Object.values(null!==(e=i.panels)&&void 0!==e?e:{}).find(e=>e.idx===a),n=null==r?void 0:r.panel_config,c=null==n?void 0:n.prompt;return(0,l.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,l.jsx)("header",{className:"my-2 flex flex-col gap-5",children:(0,l.jsx)(eA.B,{handle:i.creator_handle,name:i.creator_name,avatar:i.creator_avatar,createdAt:i.created_at,publishedAt:i.published_at})}),c&&(0,l.jsx)(eO.R,{prompt:c}),(0,l.jsx)("div",{children:(0,l.jsx)(eP.I,{size:"md",itemId:i.id,initialVotes:i.votes,userId:"",readOnly:!0,addVoteApi:p.P.createMemeReaction,removeVoteApi:p.P.deleteMemeReaction})})]})},eI=()=>{let{history:e,isHistoryOpen:t,toggleIsHistoryOpen:a}=N(),{onReachedEnd:i}=eN();return(0,l.jsx)(S.A,{radius:"full",variant:"light",disableRipple:!0,className:"z-1 ".concat(t?"bg-orange-400/10":""),onClick:()=>{!t&&e.length<20&&i(e.length),a()},startContent:(0,l.jsx)(k.JO,{icon:"ic:round-history",width:20,className:t?"text-orange-400/75":"text-white-400/75"}),children:(0,l.jsx)("h2",{className:"font-medium ".concat(t?"text-orange-400":"text-white-400/75"),children:"History"})})},eW=()=>(0,l.jsx)("footer",{className:"relative flex flex-col w-full items-center justify-center",children:(0,l.jsx)("div",{className:"flex min-w-full gap-3 items-center justify-between border-b border-white-400/10 px-4 h-[66px]",children:(0,l.jsx)("div",{className:"hidden lg:block",children:(0,l.jsx)(eI,{})})})});var eD=a(37824),eE=a(13582),eR=a(15667),eT=a(21008),eV=a(1718),eL=a(88036);let eM={[h.WV.One]:{label:"One Pane",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/one-pane.2f9a7f4d.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[h.WV.TwoVertical]:{label:"Two Vertical",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/two-pane-vertical.bcad13c4.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[h.WV.TwoHorizontal]:{label:"Two Horizontal",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/two-pane-horizontal.ad349fa3.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[h.WV.Four]:{label:"Four Panes",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/four-pane.09ada0ab.svg",height:30,width:30,blurWidth:0,blurHeight:0}}},eH=()=>{let{selectedLayout:e,onSelectStudioLayout:t,isCreatingProject:a,postId:i}=N();return(0,l.jsx)(eV.g,{size:"sm",value:e,isDisabled:a||!!i,selectedKeys:[e],startContent:(0,l.jsx)(ee.default,{src:eM[e].icon,alt:eM[e].label,width:24,height:24}),classNames:{base:"min-w-20 max-w-20 sm:max-w-48",value:"hidden sm:block"},onChange:e=>t(e.target.value),"aria-label":"Panel Layout",children:Object.entries(eM).map(e=>{let[t,{label:a,icon:i}]=e;return(0,l.jsx)(eL.R,{value:t,"aria-label":a,startContent:(0,l.jsx)(ee.default,{src:i,alt:a,width:24,height:24}),classNames:{title:"hidden sm:block"},children:a},t)})})},eU=()=>{let{panels:e,selectedLayout:t,activePanel:a,postId:i,isCreatingProject:s,isPosting:r,isPostDisabled:n,isGenerateDisabled:c,isDeleting:d,isUnpublishing:u,isDuplicating:m,onClickDuplicatePost:p,onClickDelete:h,onClickUnpublish:x,onClickPost:g}=N(),w=s||d||m||r||u||c,v=(0,o.useCallback)(async()=>{let a=await (0,f.jt)(e,t),l=URL.createObjectURL(new Blob([a],{type:"image/jpeg"})),i=document.createElement("a");i.href=l,i.setAttribute("target","_blank"),i.click()},[e,t]),b=a=>{let{showLabels:s=!1}=a;return(0,l.jsxs)(l.Fragment,{children:[!i&&(0,l.jsx)(eu.E,{content:"Delete meme",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsxs)(S.A,{size:"sm",variant:"flat",className:"w-full md:w-auto backdrop-blur-sm bg-red-500/20 md:justify-center justify-start",isIconOnly:!s,color:"danger",isLoading:d,isDisabled:w,onClick:h,children:[!d&&(0,l.jsx)(k.JO,{className:"size-5 !text-red-500",icon:"mdi:delete"}),s&&(0,l.jsx)("h3",{className:"text-sm",children:"Delete"})]})}),(0,l.jsx)(eu.E,{content:"Duplicate meme",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsxs)(S.A,{size:"sm",variant:"flat",isIconOnly:!s,className:"w-full md:w-autobackdrop-blur-sm md:justify-center justify-start",isLoading:m,isDisabled:w,onClick:()=>p(t,e),children:[!m&&(0,l.jsx)(k.JO,{className:"size-5",icon:"ion:duplicate-outline"}),s&&(0,l.jsx)("h3",{className:"text-sm",children:"Duplicate"})]})}),(0,l.jsx)(eu.E,{content:"Download",delay:500,showArrow:!0,closeDelay:200,children:(0,l.jsxs)(S.A,{size:"sm",variant:"flat",color:"default",className:"w-full md:w-autobackdrop-blur-sm md:justify-center justify-start",isDisabled:n||w,isIconOnly:!s,onClick:v,children:[(0,l.jsx)(k.JO,{className:"size-5",icon:"mingcute:download-line"}),s&&(0,l.jsx)("h3",{className:"text-sm",children:"Download"})]})})]})};return a?(0,l.jsxs)("div",{className:"flex gap-2.5 items-center z-1",children:[(0,l.jsx)("div",{className:"hidden md:flex gap-2.5 items-center",children:(0,l.jsx)(b,{})}),(0,l.jsx)("div",{className:"flex md:hidden",children:(0,l.jsxs)(ex.j,{children:[(0,l.jsx)(ef.b,{children:(0,l.jsx)(S.A,{isIconOnly:!0,className:"flex lg:hidden",size:"sm",variant:"flat",children:(0,l.jsx)(k.JO,{className:"size-5",icon:"tabler:dots"})})}),(0,l.jsx)(eg.g,{className:"flex flex-col-reverse gap-3 p-3 bg-[#0F0F0F] border-1 border-black-100",children:(0,l.jsx)(b,{showLabels:!0})})]})}),(0,l.jsx)(S.A,{size:"sm",variant:"flat",isDisabled:n||w,isLoading:i?u:r,onClick:i?x:g,children:(0,l.jsx)("h3",{className:"text-sm",children:i?"Unpublish":"Publish"})})]}):null},eq=()=>{let{goBack:e}=(0,eE.useAppHistory)(),{isCreatingProject:t,onClickNewProject:a,postId:i}=N();return(0,l.jsx)("header",{className:"flex w-full flex-col justify-center gap-4 h-14 min-h-14 px-3 lg:flex-row lg:justify-between",children:(0,l.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-1 items-center text-large font-medium select-none z-[1]",children:[(0,l.jsx)(eD.O,{src:eR.Z,alt:"Close",margin:"m-0",w:"w-3",onClick:e}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(ee.default,{priority:!0,src:eT.Z,alt:"Meme Deck",className:"hidden h-8 w-auto xl:block",draggable:!1}),(0,l.jsx)("h1",{className:"text-stone-300 text-lg hidden sm:block",children:"Studio"})]})]}),(0,l.jsxs)("div",{className:"sm:absolute inset-x-0 flex justify-center z-0 gap-2",children:[(0,l.jsx)(eH,{}),(0,l.jsx)(S.A,{size:"sm",variant:"flat",color:"warning",className:"min-w-0",isLoading:t,onClick:()=>a(),startContent:!t&&(0,l.jsx)(k.JO,{className:"size-4",icon:"akar-icons:plus"}),children:(0,l.jsx)("h3",{className:"font-medium text-sm hidden xl:block",children:"New"})})]}),(0,l.jsx)(eU,{})]})})},eJ=e=>{let{children:t}=e;return(0,l.jsx)("div",{className:"container",children:(0,l.jsx)("div",{className:"square",children:t})})};var eG=a(20967);let eY=e=>{var t,a,i;let{index:r}=e,{activePanelIdx:n,panels:o,selectedLayout:c,onClickPane:u}=N(),m=o.find(e=>e.idx===r);if(!m)return console.error("Panel not found for index",r),null;let p=m.image.isGenerating,x=n===r,f=m.image,g=m.text,w=m.faceswap,v=c!==h.WV.One?d.B5[c]:1,b=d.WN[c],j=1024,y=1024;switch(c){case h.WV.One:let _=null!==(t=f.selectedAspectRatio)&&void 0!==t?t:"square",k=d.e5[_];v=(j=k[0]||1024)/(y=k[1]||1024);break;case h.WV.TwoHorizontal:v=(j=768)/(y=1024);break;case h.WV.TwoVertical:v=(j=1024)/(y=768);break;case h.WV.Four:v=(j=1024)/(y=1024)}let C=null!==(a=f.width)&&void 0!==a?a:j,S=null!==(i=f.height)&&void 0!==i?i:y;return(null==w?void 0:w.baseWidth)&&(C=w.baseWidth),(null==w?void 0:w.baseHeight)&&(S=w.baseHeight),(0,l.jsxs)("div",{style:{aspectRatio:v},className:"".concat(b," flex-1 border-3 overflow-hidden mx-auto my-0 bg-black-400 ").concat(x?"border-orange-400":"border-transparent"),onClick:()=>u(r),children:[f.isGenerating&&!f.src&&(0,l.jsx)(s.E.div,{className:"size-full flex items-center justify-center backdrop-blur-lg",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,l.jsx)(eG.X,{className:"size-full opacity-50"})}),(0,l.jsx)(s.E.div,{className:"size-full max-h-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},children:(0,l.jsx)(ek.g,{type:m.type,src:f.src,topText:f.topText,progress:p?f.progress:100,bottomText:f.bottomText,centerText:g.text,imageWidth:C,imageHeight:S,canvasHeight:y,canvasWidth:j},f.src)})]})},eZ=()=>{let{selectedLayout:e,isMounting:t}=N(),a=d._j[e];return(0,l.jsx)(eJ,{children:(0,l.jsx)("div",{className:"size-full flex items-center justify-center overflow-hidden max-h-full max-w-full min-h-0",children:t?(0,l.jsx)(ev.c,{}):(0,l.jsx)("div",{className:"max-h-full max-w-full grid ".concat(d.HS[e]),children:Array.from({length:a}).map((e,t)=>(0,l.jsx)(eY,{index:t},t))})})})},eB=()=>{let{isPostModalOpen:e,isHistoryOpen:t,postId:a,composedMemeId:i,composedMemeUrl:n,onClosePostModal:o}=N();return(0,l.jsxs)("div",{className:"fixed z-50 flex flex-row items-center justify-between h-screen overflow-y-auto dot-grid inset-x-0 min-h-screen max-h-screen t-0",children:[(0,l.jsxs)("div",{className:"relative flex flex-col flex-1 size-full min-h-0 overflow-hidden",children:[(0,l.jsx)(eq,{}),(0,l.jsx)(s.E.main,{className:"size-full relative flex justify-end flex-1 max-w-[100vw]",children:(0,l.jsx)(s.E.div,{initial:{height:"100%"},animate:{height:t?"calc(100% - 184px)":"100%"},exit:{height:"100%"},transition:{duration:.3,transitionProperty:"height"},className:"w-full lg:min-w-0",children:(0,l.jsxs)("div",{className:"flex flex-col size-full transition-all",children:[(0,l.jsx)("div",{className:"size-full min-h-0 overflow-hidden p-3 lg:px-6 lg:py-3 flex flex-row justify-center",children:(0,l.jsx)(eZ,{})}),(0,l.jsx)(eW,{}),(0,l.jsx)(ez,{}),(0,l.jsx)(ew,{})]})})}),e&&i&&n&&(0,l.jsx)(r.F,{postId:null!=a?a:void 0,memeId:i,memeUrl:n,onClose:o})]}),a?(0,l.jsx)("div",{className:"p-3 pl-0 h-full hidden lg:flex",children:(0,l.jsx)("div",{className:"p-3 rounded-2xl bg-[#0F0F0F] border-1 border-black-100 w-96 max-h-full flex-none flex-col gap-4 lg:h-full",children:(0,l.jsx)(eF,{},a)})}):(0,l.jsx)("div",{className:"p-3 pl-0 h-full hidden lg:flex",children:(0,l.jsx)("div",{className:"rounded-2xl bg-[#0F0F0F] border-1 border-black-100 w-96 max-h-full flex-none flex-col gap-4 lg:h-full",children:(0,l.jsx)(eh,{})})})]})};var eK=a(71402);let eX=()=>(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(ev.c,{size:"sm",color:"white"}),"Connecting to server"]}),e$=(0,en.D)(()=>{(0,n.yv)((0,l.jsx)(eX,{}),{key:"reconnect",variant:"warning",hideIconVariant:!0,preventDuplicate:!0,persist:!0})},1e3),eQ=()=>{let{profile:e}=(0,eK.useProfile)(),[t,a]=(0,o.useState)(null),l=(0,o.useRef)(!1),i=(0,o.useCallback)(()=>{if(!e)return;let t=new WebSocket("".concat((0,m.s)(),"/").concat(e.user.id));return t.onopen=()=>{console.log("Connected to server"),(0,n.sy)()},t.onclose=()=>{!0!==l.current&&(console.log("Disconnected from server"),setTimeout(()=>{i()},2e3),e$())},a(t),t},[e]);return(0,o.useEffect)(()=>{let e=i();return l.current=!1,()=>{e&&e.close(),l.current=!0,(0,n.sy)()}},[i]),{socket:t}};function e0(){var e,t,a;let s=(0,i.useSearchParams)(),r=null!==(e=s.get("remix"))&&void 0!==e?e:void 0,n=null!==(t=s.get("meme"))&&void 0!==t?t:void 0,o=null!==(a=s.get("character"))&&void 0!==a?a:void 0,{profile:c}=(0,eK.useProfile)(),{socket:d}=eQ(),{config:u}=(0,G.useDiffusionConfig)();return c&&d&&u&&window.localStorage?(0,l.jsx)(_,{profile:c,socket:d,config:u,queryParams:{memeId:n,remixMemeId:r,characterId:o},children:(0,l.jsx)(e_,{children:(0,l.jsx)(eB,{})})}):null}},8485:function(e,t,a){"use strict";a.d(t,{o:function(){return n}});var l=a(57348),i=a(4930),s=a(82896);let r={default:3,1100:3,700:2,500:1},n=e=>{let{memes:t,isFetching:a,hasFetched:n,hasSearched:o,noResultsMessage:c="No memes",className:d="overflow-hidden pl-3 pt-3",breakpoints:u=r,renderItem:m}=e;return(0,l.jsxs)("div",{className:d,children:[!a&&0===t.length&&(n||o)?(0,l.jsx)("div",{className:"text-white-400/75",children:c}):null,a&&0===t.length&&(0,l.jsx)("div",{className:"flex w-full justify-center p-3",children:(0,l.jsx)(i.c,{})}),(0,l.jsx)(s.Z,{breakpointCols:u,className:"my-masonry-grid min-w-full max-w-full",columnClassName:"my-masonry-grid_column",children:t.map(m)}),a&&t.length>0&&(0,l.jsx)("div",{className:"flex w-full justify-center p-3",children:(0,l.jsx)(i.c,{})})]})}},24645:function(e,t,a){"use strict";a.d(t,{Y:function(){return d}});var l=a(57348),i=a(45155),s=a(15346),r=a(18491),n=a(81254),o=a(96622),c=a(69467);let d=e=>{var t,a,d,u,m,p,h,x,f,g;let{meme:w,isSelected:v,showCreator:b=!1,onClick:j}=e,{onOpenMeme:y}=(0,o.useMemeModal)(),[_,N]=(0,s.useState)((0,c.kl)(w));return(0,l.jsx)("article",{className:"relative w-full cursor-pointer select-none overflow-hidden rounded-lg border-2 ".concat(v?"border-blue-500":"border-transparent"),onClick:()=>j?j():y(w.id),children:(0,l.jsxs)("div",{className:"group flex w-full flex-col",children:["generated"===w.source?(0,l.jsx)(n.g,{type:w.source,src:w.url,alt:w.id,canvasWidth:null!==(d=w.width)&&void 0!==d?d:1024,canvasHeight:null!==(u=w.height)&&void 0!==u?u:1024,imageWidth:null!==(m=w.width)&&void 0!==m?m:1024,imageHeight:null!==(p=w.height)&&void 0!==p?p:1024,topText:null!==(h=null===(t=w.text_overlay)||void 0===t?void 0:t.top_text)&&void 0!==h?h:null,bottomText:null!==(x=null===(a=w.text_overlay)||void 0===a?void 0:a.bottom_text)&&void 0!==x?x:null,centerText:null,className:"z-0 size-full rounded-lg bg-white-400/5 transition-transform group-hover:scale-105"}):(0,l.jsx)(i.default,{className:"z-0 size-full rounded-lg bg-white-400/5 transition-transform group-hover:scale-105",src:w.url,alt:w.id,width:null!==(f=w.width)&&void 0!==f?f:1024,height:null!==(g=w.height)&&void 0!==g?g:1024}),_&&(0,l.jsx)(r.T,{src:w.url,onClickShow:()=>N(!1)}),b&&(0,l.jsx)("div",{className:"absolute inset-0 z-0 flex select-none items-end px-1.5 py-1 opacity-0 transition-opacity hover:opacity-100",children:(0,l.jsx)("div",{className:"flex flex-1 items-center gap-2",children:(0,l.jsxs)("div",{className:"flex flex-1 items-center gap-2 truncate p-1 text-sm font-semibold drop-shadow-[0.5px_0.5px_1px_rgba(0,0,0,80)]",children:[(0,l.jsx)(i.default,{src:w.creator_avatar||"",alt:w.creator_handle||"",className:"rounded-full hover:scale-105",width:24,height:24}),w.creator_handle]})})})]})})}},23136:function(e,t,a){"use strict";a.d(t,{T:function(){return o}});var l=a(57348),i=a(46766),s=a(45155),r=a(15346),n=a(82739);let o=e=>{let{value:t,autofocus:a,initialSearch:o,placeholder:c="Search for memes. (i.e. pepe)",onFocus:d,onSearch:u}=e,m=(0,r.useRef)(null);return(0,l.jsx)(i.Y,{isClearable:!0,onClear:()=>{null==u||u("")},radius:"full",classNames:{base:"flex-1",input:"text-base placeholder:text-base placeholder:text-white-400/50"},startContent:(0,l.jsx)(s.default,{priority:!0,src:n.Z,alt:"Dropdown",onClick:e=>{var t;e.preventDefault(),null===(t=m.current)||void 0===t||t.focus()},className:"mr-1 size-5 cursor-text select-none opacity-75"}),ref:m,autoFocus:a,defaultValue:o,placeholder:c,className:"h-10 min-w-24 flex-1 rounded-full border border-white-400/5 bg-white-400/5 shadow-sm outline-none placeholder:text-xl placeholder:text-white-400/50",value:t,onFocus:d,onChange:e=>null==u?void 0:u(e.target.value)})}},5265:function(e,t,a){"use strict";a.d(t,{M:function(){return r}});var l=a(15346),i=a(74859),s=a(76808);let r=e=>{let{feed:t,setFeed:a,hasFetched:r,setHasFetched:n,searchQuery:o,setSearchQuery:c,storeUrlParams:d=!0,fetchFn:u,deckId:m,fetchOnLoad:p=!0,pageSize:h=50,ignoreWindowScroll:x=!1,onFetchOnLoad:f}=e,{initialQuery:g,initialInterval:w,initialSortBy:v}=(0,s.x)(),[b,j]=(0,l.useState)(0),[y,_]=(0,l.useState)(!0),[N,k]=(0,l.useState)(!1),[C,S]=(0,l.useState)(w),[z,P]=(0,l.useState)(v),A=(0,l.useCallback)(async(e,t)=>{let l=await u(e,t);return a(t=>l.length>0&&Number(e.start)>0?[...t,...l]:l),k(!1),n(!0),_(l.length===h),l},[u,h,a,n]),O=(0,l.useMemo)(()=>(0,i.k)(A,1e3),[A]),F=(0,l.useCallback)(async(e,t,a)=>{var l,i,s,r,c;k(!0),n(!1);let d={search:null!==(l=e.search)&&void 0!==l?l:o,start:null!==(i=e.start)&&void 0!==i?i:b,limit:null!==(s=e.limit)&&void 0!==s?s:h,interval:null!==(r=e.interval)&&void 0!==r?r:C,sort_by:null!==(c=e.sort_by)&&void 0!==c?c:z,...m?{deck_id:m}:{}};return a?A(d,t):O(d,t)},[O,m,A,h,C,o,z,n,b]),I=(0,l.useCallback)(e=>{if(!r||!y||N)return;let t=null!=e?e:b+h;j(t),F({start:t})},[r,y,N,b,h,F]),W=(0,l.useCallback)(async()=>{let e=window.innerHeight;document.body.offsetHeight-window.scrollY<3*e&&I()},[I]),D=(0,l.useCallback)((e,t,a)=>{let l=new URL(window.location.href);e.length>0?l.searchParams.set("query",e):l.searchParams.delete("query"),t?l.searchParams.set("interval",t):l.searchParams.delete("interval"),a?l.searchParams.set("sort_by",a):l.searchParams.delete("sort_by"),window.history.pushState({},"",l.toString())},[]),E=(0,l.useCallback)(async(e,t,a)=>{null==c||c(e),d&&D(e,t,a),j(0),_(!0),F({search:e,start:0,limit:h,interval:t,sort_by:a})},[F,h,c,d,D]),R=(0,l.useCallback)(e=>{a([]),S(e),E(null!=o?o:"",e,z)},[E,o,z,a]),T=(0,l.useCallback)(e=>{a([]),P(e),E("",C,e)},[E,C,a]);return(0,l.useEffect)(()=>{if(!x)return window.addEventListener("scroll",W),()=>window.removeEventListener("scroll",W)},[W,x]),(0,l.useEffect)(()=>{let e=new AbortController;if(!r&&!(t.length>0)&&p&&!N)return F({search:g,start:0,limit:h,interval:w,sort_by:v},e.signal,!0).then(f),()=>{!e.signal.aborted&&N&&e.abort()}},[t.length,F,p,r,g,w,N,f,h,v]),(0,l.useEffect)(()=>(g&&(null==c||c(g)),w&&S(w),v&&P(v),()=>{a([]),null==c||c(""),n(!1)}),[w,g,v,a,n,S,c,P]),{feed:t,setFeed:a,setHasMore:_,onSearch:E,searchInterval:C,onSelectInterval:R,searchSortBy:z,onSelectSortBy:T,isFetching:N,hasMore:y,setIsFetching:k,setHasFetched:n,onReachedEnd:I}}},76808:function(e,t,a){"use strict";a.d(t,{x:function(){return s}});var l=a(16189),i=a(41973);let s=()=>{var e,t,a;let s=(0,l.useSearchParams)();return{initialQuery:null!==(e=s.get("query"))&&void 0!==e?e:"",initialInterval:null!==(t=s.get("interval"))&&void 0!==t?t:i.u.Week,initialSortBy:null!==(a=s.get("sort_by"))&&void 0!==a?a:i.a.Hot}}},77623:function(e,t,a){"use strict";a.d(t,{T:function(){return s}});var l=a(16189),i=a(93276);let s=()=>{let e=(0,l.useRouter)(),t=(0,l.usePathname)(),a=(0,l.useSearchParams)(),s=e=>{let l=encodeURIComponent(e.replace("meme:",""));if(["/home","/trending"].includes(t))return"".concat(t,"/").concat(l);{let e=new URLSearchParams(a.toString());return e.set("memeId",l),(0,i.wS)(t,e)}};return{openMemeModal:t=>{let a=s(t);e.push(a,{scroll:!1})},getMemeModalPath:s}}},96622:function(e,t,a){"use strict";a.r(t),a.d(t,{MemeModalProvider:function(){return d},useMemeModal:function(){return u}});var l=a(57348),i=a(16189),s=a(15346),r=a(13214),n=a(77623),o=a(93276);let c=(0,s.createContext)({}),d=e=>{var t;let{children:a}=e,s=(0,i.useRouter)(),d=(0,i.usePathname)(),u=(0,i.useSearchParams)(),m=decodeURIComponent(null!==(t=u.get("memeId"))&&void 0!==t?t:""),p=new URLSearchParams(u.toString()),{openMemeModal:h}=(0,n.T)(),x=()=>{p.delete("memeId");let e=(0,o.wS)(d,p);s.push(e,{scroll:!1})};return(0,l.jsxs)(c.Provider,{value:{onOpenMeme:h,onCloseMeme:x},children:[a,m&&(0,l.jsx)(r.k,{memeId:m,onClose:x})]})},u=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useFeed must be used within MemeModalProvider");return e}},82739:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/search.3dc28276.svg",height:18,width:18,blurWidth:0,blurHeight:0}},21008:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/logo-wide.572ec4d3.svg",height:256,width:702,blurWidth:0,blurHeight:0}}},function(e){e.O(0,[7398,2221,4175,454,2872,9154,3881,7686,1133,6440,312,4822,6378,9581,1718,9394,874,9862,1649,5878,412,3214,5439,937,7114,1744],function(){return e(e.s=43939)}),_N_E=e.O()}]);