(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9650],{86599:function(e,t,l){Promise.resolve().then(l.bind(l,79409))},79409:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eU}});var a=l(59547),s=l(74600),i=l(15076),r=l(30912),n=l(60044);let o=()=>n.cm?"wss://staging-api.memedeck.xyz/v1/generation/ws":n.BB||n.j7?"wss://api.memedeck.xyz/v1/generation/ws":"ws://127.0.0.1:8080/v1/generation/ws";class c{async getConfig(){return fetch("".concat(c.BASE_URL,"/generation/config")).then(e=>e.json())}async getRandomPrompt(){return fetch("".concat(c.BASE_URL,"/generation/prompt")).then(e=>e.json())}}c.BASE_URL=n.cm?"https://staging-api.memedeck.xyz/v1":n.BB||n.j7?"https://api.memedeck.xyz/v1":"http://127.0.0.1:8080/v1";let d=new c;var u=l(71904),m=l(24449),h=l(58741);let x=()=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.c,{size:"sm",color:"white"}),"Connecting to server"]}),p=(0,h.D)(()=>{(0,u.yv)((0,a.jsx)(x,{}),{key:"reconnect",variant:"warning",hideIconVariant:!0,preventDuplicate:!0,persist:!0})},1e3),f=()=>{let{profile:e}=(0,i.useProfile)(),[t,l]=(0,r.useState)(null),[a,s]=(0,r.useState)(null),n=(0,r.useRef)(!1),c=(0,r.useCallback)(()=>{if(!e)return;let t=new WebSocket("".concat(o(),"/").concat(e.user.id));return t.onopen=()=>{console.log("Connected to server"),(0,u.sy)()},t.onclose=()=>{!0!==n.current&&(console.log("Disconnected from server"),setTimeout(()=>{c()},2e3),p())},l(t),t},[e]);return(0,r.useEffect)(()=>{d.getConfig().then(s)},[]),(0,r.useEffect)(()=>{let e=c();return n.current=!1,()=>{e&&e.close(),n.current=!0,(0,u.sy)()}},[c]),{socket:t,config:a}};var g=l(7502),v=l(1463),b=l(74491),w=l(82311),j=l(39992),y=l(81737);function _(){return Math.floor(1e12*Math.random())}var N=l(19517);let k=(0,h.k)(v.P.updateMemePanel,1e3),C=(0,h.k)(v.P.postMemeTextOverlay,1e3);function z(e){let t={},l={};return Object.entries(e).forEach(e=>{let[a,s]=e;s.panel_config&&"generated"===s.panel_type?t[Number(a)]=s.panel_config.meme:s.panel_config&&"text"===s.panel_type&&(l[Number(a)]=s.panel_config.text)}),{panelMemes:t,panelTexts:l}}let A=(0,r.createContext)({}),S=e=>{let{profile:t,socket:l,config:s,remixMemeId:i,children:n}=e,{appendMemesToFeed:o}=(0,b.useFeed)(),c=(0,r.useMemo)(()=>({posPrompt:"",negPrompt:"",isExpandedPrompt:!1,seed:_(),seedType:"random",topText:"",bottomText:"",guidanceScale:2.7,selectedAspectRatio:"square",selectedCharacter:s.characters[0],selectedStyler:s.stylers[0]}),[s.characters,s.stylers]),[m,h]=(0,r.useState)(),[x,p]=(0,r.useState)([]),[f,g]=(0,r.useState)({}),[S,L]=(0,r.useState)({}),[O,P]=(0,r.useState)(y.L.One),[E,F]=(0,r.useState)(0),[D,T]=(0,r.useState)("generate"),[M,R]=(0,r.useState)(!1),[W,H]=(0,r.useState)([]),[V,q]=(0,r.useState)(""),[I,J]=(0,r.useState)(""),[U,Z]=(0,r.useState)(!1),[B,Y]=(0,r.useState)(_()),[K,G]=(0,r.useState)("random"),[X,Q]=(0,r.useState)(""),[$,ee]=(0,r.useState)(""),[et,el]=(0,r.useState)(2.7),[ea,es]=(0,r.useState)(s.characters[0]),[ei,er]=(0,r.useState)(s.stylers[0]),[en,eo]=(0,r.useState)("square"),[ec,ed]=(0,r.useState)(),[eu,em]=(0,r.useState)(),[eh,ex]=(0,r.useState)(0),[ep,ef]=(0,r.useState)([]),[eg,ev]=(0,r.useState)(!1),[eb,ew]=(0,r.useState)(!1),[ej,ey]=(0,r.useState)(!1),[e_,eN]=(0,r.useState)(!1),[ek,eC]=(0,r.useState)(!1),[ez,eA]=(0,r.useState)(!1),[eS,eL]=(0,r.useState)(!1),[eO,eP]=(0,r.useState)(!1),[eE,eF]=(0,r.useState)(!1),[eD,eT]=(0,r.useState)(null),eM=(0,r.useMemo)(()=>!V||!ea||!ei,[V,ea,ei]),eR=(0,r.useMemo)(()=>Object.keys(f).length+Object.keys(S).length,[f,S]),eW=(0,r.useMemo)(()=>O===y.L.One&&1>Number(null==eu?void 0:eu.length)||O===y.L.TwoVertical&&eR<2||O===y.L.TwoHorizontal&&eR<2||O===y.L.Four&&eR<4,[O,null==eu?void 0:eu.length,eR]),eH=(0,r.useCallback)(()=>{q(c.posPrompt),J(c.negPrompt),Z(c.isExpandedPrompt),Y(c.seed),G(c.seedType),Q(c.topText),ee(c.bottomText),el(c.guidanceScale),eo(c.selectedAspectRatio),es(c.selectedCharacter),er(c.selectedStyler)},[c]),eV=(0,r.useCallback)(async()=>{ew(!0);let e=await d.getRandomPrompt();q(e.user_positive_prompt),J(e.user_negative_prompt),Y(_()),G("random"),Q(""),ee(""),el(e.cfg_scale),eo(e.aspect_ratio);let t=s.characters.find(t=>t.id===e.character.replace("ai_character:",""));es(null!=t?t:c.selectedCharacter);let l=s.stylers.find(t=>t.id===e.styler.replace("ai_image_style:",""));er(null!=l?l:c.selectedStyler),ew(!1)},[s.characters,s.stylers,c.selectedCharacter,c.selectedStyler]),eq=(0,r.useCallback)(()=>{Z(e=>(localStorage.setItem("isExpandedPrompt",JSON.stringify(!e)),!e))},[]),eI=(0,r.useCallback)(function(e,l){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];Q(l),g(s=>{var i,r;let n=s[e];if(!n)return s;let o={top_text:l,top_text_size:"md",bottom_text:null!==(r=null===(i=n.text_overlay)||void 0===i?void 0:i.bottom_text)&&void 0!==r?r:"",bottom_text_size:"md",additional_config:null};a&&C(n.id,o);let c={...n,text_overlay:{...o,by:t.user.id,created_at:1e3*Date.now(),updated_at:1e3*Date.now()}},d={...s};return d[e]=c,d})},[t.user.id]),eJ=(0,r.useCallback)(function(e,l){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];ee(l),g(s=>{var i,r;let n=s[e];if(!n)return s;let o={top_text:null!==(r=null===(i=n.text_overlay)||void 0===i?void 0:i.top_text)&&void 0!==r?r:"",top_text_size:"md",bottom_text:l,bottom_text_size:"md",additional_config:null};a&&C(n.id,o);let c={...n,text_overlay:{...o,by:t.user.id,created_at:1e3*Date.now(),updated_at:1e3*Date.now()}},d={...s};return d[e]=c,d})},[t.user.id]),eU=(0,r.useCallback)(async(e,t,l)=>{h(e);let a=await v.P.createComposedMeme({meme_id:e,panel_layout:t,panel_config_init:Object.fromEntries(Object.entries(l).slice(0,N._j[t]))});if(!a)throw Error("Failed to create composed meme");return p(Object.values(a)),a},[]),eZ=(0,r.useCallback)((e,t)=>{ef(l=>{let a=l.find(t=>t.id===e);if(!a)return l;let s={...a.panels};return s[E]={...s[E],...t},l.map(t=>t.id===e?{...t,panels:s}:t)})},[E]),eB=(0,r.useCallback)((e,t)=>{var l;let a=null===(l=x.find(e=>e.idx===E))||void 0===l?void 0:l.id;if(!a)throw Error("Failed to find panel id");k(e,a,t)},[x,E]),eY=(0,r.useCallback)(e=>{if(L(t=>({...t,[E]:e})),g(e=>{let t={...e};return delete t[E],t}),!m)throw Error("Failed to find composed meme id");eB(m,{panel_type:"text",panel_config:{text:e}}),eZ(m,{text:e})},[eB,m,E,eZ]),eK=(0,r.useCallback)(function(e,t,l){var a,i,r,n;let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(console.log("Loading in meme config",t,l),eI(e,null!==(a=null==l?void 0:l.top_text)&&void 0!==a?a:"",!1),eJ(e,null!==(i=null==l?void 0:l.bottom_text)&&void 0!==i?i:"",!1),t){q(null!==(r=t.user_positive_prompt)&&void 0!==r?r:""),J(null!==(n=t.user_negative_prompt)&&void 0!==n?n:""),el(t.cfg_scale),eo(t.aspect_ratio);let e=s.characters.find(e=>e.id===t.character.replace("ai_character:",""));es(null!=e?e:s.characters[0]);let l=s.stylers.find(e=>e.id===t.styler.replace("ai_image_style:",""));if(er(null!=l?l:s.stylers[0]),o)Y(t.seed),G("fixed");else{let e=new URL(window.location.href);e.searchParams.delete("remix"),window.history.replaceState({},"",e.toString())}}else q(""),J(""),el(2),eo("square")},[s.characters,s.stylers,eJ,eI]),eG=(0,r.useCallback)(async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ed(e),"composed"===e.source){var a,s;eF(Number(null===(a=e.posts)||void 0===a?void 0:a.length)>0);let t=e.panels;if(!t||Object.keys(t).length<1)throw Error("Failed to find panels in composed meme");let i=Object.values(t);p(i),h(e.id);let{panelMemes:r,panelTexts:n}=z(t);if(console.log("panelsArray",i),console.log("panelMemes",r),console.log("panelTexts",n),g(r),L(n),F(0),"generated"===t[0].panel_type){let e=null===(s=t[0].panel_config)||void 0===s?void 0:s.meme;e?em(e.url):em(void 0)}else em(void 0);P(e.panel_layout);let o=i[0];"generated"===o.panel_type?(T("generate"),eK(0,o.panel_config.prompt,o.panel_config.text_overlay,l)):T("text");return}t&&eK(0,e.prompt,e.text_overlay,l)},[eK]),eX=(0,r.useCallback)(e=>{if(em(e.url),eT(e),!m)throw Error("Failed to find composed meme id");if(eF(!1),"generated"===e.source){var t;eB(m,{panel_type:"generated",panel_config:{meme:e.id}}),g(t=>{let l={...t};return l[E]=e,l});let l=[e.width,e.height];eo((0,N.j2)(l)||(null===(t=e.prompt)||void 0===t?void 0:t.aspect_ratio)||"square")}else eB(m,{panel_type:"image",panel_config:{upload:e.id}});eZ(m,{meme:e,prompt:null,text_overlay:null})},[eB,m,E,eZ]),eQ=(0,r.useCallback)((e,t,l)=>{if(console.log("Clicking pane",e,t,l),e!==E){if(F(e),t){var a,s,i,r;g(l=>{let a={...l};return a[e]=t,a}),L(t=>{let l={...t};return delete l[e],l}),em(t.url),"image"!==D&&T("generate");let l=Object.values(x)[e];eK(e,l.panel_config.prompt,l.panel_config.text_overlay,!1),Q(null!==(i=null===(a=t.text_overlay)||void 0===a?void 0:a.top_text)&&void 0!==i?i:""),ee(null!==(r=null===(s=t.text_overlay)||void 0===s?void 0:s.bottom_text)&&void 0!==r?r:"")}else l?T("text"):(T("generate"),em(void 0),eo(N.W$[O]),eH())}},[eH,eK,O,x,E,D]),e$=(0,r.useCallback)(e=>{T(e),O===y.L.TwoVertical?eo("landscape"):O===y.L.TwoHorizontal?eo("portrait"):O===y.L.Four&&eo("square")},[O]),e0=(0,r.useCallback)(async e=>{console.log("Loading in remix",e);let t=ep.find(t=>t.id===e);if(t)console.log("Found meme from history",t),eG(t,!0,!0);else{console.log("Fetching meme from server",e);let t=await v.P.getMeme(e);t&&eG(t,!0,!0)}},[ep,eG]),e1=(0,r.useCallback)(async e=>{if(e!==O){if(P(e),F(0),e===y.L.TwoVertical)eo("landscape");else if(e===y.L.TwoHorizontal)eo("portrait");else if(e===y.L.Four){if(x.length<4){let e=await v.P.createComposedMeme({meme_id:m,panel_layout:y.L.Four});if(!e)throw Error("Failed to create composed meme");p(Object.values(e))}eo("square")}else{var t,l;let e=null==ec?void 0:null===(t=ec.panels[E])||void 0===t?void 0:t.panel_config;e&&eo((null===(l=e.prompt)||void 0===l?void 0:l.aspect_ratio)||"square"),T("generate")}if(m)v.P.updateComposedMemeLayout(m,{panel_layout:e});else{R(!0);let t=ec?{0:ec}:{};g(t),await eU((0,j.uZ)(),e,{...Object.fromEntries(Object.entries(t).map(e=>{let[t,l]=e;return[t,{meme:l.id}]}))}),R(!1)}}},[O,m,x.length,ec,E,eU]),e4=(0,r.useCallback)(async()=>{F(0),em(void 0),eH(),eT(null),T("generate"),eF(!1),g({}),L({}),p([]);let e=(0,j.uZ)();ef(l=>[{id:e,source:"composed",panel_layout:O,panels:{},by:t.user.id},...l]),ed({id:e}),R(!0),await eU(e,O,{}),R(!1)},[eU,eH,O,t.user.id]),e2=(0,r.useCallback)(async()=>{if(ex(0),ec)try{eN(!0),await v.P.deleteMeme(ec.id),ef(e=>{let t=e.findIndex(e=>e.id===ec.id);return -1===t?e:(e[t+1]?eG(e[t+1]):e[t-1]&&eG(e[t-1]),[...e.slice(0,t),...e.slice(t+1)])})}catch(e){(0,u.yv)("Failed to delete meme",{variant:"error"})}finally{eN(!1)}},[ec,eG]),e3=(0,r.useCallback)(async()=>{var e;if(ex(0),!ec)return;let t=null===(e=ec.posts)||void 0===e?void 0:e[0];if(t)try{eC(!0),await v.P.deletePost(t);let e={...ec,posts:[]};ef(t=>{let l=t.findIndex(e=>e.id===ec.id);return -1===l?t:[...t.slice(0,l),e,...t.slice(l+1)]}),ed(e),eF(!1)}catch(e){(0,u.yv)("Failed to delete post",{variant:"error"})}finally{eC(!1)}},[ec]),e5=(0,r.useCallback)(async()=>{if(ec)try{eA(!0);let e=(0,j.uZ)();await eU(e,O,{...Object.fromEntries(Object.entries(f).map(e=>{let[t,l]=e;return[t,{meme:l.id}]}))}),ed({id:e}),g({...f}),ef(l=>[{id:e,source:"composed",panel_layout:O,panels:{},by:t.user.id},...l]),eF(!1)}catch(e){(0,u.yv)("Failed to duplicate post",{variant:"error"})}finally{eA(!1)}},[eU,ec,O,f,t.user.id]),e7=(0,r.useCallback)(()=>{let e=new URL(window.location.href);e.searchParams.delete("remix"),window.history.replaceState({},"",e.toString());let a={workflow:"combined",quality:"fast",do_prompt_expansion:U,user_id:t.user.id,positive_prompt:V||"",negative_prompt:I||"",seed:B||0,top_text:X||"",bottom_text:$||"",aspect_ratio:O!==y.L.One?N.W$[O]:en,character:(null==ea?void 0:ea.id)?{id:null==ea?void 0:ea.id,strength_model:1}:null,styler:(null==ei?void 0:ei.id)?{id:null==ei?void 0:ei.id,strength_model:1}:null,cfg_scale:et};ev(!0),em(void 0);let s=m;s||(console.warn("No composed meme_id in memory, generating a new one"),h(s=(0,j.uZ)()));let i={kind:"generate_image",meme_id:s,panel_index:0,panel_layout:y.L.One,data:a};O!==y.L.One&&(i={...i,meme_id:s,panel_index:E,panel_layout:O}),console.log("sending payload",i),l.send(JSON.stringify(i))},[$,m,et,U,I,O,V,t.user.id,B,en,null==ea?void 0:ea.id,E,null==ei?void 0:ei.id,l,X]),e9=(0,r.useCallback)(async()=>{if(!ec||Object.keys(f).length<1&&Object.keys(S).length<1)throw Error("Failed to post meme");eL(!0);try{if(!m)throw Error("Failed to post composed meme");console.log("Compiling meme",f,S,O);let e=await (0,w.jt)(f,S,O),l={filetype:"image/jpeg",bytes:Array.from(new Uint8Array(e)),...O===y.L.One?{width:f[0].width,height:f[0].height}:(0,w.sU)(O)},a=await v.P.composedUpload(m,l).catch(e=>(console.error("Failed to compile composed meme",e),null));if(!a)throw Error("Failed to post composed meme");let s=await v.P.createPost({post_type:{meme:m}}).catch(e=>{throw console.error("Failed to post composed meme",e),e});if(!s)throw Error("Failed to post composed meme");a={...a,posts:[s.id]},ed(a),o([a],t),eP(!0),eF(!0)}catch(e){console.error("Failed to compile composed meme",e)}finally{eL(!1)}},[o,m,ec,O,f,S,t]);return(0,r.useEffect)(()=>{l.onmessage=e=>{if("image_generating"===(e=JSON.parse(e.data)).type||"image_generating"===e.kind){let t=e.data,l=new Uint8Array(t),a=new Blob([l],{type:"image/jpeg"}),s=new FileReader;s.onloadend=()=>{em(s.result),ex(e.progress)},s.readAsDataURL(a)}else if("image_generated"===e.kind||"meme_created"===e.type){let l=e.data,a=new Uint8Array(l),s=new Blob([a],{type:"image/jpeg"}),i=new FileReader;i.onloadend=()=>{let l=e.id,a=e.prompt_config,s=i.result;em(s),ex(100),ev(!1);let r={top_text:X,bottom_text:$,top_text_size:"md",bottom_text_size:"md",additional_config:null};(X||$)&&v.P.postMemeTextOverlay(l,r);let n={id:l,url:s,prompt:{...a,styler:a.styler.id,character:a.character.id,user_positive_prompt:a.positive_prompt,user_negative_prompt:a.negative_prompt},text_overlay:{...r,by:t.user.id,created_at:1e6*Date.now(),updated_at:1e6*Date.now()},created_at:1e6*Date.now(),updated_at:1e6*Date.now(),published_at:1e6*Date.now()};"random"===K&&Y(_()),ef(e=>{if(!m)throw Error("Failed to find composed meme id");let l=e.findIndex(e=>e.id===m);return -1===l||eZ(m,{meme:{...e[l],panels:{...e[l].panels,[E]:n}},prompt:a,text_overlay:{...r,by:t.user.id,created_at:1e6*Date.now(),updated_at:1e6*Date.now()}}),e}),g({...f,[E]:n})},i.readAsDataURL(s)}else"same_prompt"===e.kind&&(em(null==ec?void 0:ec.url),ev(!1))}},[$,m,ep,null==ec?void 0:ec.id,null==ec?void 0:ec.url,eG,f,t.user.id,K,E,l,X,eZ]),(0,r.useEffect)(()=>{let e=localStorage.getItem("isExpandedPrompt");e&&Z(JSON.parse(e)),v.P.getLibrary({source:["composed"],start:0,limit:1}).then(e=>{let t=e[0];t&&t.panels&&eG(t,!0)})},[eG]),(0,a.jsx)(A.Provider,{value:{config:s,posPrompt:V,negPrompt:I,isExpandedPrompt:U,seed:B,seedType:K,topText:X,bottomText:$,guidanceScale:et,selectedAspectRatio:en,selectedCharacter:ea,selectedStyler:ei,isGenerating:eg,isRandomizing:eb,isHistoryOpen:ej,isDeletingMeme:e_,isDeletingPost:ek,isDuplicatingPost:ez,isPosting:eS,isPostModalOpen:eO,isGenerateDisabled:eM,isPostDisabled:eW,isMemePosted:eE,isCreatingProject:M,history:ep,srcPreview:eu,progress:eh,meme:ec,selectedLibraryMeme:eD,remixMemeId:i,panelMemes:f,panelTexts:S,panelLayout:O,selectedPane:E,tab:D,genLibrary:W,setPosPrompt:q,setNegPrompt:J,toggleIsExpandedPrompt:eq,setSeed:Y,setSeedType:G,onChangeTopText:eI,onChangeBottomText:eJ,setGuidanceScale:el,setSelectedAspectRatio:eo,setSelectedCharacter:es,setSelectedStyler:er,setHistory:ef,setIsHistoryOpen:ey,setIsPostModalOpen:eP,setSrcPreview:em,setGenLibrary:H,setSelectedLibraryMeme:eT,onClickLibrary:eX,onChangeTextPanel:eY,onLoadInRemix:e0,onClickTab:e$,onClickPanelLayout:e1,onClickNewProject:e4,onClickResetPromptSettings:eH,onClickRandomPrompt:eV,onClickHistory:eG,onClickPane:eQ,onClickGenerate:e7,onClickDeletePost:e3,onClickDeleteMeme:e2,onClickDuplicatePost:e5,onClickPost:e9},children:n})},L=()=>(0,r.useContext)(A);var O=l(92519),P=l(67887),E=l(81926);let F=()=>{let{config:e,selectedStyler:t,selectedCharacter:l,setSelectedCharacter:s}=L(),i=(0,r.useMemo)(()=>e.characters,[e.characters]),n=(0,r.useMemo)(()=>null==l?void 0:l.id,[l]),o=(0,r.useMemo)(()=>null==t?void 0:t.id,[t]),c=(0,r.useMemo)(()=>i.map(e=>({...e,avatar:function(e,t){if("normal"===t)return;let l=e.replace(/[_\s]/g,"-"),a=t.replace(/[_\s]/g,"-");return"https://memedeckblob.blob.core.windows.net/ai-characters/".concat(l,"-").concat(a,".png")}(null!=o?o:"",e.id)})).sort((e,t)=>"normal"===e.id?1:"normal"===t.id?-1:0),[i,o]),d=(0,r.useCallback)(e=>{let t=i.find(t=>t.id===e);t&&s(t)},[i,s]);return(0,a.jsx)(O.g,{items:c,placeholder:"Select a character","aria-label":"Character",classNames:{trigger:"h-[80px]",listbox:"h-fit"},selectedKeys:[n],onChange:e=>d(e.target.value),renderValue:e=>e.map(e=>{var t,l,s;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(P.h,{alt:(null===(t=e.data)||void 0===t?void 0:t.id)+"-avatar",className:"shrink-0 mr-2",radius:"sm",size:"lg",src:null===(l=e.data)||void 0===l?void 0:l.avatar}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-tiny text-default-600",children:"Character"}),(0,a.jsx)("h3",{className:"text-xl font-semibold",children:null===(s=e.data)||void 0===s?void 0:s.name})]})]},e.key)}),children:e=>(0,a.jsx)(E.R,{textValue:null==e?void 0:e.name,"aria-label":null==e?void 0:e.name,children:(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(P.h,{alt:(null==e?void 0:e.id)+"-avatar",className:"shrink-0 mr-2",radius:"sm",size:"lg",src:null==e?void 0:e.avatar}),(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("span",{className:"text-md",children:null==e?void 0:e.name})})]})},null==e?void 0:e.id)})};var D=l(93078),T=l(40123),M=l(82972),R=l(54897);let W=()=>{let{isExpandedPrompt:e,toggleIsExpandedPrompt:t}=L();return(0,a.jsx)("div",{className:"flex flex-row gap-2 justify-start",children:(0,a.jsx)(R.i,{size:"sm",color:"warning",classNames:{thumb:"bg-white-400",label:"text-white-400/75"},onValueChange:t,isSelected:e,children:"Expand details in your prompt with AI."})})},H=()=>{let{posPrompt:e,isGenerateDisabled:t,setPosPrompt:l,onClickGenerate:s}=L();return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(T.Y,{classNames:{input:"placeholder:text-white-400/25"},fullWidth:!0,label:"Prompt",endContent:(0,a.jsx)(M.A,{isIconOnly:!0,isDisabled:!e,style:{display:e?"flex":"none"},size:"sm",radius:"full",variant:"light",className:"absolute top-1 right-1",onClick:()=>l(""),children:(0,a.jsx)(D.JO,{icon:"ic:baseline-clear",width:16,className:"text-white-400"})}),autoFocus:!0,isMultiline:!0,isRequired:!0,placeholder:"Describe the meme you want to generate",value:e,onValueChange:l,onKeyDown:e=>{"Enter"!==e.key||t||(e.preventDefault(),s())}},"desktop-prompt"),(0,a.jsx)(W,{})]})};var V=l(94925),q=l(74948),I=l(74653);let J={base:(0,V.cn)("inline-flex flex-col m-0 p-2 max-w-[100%] items-center justify-center","w-full cursor-pointer rounded-lg 3 !border-medium border-default-100","data-[selected=true]:border-warning bg-black-300 hover:border-white-400/10"),label:"inline-flex flex-col items-center",labelWrapper:"m-0 gap-1 min-w-0 max-w-full",description:"truncate text-center text-white-400/90 max-w-full",wrapper:"hidden"},U={square:"icon-park-twotone:square-small",landscape:"icon-park-twotone:rectangle-small",portrait:"icon-park-twotone:rectangle-small"},Z=()=>{let{config:e,panelLayout:t,selectedAspectRatio:l,setSelectedAspectRatio:s}=L();return t!==y.L.One?null:(0,a.jsx)(q.X,{classNames:{wrapper:"flex-nowrap gap-2",label:"text-white-400 font-medium text-small"},defaultValue:"square",label:"Aspect Ratio",orientation:"horizontal",value:l,onValueChange:e=>s(e),children:Object.entries(e.quality.quality).sort((e,t)=>{let[l]=e,[a]=t;return l.localeCompare(a)}).map(e=>{let[t]=e;return(0,a.jsxs)(I.J,{classNames:J,value:t,children:[(0,a.jsx)("div",{className:"w-full flex justify-center",children:(0,a.jsx)(D.JO,{icon:U[t],className:"portrait"===t?"rotate-90":"",width:40})}),(0,a.jsx)("p",{className:"text-sm text-white-400/90 text-center",children:t.charAt(0).toUpperCase()+t.slice(1)})]},t)})})},B=()=>{let{config:e,selectedStyler:t,setSelectedStyler:l}=L(),s=(0,r.useCallback)(t=>{let a=e.stylers.find(e=>e.id===t);a&&l(a)},[e.stylers,l]);return(0,a.jsx)(O.g,{"aria-label":"styler selector",label:"Style",placeholder:"No additional styler",selectedKeys:t?[t.id]:[],size:"md",onChange:e=>s(e.target.value),children:e.stylers.map(e=>(0,a.jsx)(E.R,{"aria-label":e.name,className:"flex flex-row items-center gap-2",children:e.name},e.id))})};var Y=l(41917),K=l(6987),G=l(54939),X=l(99854);let Q=()=>{let{selectedPane:e,topText:t,bottomText:l,isGenerateDisabled:s,onChangeTopText:i,onChangeBottomText:r,onClickGenerate:n}=L();return(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(X.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Top text",placeholder:"Add top text",value:t,onValueChange:t=>i(e,t),maxLength:120,isClearable:!0,onKeyDown:e=>{"Enter"!==e.key||s||(e.preventDefault(),n())}},"desktop-top-text-overlay"),(0,a.jsx)(X.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Bottom text",placeholder:"Add bottom text",value:l,onValueChange:t=>r(e,t),maxLength:120,isClearable:!0,onKeyDown:e=>{"Enter"!==e.key||s||(e.preventDefault(),n())}},"desktop-bottom-text-overlay")]})},$=e=>{let{isMobile:t=!1}=e,{negPrompt:l,seed:s,seedType:i,isGenerateDisabled:r,setNegPrompt:n,setSeed:o,setSeedType:c,onClickGenerate:d}=L();return(0,a.jsxs)(Y.d,{variant:"shadow",className:"border-default-200 dark:border-default-100",children:[(0,a.jsx)(K.G,{classNames:{title:"text-base",content:"pt-0 pb-4 flex flex-col gap-6"},"aria-label":"Text",title:"Text",subtitle:"Add text to your image",children:(0,a.jsx)(Q,{})},"1"),(0,a.jsxs)(K.G,{classNames:{title:"text-base",content:"pt-0 pb-4 flex flex-col gap-6"},"aria-label":"Advanced",title:"Advanced",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"inline-flex flex-row gap-2 justify-between",children:[(0,a.jsx)("label",{className:"text-white-400 font-medium text-small",children:"Seed"}),(0,a.jsxs)(G.g,{children:[(0,a.jsx)(M.A,{size:"sm",className:"h-5 px-0",color:"warning",variant:"fixed"===i?"solid":"bordered",onClick:()=>c("fixed"),children:"Fixed"}),(0,a.jsx)(M.A,{size:"sm",className:"h-5 px-0",color:"warning",variant:"random"===i?"solid":"bordered",onClick:()=>{o(_()),c("random")},children:"Random"})]})]}),(0,a.jsx)(X.Y,{fullWidth:!0,type:"number",label:null,classNames:{input:"placeholder:text-white-400/30",inputWrapper:"!bg-black-400 rounded-lg"},value:s.toString(),onValueChange:e=>{let t=parseInt(e);isNaN(t)||o(t)}})]}),!t&&(0,a.jsx)(T.Y,{className:"px-0",classNames:{input:"placeholder:text-white-400/30",inputWrapper:"!bg-black-400 rounded-lg"},fullWidth:!0,label:"Negative prompt",labelPlacement:"outside",placeholder:'What do you want the image NOT to look like? E.g. "no cats"',value:l,onValueChange:n,onKeyDown:e=>{"Enter"!==e.key||r||(e.preventDefault(),d())}},"desktop-negative-prompt")]},"2")]})};var ee=l(41175);let et=()=>{let{guidanceScale:e,setGuidanceScale:t}=L();return(0,a.jsxs)("div",{className:"my-1 flex flex-col gap-2 px-0",children:[(0,a.jsx)(ee.L,{size:"md",step:.1,color:"foreground",label:(0,a.jsxs)("div",{className:"flex flex-row gap-1.5 items-center",children:[(0,a.jsx)("p",{className:"text-white-400 font-medium text-small",children:"Guidance "}),(0,a.jsx)("p",{className:"text-default-500 font-normal text-tiny",children:"(cfg_scale)"})]}),showSteps:!0,maxValue:3,minValue:1.5,value:e,onChange:e=>t(e),className:"max-w-md"}),(0,a.jsx)("p",{className:"text-default-500 font-normal text-small",children:"How close the AI follows the prompt, lower is more creative."})]})},el=e=>{let{isMobile:t=!1}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F,{}),(0,a.jsx)(B,{}),!t&&(0,a.jsx)(H,{}),(0,a.jsx)(Z,{}),(0,a.jsx)(et,{}),(0,a.jsx)($,{isMobile:t})]})},ea=()=>{let{selectedPane:e,tab:t,onClickTab:l}=L();return(0,a.jsxs)("header",{className:"flex gap-3 items-center justify-between",children:[(0,a.jsxs)("h1",{className:"text-lg uppercase tracking-wide",children:["Panel ",e+1]}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(M.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"generate"===t?"warning":"default",onClick:()=>l("generate"),children:(0,a.jsx)(D.JO,{icon:"ph:sparkle-fill",className:"fill-orange-400 size-5"})}),(0,a.jsx)(M.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"text"===t?"warning":"default",onClick:()=>l("text"),children:(0,a.jsx)(D.JO,{icon:"fluent:text-t-24-filled",className:"fill-orange-400 size-6"})}),(0,a.jsx)(M.A,{size:"sm",isIconOnly:!0,variant:"flat",color:"image"===t?"warning":"default",onClick:()=>l("image"),children:(0,a.jsx)(D.JO,{icon:"fluent:emoji-meme-24-regular",className:"fill-orange-400 size-5"})})]})]})},es=()=>{let{selectedPane:e,panelTexts:t,onChangeTextPanel:l}=L(),s=t[e];return(0,a.jsx)("div",{children:(0,a.jsx)(X.Y,{classNames:{input:"placeholder:text-white-400/25",inputWrapper:"!bg-black-500 rounded-lg"},fullWidth:!0,label:"Panel text",placeholder:"Add panel text",value:s,onValueChange:l,maxLength:120,isClearable:!0},"desktop-panel-text")})};var ei=l(15361),er=l(17875);let en=()=>{let{remixMemeId:e,isGenerating:t,isRandomizing:l,isGenerateDisabled:s,onClickRandomPrompt:i,onClickResetPromptSettings:r,onClickGenerate:n}=L();return(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(M.A,{className:"flex-1 text-md h-11",variant:"solid",size:"md",startContent:(0,a.jsx)(D.JO,{icon:"ic:baseline-refresh",width:20}),onClick:r,children:(0,a.jsx)("h1",{children:"Reset"})},"desktop-clear"),(0,a.jsx)(M.A,{className:"flex-1 text-md h-11",variant:"solid",size:"md",startContent:(0,a.jsx)(D.JO,{icon:"ion:dice-sharp",width:20}),isLoading:l,onClick:i,children:(0,a.jsx)("h1",{children:"Random"})},"desktop-lucky")]}),(0,a.jsx)(M.A,{fullWidth:!0,className:"text-md h-11",variant:"shadow",color:"primary",size:"md",isLoading:t,isDisabled:s,onClick:n,children:(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[!t&&(0,a.jsx)(ei.default,{src:er.Z,alt:"Generate",className:"size-5"}),(0,a.jsx)("h1",{children:e?"Remix":"Generate"})]})},"desktop-generate")]})};var eo=l(94820),ec=l(65883),ed=l(23780),eu=l(46113);let em=()=>{let{selectedLibraryMeme:e,setSelectedLibraryMeme:t,genLibrary:l,setGenLibrary:s,onClickLibrary:i}=L(),[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(""),{isFetching:u,hasMore:m,onReachedEnd:h,onSearch:x}=(0,eu.M)({feed:l,setFeed:s,hasFetched:n,searchQuery:c,setSearchQuery:d,setHasFetched:o,fetchFn:e=>{let{start:t,limit:l,search:a}=e;return v.P.getLibrary({source:["generated"],start:t,limit:l,search:a})},fetchOnLoad:!0,pageSize:20,ignoreWindowScroll:!0}),p=(0,r.useCallback)(e=>{let{scrollLeft:t,clientWidth:l,scrollWidth:a}=e.currentTarget;t+l>=a-400&&m&&h()},[m,h]);return(0,a.jsxs)("div",{className:"flex size-full min-h-0 flex-col gap-3",children:[(0,a.jsx)("div",{children:(0,a.jsx)(ec.T,{value:c,placeholder:"Search your library",onSearch:x})}),(0,a.jsx)("div",{className:"flex-1 w-full min-h-0 overflow-y-scroll",onScroll:p,children:(0,a.jsx)(eo.o,{memes:l,hasFetched:n,hasSearched:c.length>0,isFetching:u,className:"overflow-hidden -mr-3",breakpoints:{default:2},renderItem:(t,l)=>(0,a.jsx)(ed.Y,{meme:t,isSelected:t.id===(null==e?void 0:e.id),onClick:()=>i(t)},"".concat(l,"-").concat(t.id))})})]})},eh=e=>{let{isMobile:t}=e,{tab:l}=L();return(0,a.jsxs)("section",{className:"flex flex-1 flex-col gap-4 size-full",children:[(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-4 w-full min-h-0 p-1 overflow-y-scroll overflow-x-auto",children:[(0,a.jsx)(ea,{}),"generate"===l&&(0,a.jsx)(el,{isMobile:t}),"text"===l&&(0,a.jsx)(es,{}),"image"===l&&(0,a.jsx)(em,{})]}),"generate"===l&&!t&&(0,a.jsx)(en,{})]})};var ex=l(94576),ep=l(74092),ef=l(7700);let eg=e=>{var t,l;let{meme:s,selectedAspectRatio:i}=e,n=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=n.current;if(!e)return;let t=s.panels,l=s.panel_layout;if(!t||!l)return;let{panelMemes:a,panelTexts:r}=z(t);(0,w.mr)(e,a,r,l,i)},[s,s.panels,null===(t=s.text_overlay)||void 0===t?void 0:t.bottom_text,null===(l=s.text_overlay)||void 0===l?void 0:l.top_text,i]),(0,a.jsx)("div",{className:"size-full flex items-center justify-center",children:(0,a.jsx)("canvas",{ref:n,className:"w-full max-h-full object-contain"})})},ev=e=>{var t,l,s,i,r,n;let{meme:o}=e,c=(null===(t=o.prompt)||void 0===t?void 0:t.aspect_ratio)==="square";return"composed"===o.source?(0,a.jsx)(eg,{meme:o,selectedAspectRatio:null===(i=o.prompt)||void 0===i?void 0:i.aspect_ratio}):o.url?(0,a.jsxs)(a.Fragment,{children:[!c&&(0,a.jsx)(ei.default,{src:o.url,width:1024,height:1024,quality:1,priority:!0,alt:"".concat(o.id," background blur"),className:"object-cover object-center blur-md absolute inset-0 z-[-1] scale-[2]"}),(0,a.jsx)(ef.g,{src:o.url,topText:null!==(r=null===(l=o.text_overlay)||void 0===l?void 0:l.top_text)&&void 0!==r?r:null,bottomText:null!==(n=null===(s=o.text_overlay)||void 0===s?void 0:s.bottom_text)&&void 0!==n?n:null,centerText:null,canvasHeight:o.height,canvasWidth:o.width,imageHeight:o.height,imageWidth:o.width,alt:"Generated meme ".concat(o.id)})]}):null},eb=()=>{let{meme:e,history:t,setHistory:l,isHistoryOpen:s,onClickHistory:i,remixMemeId:n,onLoadInRemix:o}=L(),[c,d]=(0,r.useState)(!1),u=(0,r.useCallback)(e=>{l(e.filter(e=>e.is_creator)),n&&o(n)},[o,n,l]),{isFetching:h,hasMore:x,onReachedEnd:p}=(0,eu.M)({feed:t,setFeed:l,hasFetched:c,setHasFetched:d,fetchFn:e=>{let{start:t,limit:l}=e;return v.P.getLibrary({source:["composed"],start:t,limit:l})},fetchOnLoad:!0,onFetchOnLoad:u,pageSize:20,ignoreWindowScroll:!0}),f=(0,r.useCallback)(e=>{let{clientWidth:t,scrollWidth:l,scrollLeft:a}=e;a+t>=l-400&&p()},[p]),b=(0,r.useCallback)(e=>{let{index:l}=e;return l===t.length?x?172:12:172},[x,t.length]),w=(0,r.useCallback)(l=>{let{columnIndex:s,key:r,style:n}=l;if(s===t.length)return h?(0,a.jsx)("div",{style:n,className:"flex w-full justify-center px-3",children:(0,a.jsx)(m.c,{})},r):null;let o=t[s],c=o.id===(null==e?void 0:e.id);return(0,a.jsx)("div",{style:n,className:"min-w-[172px] max-w-[172px] pl-3 py-3 cursor-pointer",onClick:()=>i(o),children:(0,a.jsx)("div",{className:"size-full relative bg-white-400/10 rounded-md border-2 overflow-hidden ".concat(c?"border-blue-500":"border-white-400/10"),children:(0,a.jsx)(ev,{meme:o})})},r)},[t,h,e,i]);return(0,a.jsx)(g.E.div,{initial:{bottom:-184},animate:{bottom:s?0:-184},exit:{bottom:-184},transition:{duration:.3,transitionProperty:"bottom"},className:"absolute inset-x-0 h-0 lg:h-[184px] w-full bg-black-0 border-black-100 border-t hidden lg:flex",children:(0,a.jsxs)("div",{className:"size-full flex-none flex-col gap-4 flex border-r-1 border-black-100 overflow-hidden",children:[0===t.length&&(0,a.jsx)("p",{className:"mx-3 text-white-400/50 text-sm",children:"No images generated yet"}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)(ex.ZP,{children:e=>{let{width:l}=e;return(0,a.jsx)(ep.rj,{scrollDirection:"horizontal",width:l,height:184,rowCount:1,rowHeight:184,columnCount:t.length+1,columnWidth:b,overscanColumnCount:10,onScroll:f,cellRenderer:w})}})})]})})};var ew=l(79886),ej=l(29619),ey=l(69208),e_=l(33838),eN=l(69919),ek=l(94663),eC=l(97426);let ez=()=>{let e=(0,s.useRouter)(),{profile:t}=(0,i.useProfile)(),{srcPreview:l,meme:r,setIsPostModalOpen:n}=L(),o=()=>n(!1),c=async()=>{if(!l)return;let e=(0,j.eh)(l);await navigator.clipboard.write([new ClipboardItem({"image/png":new Blob([e],{type:"image/png"})})]);let t=encodeURIComponent("ctrl+v to paste meme");window.open("https://twitter.com/intent/tweet?text=".concat(t),"_blank")};return(0,a.jsx)(ey.Z,{onClick:o,children:(0,a.jsxs)("form",{className:"relative flex w-full min-w-0 max-w-lg flex-col gap-3 rounded-xl bg-black-400 shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("header",{className:"relative flex w-full items-center justify-between px-3 pt-3",children:[(0,a.jsx)("div",{className:"flex items-center",children:t&&(0,a.jsx)(ej.z,{className:"cursor-pointer",name:"",onClick:()=>{e.push("/u/".concat(null==t?void 0:t.user.twitter_handle)),o()},avatarProps:{src:t.twitter_profile.profile_image_url_https,size:"sm"}})}),(0,a.jsx)(M.A,{isIconOnly:!0,className:"rounded-full",variant:"light",size:"sm",onClick:o,children:(0,a.jsx)(ei.default,{src:eN.Z,alt:"close",className:"w-3"})})]}),(0,a.jsx)("main",{className:"min-h-72 gap-7 flex flex-col items-center justify-center",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-xl -mb-2",children:"Meme Posted to the Feed!"}),(0,a.jsx)(ew.default,{href:"/library?memeId=".concat(r.id),className:"size-40 z-40 rounded-md bg-black-100 object-contain",children:"generated"===r.source?(0,a.jsx)(ek.k,{meme:r}):(0,a.jsx)(eC.h,{imageUrl:r.url})}),(0,a.jsx)("div",{className:"flex gap-3 w-full justify-center",children:(0,a.jsxs)(M.A,{className:"flex items-center justify-center gap-2 rounded-2xl bg-blue-500 px-5 py-1 text-sm",onClick:c,children:[(0,a.jsx)(ei.default,{src:e_.Z,alt:"X",className:"w-5"}),(0,a.jsx)("p",{className:"text-lg",children:"Share"})]})})]}):(0,a.jsx)(m.c,{})}),(0,a.jsx)("footer",{className:"h-11"})]})})},eA=()=>{var e;let{meme:t,isHistoryOpen:l,setIsHistoryOpen:s}=L(),i=Number(null==t?void 0:null===(e=t.posts)||void 0===e?void 0:e.length)>0;return(0,a.jsx)("div",{className:i?"w-auto":"w-[172px]",children:(0,a.jsx)(M.A,{radius:"full",variant:"light",disableRipple:!0,className:"z-1 ".concat(l?"bg-orange-400/10":""),onClick:()=>s(e=>!e),startContent:(0,a.jsx)(D.JO,{icon:"ic:round-history",width:20,className:l?"text-orange-400/75":"text-white-400/75"}),children:(0,a.jsx)("h2",{className:"font-medium ".concat(l?"text-orange-400":"text-white-400/75"),children:"History"})})})},eS=()=>(0,a.jsx)("footer",{className:"relative flex flex-col w-full items-center justify-center",children:(0,a.jsx)("div",{className:"flex min-w-full gap-3 items-center justify-between border-b border-white-400/10 px-4 h-[66px]",children:(0,a.jsx)("div",{className:"hidden lg:block",children:(0,a.jsx)(eA,{})})})});var eL=l(93037),eO=l(54024),eP=l(80437),eE=l(7692),eF=l(62350),eD=l(89204);let eT={[y.L.One]:{label:"One Pane",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/one-pane.2f9a7f4d.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[y.L.TwoVertical]:{label:"Two Vertical",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/two-pane-vertical.bcad13c4.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[y.L.TwoHorizontal]:{label:"Two Horizontal",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/two-pane-horizontal.ad349fa3.svg",height:30,width:30,blurWidth:0,blurHeight:0}},[y.L.Four]:{label:"Four Panes",icon:{src:"/memedeck:memedeck:meme-deck.os/_next/static/media/four-pane.09ada0ab.svg",height:30,width:30,blurWidth:0,blurHeight:0}}},eM=()=>{let{panelLayout:e,onClickPanelLayout:t,isCreatingProject:l}=L();return(0,a.jsx)(O.g,{size:"sm",value:e,isDisabled:l,selectedKeys:[e],startContent:(0,a.jsx)(ei.default,{src:eT[e].icon,alt:eT[e].label,width:24,height:24}),onChange:e=>t(e.target.value),className:"max-w-48","aria-label":"Panel Layout",children:Object.entries(eT).map(e=>{let[t,{label:l,icon:s}]=e;return(0,a.jsx)(E.R,{value:t,"aria-label":l,startContent:(0,a.jsx)(ei.default,{src:s,alt:l,width:24,height:24}),children:l},t)})})},eR=()=>{let{isGenerating:e,isPosting:t,isDeletingMeme:l,isDeletingPost:s,isDuplicatingPost:i,isPostDisabled:r,isMemePosted:n,remixMemeId:o,onClickDuplicatePost:c,onClickDeletePost:d,onClickDeleteMeme:u,onClickPost:m}=L();return(0,a.jsx)("div",{className:"flex gap-3 items-center z-1",children:n?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(M.A,{size:"sm",isLoading:i,onClick:c,children:"Duplicate"}),(0,a.jsx)(M.A,{size:"sm",variant:"flat",color:"primary",isDisabled:r,isLoading:s,onClick:d,children:"Published"})]}):(0,a.jsxs)("div",{className:"flex gap-2",children:[!e&&!o&&(0,a.jsx)(M.A,{size:"sm",variant:"light",color:"default",isDisabled:r,isLoading:l,onClick:u,children:"Delete"}),(0,a.jsx)(M.A,{size:"sm",variant:"flat",color:"default",isDisabled:r,isLoading:t,onClick:m,children:"Post"})]})})},eW=()=>{let{goBack:e}=(0,eD.useAppHistory)(),{isCreatingProject:t,onClickNewProject:l,isMemePosted:s}=L();return(0,a.jsx)("header",{className:"flex w-full flex-col justify-center gap-4 h-14 min-h-14 px-3 lg:flex-row lg:justify-between",children:(0,a.jsxs)("div",{className:"flex flex-row w-full items-center gap-2 justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-1 items-center text-large font-medium select-none z-[1]",children:[(0,a.jsx)(eF.O,{src:eN.Z,alt:"Close",margin:"m-0",w:"w-3",onClick:e}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ei.default,{priority:!0,src:eE.Z,alt:"Meme Deck",className:"hidden h-8 w-auto xl:block",draggable:!1}),(0,a.jsx)("h1",{className:"text-stone-300 text-lg",children:"Studio"})]})]}),(0,a.jsxs)("div",{className:"absolute inset-x-0 flex justify-center z-0 gap-2",children:[(0,a.jsx)(eM,{}),(0,a.jsx)(M.A,{size:"sm",isLoading:t,onClick:l,startContent:!t&&(0,a.jsx)(D.JO,{icon:"akar-icons:plus"}),children:"New"})]}),(0,a.jsx)("div",{className:"hidden lg:flex",children:(0,a.jsx)(eR,{})}),!s&&(0,a.jsx)("div",{className:"flex lg:hidden flex-row items-center gap-3",children:(0,a.jsxs)(eL.j,{children:[(0,a.jsx)(eO.b,{children:(0,a.jsx)(M.A,{isIconOnly:!0,className:"flex lg:hidden",radius:"full",size:"sm",variant:"flat",children:(0,a.jsx)(D.JO,{icon:"solar:menu-dots-bold",width:24})})}),(0,a.jsx)(eP.g,{className:"flex max-h-[50vh] w-[320px] justify-start gap-3 overflow-scroll p-4 lg:hidden",children:(0,a.jsx)(eh,{isMobile:!0})})]})})]})})},eH=e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"container",children:(0,a.jsx)("div",{className:"square",children:t})})};var eV=l(91543);let eq=()=>{let{progress:e,srcPreview:t,panelMemes:l,panelTexts:s,panelLayout:i,selectedPane:r,onClickPane:n,isGenerating:o,selectedAspectRatio:c}=L(),d=N._j[i];return(0,a.jsx)(eH,{children:(0,a.jsx)("div",{className:"size-full flex items-center justify-center overflow-hidden max-h-full max-w-full min-h-0",children:(0,a.jsx)("div",{className:"max-h-full max-w-full bg-black-400 grid ".concat(N.HS[i]),children:Array.from({length:d}).map((d,u)=>{var m,h,x,p;let f=r===u,v=l[u],b=s[u],w=i!==y.L.One?N.B5[i]:1,j=N.WN[i]||"grid-rows-1 h-auto w-fit",_=1024,k=1024;switch(i){case y.L.One:let C=N.e5[c];w=(_=C[0]||1024)/(k=C[1]||1024);break;case y.L.TwoHorizontal:w=(_=768)/(k=1024);break;case y.L.TwoVertical:w=(_=1024)/(k=768);break;case y.L.Four:w=(_=1024)/(k=1024)}let z=(null==v?void 0:v.width)||_,A=(null==v?void 0:v.height)||k;return(0,a.jsxs)("div",{style:{aspectRatio:w},className:"".concat(j," flex-1 border-3 overflow-hidden ").concat(f?"border-orange-400":"border-transparent"),onClick:()=>n(u,v,b),children:[f&&o&&!t&&(0,a.jsx)(g.E.div,{className:"size-full flex items-center justify-center backdrop-blur-lg",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)(eV.X,{className:"size-full opacity-50"})}),(0,a.jsx)(g.E.div,{className:"size-full max-h-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},children:(0,a.jsx)(ef.g,{src:f&&t||(null==v?void 0:v.url),topText:null!==(x=null==v?void 0:null===(m=v.text_overlay)||void 0===m?void 0:m.top_text)&&void 0!==x?x:null,progress:f?e:100,bottomText:null!==(p=null==v?void 0:null===(h=v.text_overlay)||void 0===h?void 0:h.bottom_text)&&void 0!==p?p:null,centerText:null!=b?b:null,imageWidth:z,imageHeight:A,canvasHeight:k,canvasWidth:_})})]},"".concat(u))})})})})},eI=()=>{let{posPrompt:e,isGenerating:t,selectedCharacter:l,selectedStyler:s,setPosPrompt:i,onClickGenerate:r}=L(),n=!e||!l||!s;return(0,a.jsxs)("div",{className:"w-full border-black-100 bg-black-400 gap-3 flex lg:hidden p-4 pb-12",children:[(0,a.jsx)(T.Y,{classNames:{base:"flex-1",input:"placeholder:text-white-400/25"},fullWidth:!0,label:"Prompt",isMultiline:!0,isRequired:!0,placeholder:"Describe the meme you want to generate",value:e,onValueChange:i,onKeyDown:e=>{"Enter"!==e.key||n||(e.preventDefault(),r())}},"mobile-prompt"),(0,a.jsx)(M.A,{isIconOnly:!0,className:"text-md",variant:"solid",color:"primary",radius:"full",isLoading:t,isDisabled:n,onClick:r,children:(0,a.jsx)(ei.default,{src:er.Z,alt:"Generate",className:"size-6"})},"mobile-generate")]})},eJ=()=>{let{isPostModalOpen:e,isHistoryOpen:t,isMemePosted:l}=L();return(0,a.jsxs)("div",{className:"fixed z-50 flex flex-row items-center justify-between h-screen overflow-y-auto dot-grid inset-x-0 min-h-screen max-h-screen t-0",children:[(0,a.jsxs)("div",{className:"relative flex flex-col flex-1 size-full min-h-0 overflow-hidden",children:[(0,a.jsx)(eW,{}),(0,a.jsx)(g.E.main,{className:"size-full relative flex justify-end flex-1 max-w-[100vw]",children:(0,a.jsx)(g.E.div,{initial:{height:"100%"},animate:{height:t?"calc(100% - 184px)":"100%"},exit:{height:"100%"},transition:{duration:.3,transitionProperty:"height"},className:"w-full lg:min-w-0",children:(0,a.jsxs)("div",{className:"flex flex-col size-full transition-all",children:[(0,a.jsx)("div",{className:"size-full min-h-0 overflow-hidden p-3 lg:px-6 lg:py-3 flex",children:(0,a.jsx)(eq,{})}),(0,a.jsx)(eS,{}),(0,a.jsx)(eb,{}),(0,a.jsx)(eI,{})]})})}),e&&(0,a.jsx)(ez,{})]}),!l&&(0,a.jsx)("div",{className:"p-3 pl-0 h-full hidden lg:flex",children:(0,a.jsx)("div",{className:"p-3 rounded-2xl bg-[#0F0F0F] border-1 border-black-100 w-96 max-h-full flex-none flex-col gap-4 lg:h-full",children:(0,a.jsx)(eh,{})})})]})};function eU(){var e;let t=null!==(e=(0,s.useSearchParams)().get("remix"))&&void 0!==e?e:void 0,{profile:l}=(0,i.useProfile)(),{socket:r,config:n}=f();return l&&r&&n&&window.localStorage?(0,a.jsx)(S,{profile:l,socket:r,config:n,remixMemeId:t,children:(0,a.jsx)(eJ,{})}):null}},94820:function(e,t,l){"use strict";l.d(t,{o:function(){return n}});var a=l(59547),s=l(24449),i=l(41020);let r={default:3,1100:3,700:2,500:1},n=e=>{let{memes:t,isFetching:l,hasFetched:n,hasSearched:o,className:c="overflow-hidden pl-3 pt-3",breakpoints:d=r,renderItem:u}=e;return(0,a.jsxs)("div",{className:c,children:[!l&&0===t.length&&(n||o)?(0,a.jsx)("div",{className:"text-white-400/75",children:"No memes"}):null,l&&0===t.length&&(0,a.jsx)("div",{className:"flex w-full justify-center p-3",children:(0,a.jsx)(s.c,{})}),(0,a.jsx)(i.Z,{breakpointCols:d,className:"my-masonry-grid min-w-full max-w-full",columnClassName:"my-masonry-grid_column",children:t.map(u)}),l&&t.length>0&&(0,a.jsx)("div",{className:"flex w-full justify-center p-3",children:(0,a.jsx)(s.c,{})})]})}},97426:function(e,t,l){"use strict";l.d(t,{h:function(){return i}});var a=l(59547),s=l(15361);let i=e=>{let{imageUrl:t,priorityLoadImage:l,alt:i="Meme"}=e;return(0,a.jsxs)("div",{className:"relative size-full select-none overflow-hidden rounded-xl bg-white-400/10",children:[(0,a.jsx)(s.default,{className:"absolute z-0 inset-0 object-cover blur-lg scale-110 size-full",src:t,alt:"Meme blur",width:400,height:400,quality:1,priority:l}),(0,a.jsx)(s.default,{draggable:!1,className:"absolute z-1 inset-0 size-full object-contain",src:t,alt:i,width:640,height:640,sizes:"640px",quality:50,priority:l})]})}},94663:function(e,t,l){"use strict";l.d(t,{k:function(){return r}});var a=l(59547),s=l(15361),i=l(7700);let r=e=>{var t,l,r,n,o,c,d,u,m;let{meme:h,priorityLoadImage:x}=e;return(0,a.jsxs)("div",{className:"relative size-full select-none overflow-hidden rounded-xl bg-white-400/10",children:[(0,a.jsx)(s.default,{className:"absolute z-0 inset-0 object-cover blur-lg scale-110 size-full",src:h.url,alt:"Meme blur",width:400,height:400,priority:x,quality:1}),(0,a.jsx)(i.g,{src:h.url,alt:(null!==(r=h.tags)&&void 0!==r?r:["Meme"]).join(", "),topText:null!==(n=null===(t=h.text_overlay)||void 0===t?void 0:t.top_text)&&void 0!==n?n:null,bottomText:null!==(o=null===(l=h.text_overlay)||void 0===l?void 0:l.bottom_text)&&void 0!==o?o:null,centerText:null,className:"z-[1]",imageWidth:null!==(c=h.width)&&void 0!==c?c:1024,imageHeight:null!==(d=h.height)&&void 0!==d?d:1024,canvasWidth:null!==(u=h.width)&&void 0!==u?u:1024,canvasHeight:null!==(m=h.height)&&void 0!==m?m:1024})]})}},65883:function(e,t,l){"use strict";l.d(t,{T:function(){return o}});var a=l(59547),s=l(30912),i=l(15361),r=l(99854),n=l(61505);let o=e=>{let{value:t,autofocus:l,initialSearch:o,placeholder:c="Search for memes. (i.e. pepe)",onFocus:d,onSearch:u}=e,m=(0,s.useRef)(null);return(0,a.jsx)(r.Y,{isClearable:!0,onClear:()=>{null==u||u("")},radius:"full",classNames:{input:"text-base placeholder:text-base placeholder:text-white-400/50"},startContent:(0,a.jsx)(i.default,{priority:!0,src:n.Z,alt:"Dropdown",onClick:e=>{var t;e.preventDefault(),null===(t=m.current)||void 0===t||t.focus()},className:"mr-1 size-5 cursor-text select-none opacity-75"}),ref:m,autoFocus:l,defaultValue:o,placeholder:c,className:"h-10 min-w-24 flex-1 rounded-full border border-white-400/5 bg-white-400/5 shadow-sm outline-none placeholder:text-xl placeholder:text-white-400/50",value:t,onFocus:d,onChange:e=>null==u?void 0:u(e.target.value)})}},23780:function(e,t,l){"use strict";l.d(t,{Y:function(){return n}});var a=l(59547),s=l(15361),i=l(25866),r=l(7700);let n=e=>{var t,l,n,o,c,d,u,m,h,x;let{meme:p,isSelected:f,showCreator:g=!1,onClick:v}=e,{onOpenMeme:b}=(0,i.useMemeModal)();return(0,a.jsx)("article",{className:"relative w-full cursor-pointer overflow-hidden rounded-lg border-2 ".concat(f?"border-blue-500":"border-transparent"),onClick:()=>v?v():b(p.id),children:(0,a.jsxs)("div",{className:"group flex w-full flex-col",children:["generated"===p.source?(0,a.jsx)(r.g,{src:p.url,alt:p.id,canvasWidth:null!==(n=p.width)&&void 0!==n?n:1024,canvasHeight:null!==(o=p.height)&&void 0!==o?o:1024,imageWidth:null!==(c=p.width)&&void 0!==c?c:1024,imageHeight:null!==(d=p.height)&&void 0!==d?d:1024,topText:null!==(u=null===(t=p.text_overlay)||void 0===t?void 0:t.top_text)&&void 0!==u?u:null,bottomText:null!==(m=null===(l=p.text_overlay)||void 0===l?void 0:l.bottom_text)&&void 0!==m?m:null,centerText:null,className:"z-0 size-full rounded-lg bg-white-400/5 transition-transform group-hover:scale-105"}):(0,a.jsx)(s.default,{className:"z-0 size-full rounded-lg bg-white-400/5 transition-transform group-hover:scale-105",src:p.url,alt:p.id,width:null!==(h=p.width)&&void 0!==h?h:1024,height:null!==(x=p.height)&&void 0!==x?x:1024}),g&&(0,a.jsx)("div",{className:"absolute inset-0 z-0 flex select-none items-end px-1.5 py-1 opacity-0 transition-opacity hover:opacity-100",children:(0,a.jsx)("div",{className:"flex flex-1 items-center gap-2",children:(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-2 truncate p-1 text-sm font-semibold drop-shadow-[0.5px_0.5px_1px_rgba(0,0,0,80)]",children:[(0,a.jsx)(s.default,{src:p.creator_avatar||"",alt:p.creator_handle||"",className:"rounded-full hover:scale-105",width:24,height:24}),p.creator_handle]})})})]})})}},69208:function(e,t,l){"use strict";l.d(t,{Z:function(){return s}});var a=l(59547);let s=e=>{let{children:t,onClick:l}=e;return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex size-full max-h-full min-h-0 items-start xs:items-center justify-center overflow-y-auto overflow-x-hidden bg-white-100 px-4 py-[10vh]",onClick:l,children:t})}},46113:function(e,t,l){"use strict";l.d(t,{M:function(){return i}});var a=l(30912),s=l(58741);let i=e=>{let{feed:t,setFeed:l,hasFetched:i,setHasFetched:r,searchQuery:n,setSearchQuery:o,fetchFn:c,initialQuery:d,fetchOnLoad:u=!0,pageSize:m=50,ignoreWindowScroll:h=!1,onFetchOnLoad:x}=e,[p,f]=(0,a.useState)(0),[g,v]=(0,a.useState)(!0),[b,w]=(0,a.useState)(!1),j=(0,a.useCallback)(async(e,t)=>{let a=await c(e,t);return l(t=>a.length>0&&Number(e.start)>0?[...t,...a]:a),w(!1),r(!0),v(a.length===m),a},[c,m,l,r]),y=(0,a.useMemo)(()=>(0,s.k)(j,1e3),[j]),_=(0,a.useCallback)(async(e,t)=>{var l,a,s;return w(!0),r(!1),y({search:null!==(l=e.search)&&void 0!==l?l:n,start:null!==(a=e.start)&&void 0!==a?a:p,limit:null!==(s=e.limit)&&void 0!==s?s:m},t)},[y,m,n,r,p]),N=(0,a.useCallback)(()=>{if(!i||!g||b)return;let e=p+m;f(e),_({start:e})},[i,g,b,p,m,_]),k=(0,a.useCallback)(async()=>{let e=window.innerHeight;document.body.offsetHeight-window.scrollY<3*e&&N()},[N]),C=(0,a.useCallback)(e=>{let t=new URL(window.location.href);e.length>0?t.searchParams.set("query",e):t.searchParams.delete("query"),window.history.pushState({},"",t.toString())},[]),z=(0,a.useCallback)(async e=>{null==o||o(e),o&&C(e),f(0),v(!0),_({search:e,start:0,limit:m})},[_,m,o,C]);return(0,a.useEffect)(()=>{if(!h)return window.addEventListener("scroll",k),()=>window.removeEventListener("scroll",k)},[k,h]),(0,a.useEffect)(()=>{let e=new AbortController;if(!i&&!(t.length>0)&&u&&!b)return _({search:d,start:0,limit:m},e.signal).then(x),()=>{!e.signal.aborted&&b&&e.abort()}},[t.length,_,u,i,d,b,x,m]),{feed:t,setFeed:l,setHasMore:v,onSearch:z,isFetching:b,hasMore:g,setIsFetching:w,setHasFetched:r,onReachedEnd:N}}},61505:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/search.3dc28276.svg",height:18,width:18,blurWidth:0,blurHeight:0}},33838:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/x.493d8304.png",height:45,width:41,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAMAAAAC2hU0AAAALVBMVEVMaXH+/v79/f3+/v79/f38/Pz8/Pz8/Pz9/f39/f39/f36+vr4+Pj9/f38/PwKLxeaAAAAD3RSTlMAS48j05o6aYO9pxgSs1uR71/vAAAACXBIWXMAABYlAAAWJQFJUiTwAAAANElEQVR4nBXBiRHAIAwEsT0/2AbSf7sZJJYcfNGR94SgzaYAt9w89pmAmso8KJyezXK40g8cqQDpZl1e6QAAAABJRU5ErkJggg==",blurWidth:7,blurHeight:8}},7692:function(e,t){"use strict";t.Z={src:"/memedeck:memedeck:meme-deck.os/_next/static/media/logo-wide.572ec4d3.svg",height:256,width:702,blurWidth:0,blurHeight:0}}},function(e){e.O(0,[1775,1904,3817,2972,9886,920,3372,276,4283,417,5875,5924,5922,1599,4116,7177,5866,7930,3957,1744],function(){return e(e.s=86599)}),_N_E=e.O()}]);